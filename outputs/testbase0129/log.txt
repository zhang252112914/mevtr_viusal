2024-01-30 17:02:51,135:INFO: Effective parameters:
2024-01-30 17:02:51,136:INFO:   <<< adaptive_cls: 0
2024-01-30 17:02:51,136:INFO:   <<< aggregation: None
2024-01-30 17:02:51,136:INFO:   <<< alpha: 1.0
2024-01-30 17:02:51,136:INFO:   <<< batch_size: 32
2024-01-30 17:02:51,136:INFO:   <<< batch_size_val: 16
2024-01-30 17:02:51,136:INFO:   <<< cache_dir: 
2024-01-30 17:02:51,136:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:02:51,136:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:02:51,136:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:02:51,136:INFO:   <<< cluster_embedding: 0
2024-01-30 17:02:51,136:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:02:51,136:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:02:51,136:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:02:51,136:INFO:   <<< coef_lr: 0.001
2024-01-30 17:02:51,136:INFO:   <<< cross_model: cross-base
2024-01-30 17:02:51,136:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:02:51,136:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:02:51,136:INFO:   <<< datatype: charades
2024-01-30 17:02:51,136:INFO:   <<< do_eval: True
2024-01-30 17:02:51,136:INFO:   <<< do_lower_case: False
2024-01-30 17:02:51,136:INFO:   <<< do_pretrain: False
2024-01-30 17:02:51,136:INFO:   <<< do_train: False
2024-01-30 17:02:51,136:INFO:   <<< dynamic_alpha: False
2024-01-30 17:02:51,136:INFO:   <<< epochs: 20
2024-01-30 17:02:51,136:INFO:   <<< eval_frame_order: 0
2024-01-30 17:02:51,136:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:02:51,136:INFO:   <<< feature_framerate: 1
2024-01-30 17:02:51,137:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:02:51,137:INFO:   <<< fp16: False
2024-01-30 17:02:51,137:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:02:51,137:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:02:51,137:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:02:51,137:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:02:51,137:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:02:51,137:INFO:   <<< linear_patch: 2d
2024-01-30 17:02:51,137:INFO:   <<< local_rank: 0
2024-01-30 17:02:51,137:INFO:   <<< loose_type: True
2024-01-30 17:02:51,137:INFO:   <<< loss: balanced
2024-01-30 17:02:51,137:INFO:   <<< lr: 0.0001
2024-01-30 17:02:51,137:INFO:   <<< lr_decay: 0.9
2024-01-30 17:02:51,137:INFO:   <<< margin: 0.1
2024-01-30 17:02:51,137:INFO:   <<< max_frames: 64
2024-01-30 17:02:51,137:INFO:   <<< max_words: 77
2024-01-30 17:02:51,137:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:02:51,137:INFO:   <<< n_display: 100
2024-01-30 17:02:51,137:INFO:   <<< n_gpu: 1
2024-01-30 17:02:51,137:INFO:   <<< n_pair: 1
2024-01-30 17:02:51,137:INFO:   <<< negative_weighting: 1
2024-01-30 17:02:51,137:INFO:   <<< num_thread_reader: 4
2024-01-30 17:02:51,137:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:02:51,137:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:02:51,137:INFO:   <<< post_process: cluster
2024-01-30 17:02:51,137:INFO:   <<< pre_norm: 0
2024-01-30 17:02:51,137:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:02:51,137:INFO:   <<< rank: 0
2024-01-30 17:02:51,137:INFO:   <<< resume_model: None
2024-01-30 17:02:51,137:INFO:   <<< sampled_use_mil: False
2024-01-30 17:02:51,137:INFO:   <<< save_feature_path: None
2024-01-30 17:02:51,137:INFO:   <<< seed: 42
2024-01-30 17:02:51,137:INFO:   <<< sim_header: meanP
2024-01-30 17:02:51,137:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:02:51,137:INFO:   <<< slice_framepos: 2
2024-01-30 17:02:51,137:INFO:   <<< task_type: retrieval
2024-01-30 17:02:51,137:INFO:   <<< temperature_new: 1.0
2024-01-30 17:02:51,138:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:02:51,138:INFO:   <<< time_embedding: 0
2024-01-30 17:02:51,138:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:02:51,138:INFO:   <<< train_frame_order: 0
2024-01-30 17:02:51,138:INFO:   <<< use_mil: False
2024-01-30 17:02:51,138:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:02:51,138:INFO:   <<< video_dim: 1024
2024-01-30 17:02:51,138:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:02:51,138:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:02:51,138:INFO:   <<< world_size: 1
2024-01-30 17:02:51,138:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:02:51,641:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:02:51,641:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:02:51,642:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:02:51,642:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:02:51,642:WARNING: Test retrieval by loose type.
2024-01-30 17:02:51,642:WARNING: 	 embed_dim: 512
2024-01-30 17:02:51,642:WARNING: 	 image_resolution: 224
2024-01-30 17:02:51,642:WARNING: 	 vision_layers: 12
2024-01-30 17:02:51,642:WARNING: 	 vision_width: 768
2024-01-30 17:02:51,642:WARNING: 	 vision_patch_size: 32
2024-01-30 17:02:51,642:WARNING: 	 context_length: 77
2024-01-30 17:02:51,642:WARNING: 	 vocab_size: 49408
2024-01-30 17:02:51,642:WARNING: 	 transformer_width: 512
2024-01-30 17:02:51,642:WARNING: 	 transformer_heads: 8
2024-01-30 17:02:51,642:WARNING: 	 transformer_layers: 12
2024-01-30 17:02:51,642:WARNING: 		 linear_patch: 2d
2024-01-30 17:02:51,642:WARNING: 	 cut_top_layer: 0
2024-01-30 17:02:52,673:WARNING: 	 sim_header: meanP
2024-01-30 17:02:55,302:INFO: --------------------
2024-01-30 17:02:55,302:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:02:56,876:INFO: ***** Running test *****
2024-01-30 17:02:56,876:INFO:   Num examples = 1334
2024-01-30 17:02:56,876:INFO:   Batch size = 16
2024-01-30 17:02:56,876:INFO:   Num steps = 42
2024-01-30 17:02:56,876:INFO: ***** Running val *****
2024-01-30 17:02:56,876:INFO:   Num examples = 1334
2024-01-30 17:02:56,878:INFO: model evaluation on 1 GPU
2024-01-30 17:06:23,063:INFO: sim matrix size: 3720, 1334
2024-01-30 17:06:24,758:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:07:51,700:INFO: Effective parameters:
2024-01-30 17:07:51,700:INFO:   <<< adaptive_cls: 0
2024-01-30 17:07:51,700:INFO:   <<< aggregation: None
2024-01-30 17:07:51,700:INFO:   <<< alpha: 1.0
2024-01-30 17:07:51,700:INFO:   <<< batch_size: 32
2024-01-30 17:07:51,700:INFO:   <<< batch_size_val: 16
2024-01-30 17:07:51,700:INFO:   <<< cache_dir: 
2024-01-30 17:07:51,700:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:07:51,700:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:07:51,700:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:07:51,700:INFO:   <<< cluster_embedding: 0
2024-01-30 17:07:51,700:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:07:51,700:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:07:51,700:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:07:51,700:INFO:   <<< coef_lr: 0.001
2024-01-30 17:07:51,700:INFO:   <<< cross_model: cross-base
2024-01-30 17:07:51,700:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:07:51,700:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:07:51,700:INFO:   <<< datatype: charades
2024-01-30 17:07:51,700:INFO:   <<< do_eval: True
2024-01-30 17:07:51,700:INFO:   <<< do_lower_case: False
2024-01-30 17:07:51,700:INFO:   <<< do_pretrain: False
2024-01-30 17:07:51,700:INFO:   <<< do_train: False
2024-01-30 17:07:51,700:INFO:   <<< dynamic_alpha: False
2024-01-30 17:07:51,700:INFO:   <<< epochs: 20
2024-01-30 17:07:51,700:INFO:   <<< eval_frame_order: 0
2024-01-30 17:07:51,700:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:07:51,701:INFO:   <<< feature_framerate: 1
2024-01-30 17:07:51,701:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:07:51,701:INFO:   <<< fp16: False
2024-01-30 17:07:51,701:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:07:51,701:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:07:51,701:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:07:51,701:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:07:51,701:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:07:51,701:INFO:   <<< linear_patch: 2d
2024-01-30 17:07:51,701:INFO:   <<< local_rank: 0
2024-01-30 17:07:51,701:INFO:   <<< loose_type: True
2024-01-30 17:07:51,701:INFO:   <<< loss: balanced
2024-01-30 17:07:51,701:INFO:   <<< lr: 0.0001
2024-01-30 17:07:51,701:INFO:   <<< lr_decay: 0.9
2024-01-30 17:07:51,701:INFO:   <<< margin: 0.1
2024-01-30 17:07:51,701:INFO:   <<< max_frames: 64
2024-01-30 17:07:51,701:INFO:   <<< max_words: 77
2024-01-30 17:07:51,701:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:07:51,701:INFO:   <<< n_display: 100
2024-01-30 17:07:51,701:INFO:   <<< n_gpu: 1
2024-01-30 17:07:51,701:INFO:   <<< n_pair: 1
2024-01-30 17:07:51,701:INFO:   <<< negative_weighting: 1
2024-01-30 17:07:51,701:INFO:   <<< num_thread_reader: 4
2024-01-30 17:07:51,701:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:07:51,701:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:07:51,701:INFO:   <<< post_process: cluster
2024-01-30 17:07:51,701:INFO:   <<< pre_norm: 0
2024-01-30 17:07:51,701:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:07:51,701:INFO:   <<< rank: 0
2024-01-30 17:07:51,701:INFO:   <<< resume_model: None
2024-01-30 17:07:51,701:INFO:   <<< sampled_use_mil: False
2024-01-30 17:07:51,701:INFO:   <<< save_feature_path: None
2024-01-30 17:07:51,701:INFO:   <<< seed: 42
2024-01-30 17:07:51,701:INFO:   <<< sim_header: meanP
2024-01-30 17:07:51,701:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:07:51,701:INFO:   <<< slice_framepos: 2
2024-01-30 17:07:51,701:INFO:   <<< task_type: retrieval
2024-01-30 17:07:51,702:INFO:   <<< temperature_new: 1.0
2024-01-30 17:07:51,702:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:07:51,702:INFO:   <<< time_embedding: 0
2024-01-30 17:07:51,702:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:07:51,702:INFO:   <<< train_frame_order: 0
2024-01-30 17:07:51,702:INFO:   <<< use_mil: False
2024-01-30 17:07:51,702:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:07:51,702:INFO:   <<< video_dim: 1024
2024-01-30 17:07:51,702:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:07:51,702:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:07:51,702:INFO:   <<< world_size: 1
2024-01-30 17:07:51,702:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:07:52,216:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:07:52,216:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:07:52,217:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:07:52,217:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:07:52,217:WARNING: Test retrieval by loose type.
2024-01-30 17:07:52,217:WARNING: 	 embed_dim: 512
2024-01-30 17:07:52,217:WARNING: 	 image_resolution: 224
2024-01-30 17:07:52,217:WARNING: 	 vision_layers: 12
2024-01-30 17:07:52,217:WARNING: 	 vision_width: 768
2024-01-30 17:07:52,217:WARNING: 	 vision_patch_size: 32
2024-01-30 17:07:52,217:WARNING: 	 context_length: 77
2024-01-30 17:07:52,217:WARNING: 	 vocab_size: 49408
2024-01-30 17:07:52,217:WARNING: 	 transformer_width: 512
2024-01-30 17:07:52,217:WARNING: 	 transformer_heads: 8
2024-01-30 17:07:52,217:WARNING: 	 transformer_layers: 12
2024-01-30 17:07:52,217:WARNING: 		 linear_patch: 2d
2024-01-30 17:07:52,217:WARNING: 	 cut_top_layer: 0
2024-01-30 17:07:53,290:WARNING: 	 sim_header: meanP
2024-01-30 17:07:55,920:INFO: --------------------
2024-01-30 17:07:55,920:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:07:57,507:INFO: ***** Running test *****
2024-01-30 17:07:57,507:INFO:   Num examples = 1334
2024-01-30 17:07:57,508:INFO:   Batch size = 16
2024-01-30 17:07:57,508:INFO:   Num steps = 42
2024-01-30 17:07:57,508:INFO: ***** Running val *****
2024-01-30 17:07:57,508:INFO:   Num examples = 1334
2024-01-30 17:07:57,509:INFO: model evaluation on 1 GPU
2024-01-30 17:11:07,404:INFO: sim matrix size: 3720, 1334
2024-01-30 17:11:09,115:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:11:09,138:INFO: Saving finished.
2024-01-30 17:11:09,138:INFO: Text to video:
2024-01-30 17:11:09,138:INFO: mean_mean: 361.03387096774196
2024-01-30 17:11:09,138:INFO: mean_median: 361.03387096774196
2024-01-30 17:11:09,138:INFO: median_mean: 244.0
2024-01-30 17:11:09,138:INFO: median_median: 244.0
2024-01-30 17:11:09,138:INFO: hit_ratio_1: 0.00967741935483871
2024-01-30 17:11:09,138:INFO: best_1: 0.00967741935483871
2024-01-30 17:11:09,138:INFO: worst_1: 0.00967741935483871
2024-01-30 17:11:09,138:INFO: hit_ratio_5: 0.03575268817204301
2024-01-30 17:11:09,138:INFO: best_5: 0.03575268817204301
2024-01-30 17:11:09,138:INFO: worst_5: 0.03575268817204301
2024-01-30 17:11:09,138:INFO: hit_ratio_10: 0.06693548387096775
2024-01-30 17:11:09,138:INFO: best_10: 0.06693548387096775
2024-01-30 17:11:09,138:INFO: worst_10: 0.06693548387096775
2024-01-30 17:11:09,138:INFO: hit_ratio_50: 0.1989247311827957
2024-01-30 17:11:09,138:INFO: best_50: 0.1989247311827957
2024-01-30 17:11:09,138:INFO: worst_50: 0.1989247311827957
2024-01-30 17:11:09,138:INFO: hit_ratio_100: 0.30806451612903224
2024-01-30 17:11:09,138:INFO: best_100: 0.30806451612903224
2024-01-30 17:11:09,139:INFO: worst_100: 0.30806451612903224
2024-01-30 17:11:09,139:INFO: Video to text:
2024-01-30 17:11:09,139:INFO: mean_mean: 1061.7193233740272
2024-01-30 17:11:09,139:INFO: mean_median: 1023.7293853073463
2024-01-30 17:11:09,139:INFO: median_mean: 895.8809523809524
2024-01-30 17:11:09,139:INFO: median_median: 801.75
2024-01-30 17:11:09,139:INFO: hit_ratio_1: 0.00789158991932605
2024-01-30 17:11:09,139:INFO: best_1: 0.017991004497751123
2024-01-30 17:11:09,139:INFO: worst_1: 0.0029985007496251873
2024-01-30 17:11:09,139:INFO: hit_ratio_5: 0.02901079222293615
2024-01-30 17:11:09,139:INFO: best_5: 0.060719640179910044
2024-01-30 17:11:09,139:INFO: worst_5: 0.01424287856071964
2024-01-30 17:11:09,139:INFO: hit_ratio_10: 0.0412823350229647
2024-01-30 17:11:09,139:INFO: best_10: 0.08845577211394302
2024-01-30 17:11:09,139:INFO: worst_10: 0.017241379310344827
2024-01-30 17:11:09,139:INFO: hit_ratio_50: 0.10810398372242451
2024-01-30 17:11:09,139:INFO: best_50: 0.22263868065967016
2024-01-30 17:11:09,139:INFO: worst_50: 0.044977511244377814
2024-01-30 17:11:09,139:INFO: hit_ratio_100: 0.16872873087265888
2024-01-30 17:11:09,139:INFO: best_100: 0.31334332833583206
2024-01-30 17:11:09,139:INFO: worst_100: 0.07571214392803598
2024-01-30 17:24:18,044:INFO: Effective parameters:
2024-01-30 17:24:18,044:INFO:   <<< adaptive_cls: 0
2024-01-30 17:24:18,045:INFO:   <<< aggregation: None
2024-01-30 17:24:18,045:INFO:   <<< alpha: 1.0
2024-01-30 17:24:18,045:INFO:   <<< batch_size: 32
2024-01-30 17:24:18,045:INFO:   <<< batch_size_val: 16
2024-01-30 17:24:18,045:INFO:   <<< cache_dir: 
2024-01-30 17:24:18,045:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:24:18,045:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:24:18,045:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:24:18,045:INFO:   <<< cluster_embedding: 0
2024-01-30 17:24:18,045:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:24:18,045:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:24:18,045:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:24:18,045:INFO:   <<< coef_lr: 0.001
2024-01-30 17:24:18,045:INFO:   <<< cross_model: cross-base
2024-01-30 17:24:18,045:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:24:18,045:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:24:18,045:INFO:   <<< datatype: charades
2024-01-30 17:24:18,045:INFO:   <<< do_eval: True
2024-01-30 17:24:18,045:INFO:   <<< do_lower_case: False
2024-01-30 17:24:18,045:INFO:   <<< do_pretrain: False
2024-01-30 17:24:18,045:INFO:   <<< do_train: False
2024-01-30 17:24:18,045:INFO:   <<< dynamic_alpha: False
2024-01-30 17:24:18,046:INFO:   <<< epochs: 20
2024-01-30 17:24:18,046:INFO:   <<< eval_frame_order: 0
2024-01-30 17:24:18,046:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:24:18,046:INFO:   <<< feature_framerate: 1
2024-01-30 17:24:18,046:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:24:18,046:INFO:   <<< fp16: False
2024-01-30 17:24:18,046:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:24:18,046:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:24:18,046:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:24:18,046:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:24:18,046:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:24:18,046:INFO:   <<< linear_patch: 2d
2024-01-30 17:24:18,046:INFO:   <<< local_rank: 0
2024-01-30 17:24:18,046:INFO:   <<< loose_type: True
2024-01-30 17:24:18,046:INFO:   <<< loss: balanced
2024-01-30 17:24:18,046:INFO:   <<< lr: 0.0001
2024-01-30 17:24:18,046:INFO:   <<< lr_decay: 0.9
2024-01-30 17:24:18,046:INFO:   <<< margin: 0.1
2024-01-30 17:24:18,046:INFO:   <<< max_frames: 64
2024-01-30 17:24:18,046:INFO:   <<< max_words: 77
2024-01-30 17:24:18,046:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:24:18,046:INFO:   <<< n_display: 100
2024-01-30 17:24:18,046:INFO:   <<< n_gpu: 1
2024-01-30 17:24:18,046:INFO:   <<< n_pair: 1
2024-01-30 17:24:18,046:INFO:   <<< negative_weighting: 1
2024-01-30 17:24:18,046:INFO:   <<< num_thread_reader: 4
2024-01-30 17:24:18,046:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:24:18,046:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:24:18,046:INFO:   <<< post_process: cluster
2024-01-30 17:24:18,046:INFO:   <<< pre_norm: 0
2024-01-30 17:24:18,046:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:24:18,047:INFO:   <<< rank: 0
2024-01-30 17:24:18,047:INFO:   <<< resume_model: None
2024-01-30 17:24:18,047:INFO:   <<< sampled_use_mil: False
2024-01-30 17:24:18,047:INFO:   <<< save_feature_path: None
2024-01-30 17:24:18,047:INFO:   <<< seed: 42
2024-01-30 17:24:18,047:INFO:   <<< sim_header: meanP
2024-01-30 17:24:18,047:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:24:18,047:INFO:   <<< slice_framepos: 2
2024-01-30 17:24:18,047:INFO:   <<< task_type: retrieval
2024-01-30 17:24:18,047:INFO:   <<< temperature_new: 1.0
2024-01-30 17:24:18,047:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:24:18,047:INFO:   <<< time_embedding: 0
2024-01-30 17:24:18,047:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:24:18,047:INFO:   <<< train_frame_order: 0
2024-01-30 17:24:18,047:INFO:   <<< use_mil: False
2024-01-30 17:24:18,047:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:24:18,047:INFO:   <<< video_dim: 1024
2024-01-30 17:24:18,047:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:24:18,047:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:24:18,047:INFO:   <<< world_size: 1
2024-01-30 17:24:18,047:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:24:18,553:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:24:18,553:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:24:18,553:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:24:18,553:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:24:18,553:WARNING: Test retrieval by loose type.
2024-01-30 17:24:18,554:WARNING: 	 embed_dim: 512
2024-01-30 17:24:18,554:WARNING: 	 image_resolution: 224
2024-01-30 17:24:18,554:WARNING: 	 vision_layers: 12
2024-01-30 17:24:18,554:WARNING: 	 vision_width: 768
2024-01-30 17:24:18,554:WARNING: 	 vision_patch_size: 32
2024-01-30 17:24:18,554:WARNING: 	 context_length: 77
2024-01-30 17:24:18,554:WARNING: 	 vocab_size: 49408
2024-01-30 17:24:18,554:WARNING: 	 transformer_width: 512
2024-01-30 17:24:18,554:WARNING: 	 transformer_heads: 8
2024-01-30 17:24:18,554:WARNING: 	 transformer_layers: 12
2024-01-30 17:24:18,554:WARNING: 		 linear_patch: 2d
2024-01-30 17:24:18,554:WARNING: 	 cut_top_layer: 0
2024-01-30 17:24:19,577:WARNING: 	 sim_header: meanP
2024-01-30 17:24:22,138:INFO: --------------------
2024-01-30 17:24:22,138:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:24:23,681:INFO: ***** Running test *****
2024-01-30 17:24:23,681:INFO:   Num examples = 1334
2024-01-30 17:24:23,681:INFO:   Batch size = 16
2024-01-30 17:24:23,681:INFO:   Num steps = 42
2024-01-30 17:24:23,681:INFO: ***** Running val *****
2024-01-30 17:24:23,681:INFO:   Num examples = 1334
2024-01-30 17:24:23,683:INFO: model evaluation on 1 GPU
2024-01-30 17:27:32,755:INFO: sim matrix size: 3720, 1334
2024-01-30 17:27:34,423:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:34:57,979:INFO: Effective parameters:
2024-01-30 17:34:57,979:INFO:   <<< adaptive_cls: 0
2024-01-30 17:34:57,979:INFO:   <<< aggregation: None
2024-01-30 17:34:57,979:INFO:   <<< alpha: 1.0
2024-01-30 17:34:57,979:INFO:   <<< batch_size: 32
2024-01-30 17:34:57,979:INFO:   <<< batch_size_val: 16
2024-01-30 17:34:57,979:INFO:   <<< cache_dir: 
2024-01-30 17:34:57,979:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:34:57,979:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:34:57,979:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:34:57,979:INFO:   <<< cluster_embedding: 0
2024-01-30 17:34:57,979:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:34:57,979:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:34:57,979:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:34:57,979:INFO:   <<< coef_lr: 0.001
2024-01-30 17:34:57,979:INFO:   <<< cross_model: cross-base
2024-01-30 17:34:57,979:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:34:57,979:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:34:57,979:INFO:   <<< datatype: charades
2024-01-30 17:34:57,980:INFO:   <<< do_eval: True
2024-01-30 17:34:57,980:INFO:   <<< do_lower_case: False
2024-01-30 17:34:57,980:INFO:   <<< do_pretrain: False
2024-01-30 17:34:57,980:INFO:   <<< do_train: False
2024-01-30 17:34:57,980:INFO:   <<< dynamic_alpha: False
2024-01-30 17:34:57,980:INFO:   <<< epochs: 20
2024-01-30 17:34:57,980:INFO:   <<< eval_frame_order: 0
2024-01-30 17:34:57,980:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:34:57,980:INFO:   <<< feature_framerate: 1
2024-01-30 17:34:57,980:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:34:57,980:INFO:   <<< fp16: False
2024-01-30 17:34:57,980:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:34:57,980:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:34:57,980:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:34:57,980:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:34:57,980:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:34:57,980:INFO:   <<< linear_patch: 2d
2024-01-30 17:34:57,980:INFO:   <<< local_rank: 0
2024-01-30 17:34:57,980:INFO:   <<< loose_type: True
2024-01-30 17:34:57,980:INFO:   <<< loss: balanced
2024-01-30 17:34:57,980:INFO:   <<< lr: 0.0001
2024-01-30 17:34:57,980:INFO:   <<< lr_decay: 0.9
2024-01-30 17:34:57,980:INFO:   <<< margin: 0.1
2024-01-30 17:34:57,980:INFO:   <<< max_frames: 64
2024-01-30 17:34:57,980:INFO:   <<< max_words: 77
2024-01-30 17:34:57,980:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:34:57,980:INFO:   <<< n_display: 100
2024-01-30 17:34:57,980:INFO:   <<< n_gpu: 1
2024-01-30 17:34:57,980:INFO:   <<< n_pair: 1
2024-01-30 17:34:57,980:INFO:   <<< negative_weighting: 1
2024-01-30 17:34:57,980:INFO:   <<< num_thread_reader: 4
2024-01-30 17:34:57,980:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:34:57,980:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:34:57,980:INFO:   <<< post_process: cluster
2024-01-30 17:34:57,980:INFO:   <<< pre_norm: 0
2024-01-30 17:34:57,980:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:34:57,980:INFO:   <<< rank: 0
2024-01-30 17:34:57,981:INFO:   <<< resume_model: None
2024-01-30 17:34:57,981:INFO:   <<< sampled_use_mil: False
2024-01-30 17:34:57,981:INFO:   <<< save_feature_path: None
2024-01-30 17:34:57,981:INFO:   <<< seed: 42
2024-01-30 17:34:57,981:INFO:   <<< sim_header: meanP
2024-01-30 17:34:57,981:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:34:57,981:INFO:   <<< slice_framepos: 2
2024-01-30 17:34:57,981:INFO:   <<< task_type: retrieval
2024-01-30 17:34:57,981:INFO:   <<< temperature_new: 1.0
2024-01-30 17:34:57,981:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:34:57,981:INFO:   <<< time_embedding: 0
2024-01-30 17:34:57,981:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:34:57,981:INFO:   <<< train_frame_order: 0
2024-01-30 17:34:57,981:INFO:   <<< use_mil: False
2024-01-30 17:34:57,981:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:34:57,981:INFO:   <<< video_dim: 1024
2024-01-30 17:34:57,981:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:34:57,981:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:34:57,981:INFO:   <<< world_size: 1
2024-01-30 17:34:57,981:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:34:58,490:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:34:58,491:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:34:58,491:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:34:58,491:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:34:58,491:WARNING: Test retrieval by loose type.
2024-01-30 17:34:58,491:WARNING: 	 embed_dim: 512
2024-01-30 17:34:58,491:WARNING: 	 image_resolution: 224
2024-01-30 17:34:58,491:WARNING: 	 vision_layers: 12
2024-01-30 17:34:58,491:WARNING: 	 vision_width: 768
2024-01-30 17:34:58,491:WARNING: 	 vision_patch_size: 32
2024-01-30 17:34:58,491:WARNING: 	 context_length: 77
2024-01-30 17:34:58,491:WARNING: 	 vocab_size: 49408
2024-01-30 17:34:58,491:WARNING: 	 transformer_width: 512
2024-01-30 17:34:58,491:WARNING: 	 transformer_heads: 8
2024-01-30 17:34:58,491:WARNING: 	 transformer_layers: 12
2024-01-30 17:34:58,491:WARNING: 		 linear_patch: 2d
2024-01-30 17:34:58,491:WARNING: 	 cut_top_layer: 0
2024-01-30 17:34:59,557:WARNING: 	 sim_header: meanP
2024-01-30 17:35:02,165:INFO: --------------------
2024-01-30 17:35:02,165:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:35:03,737:INFO: ***** Running test *****
2024-01-30 17:35:03,737:INFO:   Num examples = 1334
2024-01-30 17:35:03,737:INFO:   Batch size = 16
2024-01-30 17:35:03,737:INFO:   Num steps = 42
2024-01-30 17:35:03,737:INFO: ***** Running val *****
2024-01-30 17:35:03,737:INFO:   Num examples = 1334
2024-01-30 17:35:03,739:INFO: model evaluation on 1 GPU
2024-01-30 17:38:14,661:INFO: sim matrix size: 3720, 1334
2024-01-30 17:38:16,379:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:50:53,495:INFO: Effective parameters:
2024-01-30 17:50:53,496:INFO:   <<< adaptive_cls: 0
2024-01-30 17:50:53,496:INFO:   <<< aggregation: None
2024-01-30 17:50:53,496:INFO:   <<< alpha: 1.0
2024-01-30 17:50:53,496:INFO:   <<< batch_size: 32
2024-01-30 17:50:53,496:INFO:   <<< batch_size_val: 16
2024-01-30 17:50:53,496:INFO:   <<< cache_dir: 
2024-01-30 17:50:53,496:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:50:53,496:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:50:53,496:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:50:53,496:INFO:   <<< cluster_embedding: 0
2024-01-30 17:50:53,496:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:50:53,496:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:50:53,496:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:50:53,496:INFO:   <<< coef_lr: 0.001
2024-01-30 17:50:53,496:INFO:   <<< cross_model: cross-base
2024-01-30 17:50:53,496:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:50:53,496:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:50:53,496:INFO:   <<< datatype: charades
2024-01-30 17:50:53,496:INFO:   <<< do_eval: True
2024-01-30 17:50:53,496:INFO:   <<< do_lower_case: False
2024-01-30 17:50:53,496:INFO:   <<< do_pretrain: False
2024-01-30 17:50:53,496:INFO:   <<< do_train: False
2024-01-30 17:50:53,496:INFO:   <<< dynamic_alpha: False
2024-01-30 17:50:53,496:INFO:   <<< epochs: 20
2024-01-30 17:50:53,496:INFO:   <<< eval_frame_order: 0
2024-01-30 17:50:53,496:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:50:53,496:INFO:   <<< feature_framerate: 1
2024-01-30 17:50:53,496:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:50:53,496:INFO:   <<< fp16: False
2024-01-30 17:50:53,496:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:50:53,497:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:50:53,497:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:50:53,497:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:50:53,497:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:50:53,497:INFO:   <<< linear_patch: 2d
2024-01-30 17:50:53,497:INFO:   <<< local_rank: 0
2024-01-30 17:50:53,497:INFO:   <<< loose_type: True
2024-01-30 17:50:53,497:INFO:   <<< loss: balanced
2024-01-30 17:50:53,497:INFO:   <<< lr: 0.0001
2024-01-30 17:50:53,497:INFO:   <<< lr_decay: 0.9
2024-01-30 17:50:53,497:INFO:   <<< margin: 0.1
2024-01-30 17:50:53,497:INFO:   <<< max_frames: 64
2024-01-30 17:50:53,497:INFO:   <<< max_words: 77
2024-01-30 17:50:53,497:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:50:53,497:INFO:   <<< n_display: 100
2024-01-30 17:50:53,497:INFO:   <<< n_gpu: 1
2024-01-30 17:50:53,497:INFO:   <<< n_pair: 1
2024-01-30 17:50:53,497:INFO:   <<< negative_weighting: 1
2024-01-30 17:50:53,497:INFO:   <<< num_thread_reader: 4
2024-01-30 17:50:53,497:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:50:53,497:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:50:53,497:INFO:   <<< post_process: cluster
2024-01-30 17:50:53,497:INFO:   <<< pre_norm: 0
2024-01-30 17:50:53,497:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:50:53,497:INFO:   <<< rank: 0
2024-01-30 17:50:53,497:INFO:   <<< resume_model: None
2024-01-30 17:50:53,497:INFO:   <<< sampled_use_mil: False
2024-01-30 17:50:53,497:INFO:   <<< save_feature_path: None
2024-01-30 17:50:53,497:INFO:   <<< seed: 42
2024-01-30 17:50:53,497:INFO:   <<< sim_header: meanP
2024-01-30 17:50:53,497:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:50:53,497:INFO:   <<< slice_framepos: 2
2024-01-30 17:50:53,497:INFO:   <<< task_type: retrieval
2024-01-30 17:50:53,497:INFO:   <<< temperature_new: 1.0
2024-01-30 17:50:53,497:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:50:53,497:INFO:   <<< time_embedding: 0
2024-01-30 17:50:53,497:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:50:53,497:INFO:   <<< train_frame_order: 0
2024-01-30 17:50:53,498:INFO:   <<< use_mil: False
2024-01-30 17:50:53,498:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:50:53,498:INFO:   <<< video_dim: 1024
2024-01-30 17:50:53,498:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:50:53,498:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:50:53,498:INFO:   <<< world_size: 1
2024-01-30 17:50:53,498:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:50:54,003:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:50:54,003:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:50:54,005:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:50:54,005:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:50:54,005:WARNING: Test retrieval by loose type.
2024-01-30 17:50:54,005:WARNING: 	 embed_dim: 512
2024-01-30 17:50:54,005:WARNING: 	 image_resolution: 224
2024-01-30 17:50:54,005:WARNING: 	 vision_layers: 12
2024-01-30 17:50:54,005:WARNING: 	 vision_width: 768
2024-01-30 17:50:54,005:WARNING: 	 vision_patch_size: 32
2024-01-30 17:50:54,005:WARNING: 	 context_length: 77
2024-01-30 17:50:54,005:WARNING: 	 vocab_size: 49408
2024-01-30 17:50:54,005:WARNING: 	 transformer_width: 512
2024-01-30 17:50:54,006:WARNING: 	 transformer_heads: 8
2024-01-30 17:50:54,006:WARNING: 	 transformer_layers: 12
2024-01-30 17:50:54,006:WARNING: 		 linear_patch: 2d
2024-01-30 17:50:54,006:WARNING: 	 cut_top_layer: 0
2024-01-30 17:50:55,063:WARNING: 	 sim_header: meanP
2024-01-30 17:50:57,678:INFO: --------------------
2024-01-30 17:50:57,678:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:50:59,231:INFO: ***** Running test *****
2024-01-30 17:50:59,231:INFO:   Num examples = 1334
2024-01-30 17:50:59,231:INFO:   Batch size = 16
2024-01-30 17:50:59,231:INFO:   Num steps = 42
2024-01-30 17:50:59,231:INFO: ***** Running val *****
2024-01-30 17:50:59,231:INFO:   Num examples = 1334
2024-01-30 17:50:59,232:INFO: model evaluation on 1 GPU
2024-01-30 17:54:08,367:INFO: sim matrix size: 3720, 1334
2024-01-30 17:54:10,074:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:54:21,564:INFO: Effective parameters:
2024-01-30 17:54:21,565:INFO:   <<< adaptive_cls: 0
2024-01-30 17:54:21,565:INFO:   <<< aggregation: None
2024-01-30 17:54:21,565:INFO:   <<< alpha: 1.0
2024-01-30 17:54:21,565:INFO:   <<< batch_size: 32
2024-01-30 17:54:21,565:INFO:   <<< batch_size_val: 16
2024-01-30 17:54:21,565:INFO:   <<< cache_dir: 
2024-01-30 17:54:21,565:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:54:21,565:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:54:21,565:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:54:21,565:INFO:   <<< cluster_embedding: 0
2024-01-30 17:54:21,565:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:54:21,565:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:54:21,565:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:54:21,565:INFO:   <<< coef_lr: 0.001
2024-01-30 17:54:21,565:INFO:   <<< cross_model: cross-base
2024-01-30 17:54:21,565:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:54:21,565:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:54:21,565:INFO:   <<< datatype: charades
2024-01-30 17:54:21,565:INFO:   <<< do_eval: True
2024-01-30 17:54:21,565:INFO:   <<< do_lower_case: False
2024-01-30 17:54:21,565:INFO:   <<< do_pretrain: False
2024-01-30 17:54:21,565:INFO:   <<< do_train: False
2024-01-30 17:54:21,565:INFO:   <<< dynamic_alpha: False
2024-01-30 17:54:21,565:INFO:   <<< epochs: 20
2024-01-30 17:54:21,565:INFO:   <<< eval_frame_order: 0
2024-01-30 17:54:21,565:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:54:21,565:INFO:   <<< feature_framerate: 1
2024-01-30 17:54:21,565:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:54:21,565:INFO:   <<< fp16: False
2024-01-30 17:54:21,565:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:54:21,565:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:54:21,565:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:54:21,565:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:54:21,566:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:54:21,566:INFO:   <<< linear_patch: 2d
2024-01-30 17:54:21,566:INFO:   <<< local_rank: 0
2024-01-30 17:54:21,566:INFO:   <<< loose_type: True
2024-01-30 17:54:21,566:INFO:   <<< loss: balanced
2024-01-30 17:54:21,566:INFO:   <<< lr: 0.0001
2024-01-30 17:54:21,566:INFO:   <<< lr_decay: 0.9
2024-01-30 17:54:21,566:INFO:   <<< margin: 0.1
2024-01-30 17:54:21,566:INFO:   <<< max_frames: 64
2024-01-30 17:54:21,566:INFO:   <<< max_words: 77
2024-01-30 17:54:21,566:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:54:21,566:INFO:   <<< n_display: 100
2024-01-30 17:54:21,566:INFO:   <<< n_gpu: 1
2024-01-30 17:54:21,566:INFO:   <<< n_pair: 1
2024-01-30 17:54:21,566:INFO:   <<< negative_weighting: 1
2024-01-30 17:54:21,566:INFO:   <<< num_thread_reader: 4
2024-01-30 17:54:21,566:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:54:21,566:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:54:21,566:INFO:   <<< post_process: cluster
2024-01-30 17:54:21,566:INFO:   <<< pre_norm: 0
2024-01-30 17:54:21,566:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:54:21,566:INFO:   <<< rank: 0
2024-01-30 17:54:21,566:INFO:   <<< resume_model: None
2024-01-30 17:54:21,566:INFO:   <<< sampled_use_mil: False
2024-01-30 17:54:21,566:INFO:   <<< save_feature_path: None
2024-01-30 17:54:21,566:INFO:   <<< seed: 42
2024-01-30 17:54:21,566:INFO:   <<< sim_header: meanP
2024-01-30 17:54:21,566:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:54:21,566:INFO:   <<< slice_framepos: 2
2024-01-30 17:54:21,566:INFO:   <<< task_type: retrieval
2024-01-30 17:54:21,566:INFO:   <<< temperature_new: 1.0
2024-01-30 17:54:21,566:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:54:21,566:INFO:   <<< time_embedding: 0
2024-01-30 17:54:21,566:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:54:21,567:INFO:   <<< train_frame_order: 0
2024-01-30 17:54:21,567:INFO:   <<< use_mil: False
2024-01-30 17:54:21,567:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:54:21,567:INFO:   <<< video_dim: 1024
2024-01-30 17:54:21,567:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:54:21,567:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:54:21,567:INFO:   <<< world_size: 1
2024-01-30 17:54:21,567:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:54:22,084:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:54:22,084:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:54:22,084:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:54:22,084:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:54:22,085:WARNING: Test retrieval by loose type.
2024-01-30 17:54:22,085:WARNING: 	 embed_dim: 512
2024-01-30 17:54:22,085:WARNING: 	 image_resolution: 224
2024-01-30 17:54:22,085:WARNING: 	 vision_layers: 12
2024-01-30 17:54:22,085:WARNING: 	 vision_width: 768
2024-01-30 17:54:22,085:WARNING: 	 vision_patch_size: 32
2024-01-30 17:54:22,085:WARNING: 	 context_length: 77
2024-01-30 17:54:22,085:WARNING: 	 vocab_size: 49408
2024-01-30 17:54:22,085:WARNING: 	 transformer_width: 512
2024-01-30 17:54:22,085:WARNING: 	 transformer_heads: 8
2024-01-30 17:54:22,085:WARNING: 	 transformer_layers: 12
2024-01-30 17:54:22,085:WARNING: 		 linear_patch: 2d
2024-01-30 17:54:22,085:WARNING: 	 cut_top_layer: 0
2024-01-30 17:54:23,146:WARNING: 	 sim_header: meanP
2024-01-30 17:54:25,783:INFO: --------------------
2024-01-30 17:54:25,784:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:54:27,371:INFO: ***** Running test *****
2024-01-30 17:54:27,371:INFO:   Num examples = 1334
2024-01-30 17:54:27,371:INFO:   Batch size = 16
2024-01-30 17:54:27,371:INFO:   Num steps = 42
2024-01-30 17:54:27,371:INFO: ***** Running val *****
2024-01-30 17:54:27,371:INFO:   Num examples = 1334
2024-01-30 17:54:27,372:INFO: model evaluation on 1 GPU
2024-01-30 17:57:39,425:INFO: sim matrix size: 3720, 1334
2024-01-30 17:57:41,147:INFO: Saving the matrixs and metrics on local.
2024-01-30 17:58:48,223:INFO: Effective parameters:
2024-01-30 17:58:48,223:INFO:   <<< adaptive_cls: 0
2024-01-30 17:58:48,223:INFO:   <<< aggregation: None
2024-01-30 17:58:48,223:INFO:   <<< alpha: 1.0
2024-01-30 17:58:48,223:INFO:   <<< batch_size: 32
2024-01-30 17:58:48,223:INFO:   <<< batch_size_val: 16
2024-01-30 17:58:48,223:INFO:   <<< cache_dir: 
2024-01-30 17:58:48,223:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 17:58:48,223:INFO:   <<< cluster_algo: kmediods++
2024-01-30 17:58:48,223:INFO:   <<< cluster_distance: euclidean
2024-01-30 17:58:48,223:INFO:   <<< cluster_embedding: 0
2024-01-30 17:58:48,223:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 17:58:48,223:INFO:   <<< cluster_iter_limit: 100
2024-01-30 17:58:48,224:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 17:58:48,224:INFO:   <<< coef_lr: 0.001
2024-01-30 17:58:48,224:INFO:   <<< cross_model: cross-base
2024-01-30 17:58:48,224:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 17:58:48,224:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 17:58:48,224:INFO:   <<< datatype: charades
2024-01-30 17:58:48,224:INFO:   <<< do_eval: True
2024-01-30 17:58:48,224:INFO:   <<< do_lower_case: False
2024-01-30 17:58:48,224:INFO:   <<< do_pretrain: False
2024-01-30 17:58:48,224:INFO:   <<< do_train: False
2024-01-30 17:58:48,224:INFO:   <<< dynamic_alpha: False
2024-01-30 17:58:48,224:INFO:   <<< epochs: 20
2024-01-30 17:58:48,224:INFO:   <<< eval_frame_order: 0
2024-01-30 17:58:48,224:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 17:58:48,224:INFO:   <<< feature_framerate: 1
2024-01-30 17:58:48,224:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 17:58:48,224:INFO:   <<< fp16: False
2024-01-30 17:58:48,224:INFO:   <<< fp16_opt_level: O1
2024-01-30 17:58:48,224:INFO:   <<< freeze_layer_num: 0
2024-01-30 17:58:48,224:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 17:58:48,224:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 17:58:48,224:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 17:58:48,224:INFO:   <<< linear_patch: 2d
2024-01-30 17:58:48,224:INFO:   <<< local_rank: 0
2024-01-30 17:58:48,224:INFO:   <<< loose_type: True
2024-01-30 17:58:48,224:INFO:   <<< loss: balanced
2024-01-30 17:58:48,224:INFO:   <<< lr: 0.0001
2024-01-30 17:58:48,224:INFO:   <<< lr_decay: 0.9
2024-01-30 17:58:48,225:INFO:   <<< margin: 0.1
2024-01-30 17:58:48,225:INFO:   <<< max_frames: 64
2024-01-30 17:58:48,225:INFO:   <<< max_words: 77
2024-01-30 17:58:48,225:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 17:58:48,225:INFO:   <<< n_display: 100
2024-01-30 17:58:48,225:INFO:   <<< n_gpu: 1
2024-01-30 17:58:48,225:INFO:   <<< n_pair: 1
2024-01-30 17:58:48,225:INFO:   <<< negative_weighting: 1
2024-01-30 17:58:48,225:INFO:   <<< num_thread_reader: 4
2024-01-30 17:58:48,225:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 17:58:48,225:INFO:   <<< post_cluster_centroids: 16
2024-01-30 17:58:48,225:INFO:   <<< post_process: cluster
2024-01-30 17:58:48,225:INFO:   <<< pre_norm: 0
2024-01-30 17:58:48,225:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 17:58:48,225:INFO:   <<< rank: 0
2024-01-30 17:58:48,225:INFO:   <<< resume_model: None
2024-01-30 17:58:48,225:INFO:   <<< sampled_use_mil: False
2024-01-30 17:58:48,225:INFO:   <<< save_feature_path: None
2024-01-30 17:58:48,225:INFO:   <<< seed: 42
2024-01-30 17:58:48,225:INFO:   <<< sim_header: meanP
2024-01-30 17:58:48,225:INFO:   <<< sim_lambda: 0.0
2024-01-30 17:58:48,225:INFO:   <<< slice_framepos: 2
2024-01-30 17:58:48,225:INFO:   <<< task_type: retrieval
2024-01-30 17:58:48,225:INFO:   <<< temperature_new: 1.0
2024-01-30 17:58:48,225:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 17:58:48,225:INFO:   <<< time_embedding: 0
2024-01-30 17:58:48,225:INFO:   <<< train_csv: data/.train.csv
2024-01-30 17:58:48,225:INFO:   <<< train_frame_order: 0
2024-01-30 17:58:48,225:INFO:   <<< use_mil: False
2024-01-30 17:58:48,225:INFO:   <<< val_csv: data/.val.csv
2024-01-30 17:58:48,225:INFO:   <<< video_dim: 1024
2024-01-30 17:58:48,225:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 17:58:48,225:INFO:   <<< warmup_proportion: 0.1
2024-01-30 17:58:48,225:INFO:   <<< world_size: 1
2024-01-30 17:58:48,225:INFO: device: cuda:0 n_gpu: 1
2024-01-30 17:58:48,730:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 17:58:48,730:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 17:58:48,730:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 17:58:48,730:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 17:58:48,730:WARNING: Test retrieval by loose type.
2024-01-30 17:58:48,730:WARNING: 	 embed_dim: 512
2024-01-30 17:58:48,731:WARNING: 	 image_resolution: 224
2024-01-30 17:58:48,731:WARNING: 	 vision_layers: 12
2024-01-30 17:58:48,731:WARNING: 	 vision_width: 768
2024-01-30 17:58:48,731:WARNING: 	 vision_patch_size: 32
2024-01-30 17:58:48,731:WARNING: 	 context_length: 77
2024-01-30 17:58:48,731:WARNING: 	 vocab_size: 49408
2024-01-30 17:58:48,731:WARNING: 	 transformer_width: 512
2024-01-30 17:58:48,731:WARNING: 	 transformer_heads: 8
2024-01-30 17:58:48,731:WARNING: 	 transformer_layers: 12
2024-01-30 17:58:48,731:WARNING: 		 linear_patch: 2d
2024-01-30 17:58:48,731:WARNING: 	 cut_top_layer: 0
2024-01-30 17:58:49,765:WARNING: 	 sim_header: meanP
2024-01-30 17:58:52,332:INFO: --------------------
2024-01-30 17:58:52,332:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 17:58:53,867:INFO: ***** Running test *****
2024-01-30 17:58:53,867:INFO:   Num examples = 1334
2024-01-30 17:58:53,867:INFO:   Batch size = 16
2024-01-30 17:58:53,867:INFO:   Num steps = 42
2024-01-30 17:58:53,867:INFO: ***** Running val *****
2024-01-30 17:58:53,867:INFO:   Num examples = 1334
2024-01-30 17:58:53,869:INFO: model evaluation on 1 GPU
2024-01-30 18:02:04,827:INFO: sim matrix size: 3720, 1334
2024-01-30 18:02:06,540:INFO: Saving the matrixs and metrics on local.
2024-01-30 18:02:30,172:INFO: Effective parameters:
2024-01-30 18:02:30,172:INFO:   <<< adaptive_cls: 0
2024-01-30 18:02:30,172:INFO:   <<< aggregation: None
2024-01-30 18:02:30,172:INFO:   <<< alpha: 1.0
2024-01-30 18:02:30,172:INFO:   <<< batch_size: 32
2024-01-30 18:02:30,172:INFO:   <<< batch_size_val: 16
2024-01-30 18:02:30,172:INFO:   <<< cache_dir: 
2024-01-30 18:02:30,172:INFO:   <<< cluser_embed_from_clip: 1
2024-01-30 18:02:30,172:INFO:   <<< cluster_algo: kmediods++
2024-01-30 18:02:30,172:INFO:   <<< cluster_distance: euclidean
2024-01-30 18:02:30,172:INFO:   <<< cluster_embedding: 0
2024-01-30 18:02:30,172:INFO:   <<< cluster_frame_embedding: 0
2024-01-30 18:02:30,172:INFO:   <<< cluster_iter_limit: 100
2024-01-30 18:02:30,172:INFO:   <<< cluster_threshold: 1e-05
2024-01-30 18:02:30,173:INFO:   <<< coef_lr: 0.001
2024-01-30 18:02:30,173:INFO:   <<< cross_model: cross-base
2024-01-30 18:02:30,173:INFO:   <<< cross_num_hidden_layers: 4
2024-01-30 18:02:30,173:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-30 18:02:30,173:INFO:   <<< datatype: charades
2024-01-30 18:02:30,173:INFO:   <<< do_eval: True
2024-01-30 18:02:30,173:INFO:   <<< do_lower_case: False
2024-01-30 18:02:30,173:INFO:   <<< do_pretrain: False
2024-01-30 18:02:30,173:INFO:   <<< do_train: False
2024-01-30 18:02:30,173:INFO:   <<< dynamic_alpha: False
2024-01-30 18:02:30,173:INFO:   <<< epochs: 20
2024-01-30 18:02:30,173:INFO:   <<< eval_frame_order: 0
2024-01-30 18:02:30,173:INFO:   <<< expand_msrvtt_sentences: False
2024-01-30 18:02:30,173:INFO:   <<< feature_framerate: 1
2024-01-30 18:02:30,173:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-30 18:02:30,173:INFO:   <<< fp16: False
2024-01-30 18:02:30,173:INFO:   <<< fp16_opt_level: O1
2024-01-30 18:02:30,173:INFO:   <<< freeze_layer_num: 0
2024-01-30 18:02:30,173:INFO:   <<< gradient_accumulation_steps: 1
2024-01-30 18:02:30,173:INFO:   <<< hard_negative_rate: 0.5
2024-01-30 18:02:30,173:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-30 18:02:30,173:INFO:   <<< linear_patch: 2d
2024-01-30 18:02:30,173:INFO:   <<< local_rank: 0
2024-01-30 18:02:30,173:INFO:   <<< loose_type: True
2024-01-30 18:02:30,173:INFO:   <<< loss: balanced
2024-01-30 18:02:30,173:INFO:   <<< lr: 0.0001
2024-01-30 18:02:30,173:INFO:   <<< lr_decay: 0.9
2024-01-30 18:02:30,173:INFO:   <<< margin: 0.1
2024-01-30 18:02:30,173:INFO:   <<< max_frames: 64
2024-01-30 18:02:30,174:INFO:   <<< max_words: 77
2024-01-30 18:02:30,174:INFO:   <<< minkowski_norm_p: 2.0
2024-01-30 18:02:30,174:INFO:   <<< n_display: 100
2024-01-30 18:02:30,174:INFO:   <<< n_gpu: 1
2024-01-30 18:02:30,174:INFO:   <<< n_pair: 1
2024-01-30 18:02:30,174:INFO:   <<< negative_weighting: 1
2024-01-30 18:02:30,174:INFO:   <<< num_thread_reader: 4
2024-01-30 18:02:30,174:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-30 18:02:30,174:INFO:   <<< post_cluster_centroids: 16
2024-01-30 18:02:30,174:INFO:   <<< post_process: cluster
2024-01-30 18:02:30,174:INFO:   <<< pre_norm: 0
2024-01-30 18:02:30,174:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-30 18:02:30,174:INFO:   <<< rank: 0
2024-01-30 18:02:30,174:INFO:   <<< resume_model: None
2024-01-30 18:02:30,174:INFO:   <<< sampled_use_mil: False
2024-01-30 18:02:30,174:INFO:   <<< save_feature_path: None
2024-01-30 18:02:30,174:INFO:   <<< seed: 42
2024-01-30 18:02:30,174:INFO:   <<< sim_header: meanP
2024-01-30 18:02:30,174:INFO:   <<< sim_lambda: 0.0
2024-01-30 18:02:30,174:INFO:   <<< slice_framepos: 2
2024-01-30 18:02:30,174:INFO:   <<< task_type: retrieval
2024-01-30 18:02:30,174:INFO:   <<< temperature_new: 1.0
2024-01-30 18:02:30,174:INFO:   <<< text_num_hidden_layers: 12
2024-01-30 18:02:30,174:INFO:   <<< time_embedding: 0
2024-01-30 18:02:30,174:INFO:   <<< train_csv: data/.train.csv
2024-01-30 18:02:30,174:INFO:   <<< train_frame_order: 0
2024-01-30 18:02:30,174:INFO:   <<< use_mil: False
2024-01-30 18:02:30,174:INFO:   <<< val_csv: data/.val.csv
2024-01-30 18:02:30,174:INFO:   <<< video_dim: 1024
2024-01-30 18:02:30,174:INFO:   <<< visual_num_hidden_layers: 12
2024-01-30 18:02:30,174:INFO:   <<< warmup_proportion: 0.1
2024-01-30 18:02:30,175:INFO:   <<< world_size: 1
2024-01-30 18:02:30,175:INFO: device: cuda:0 n_gpu: 1
2024-01-30 18:02:30,680:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-30 18:02:30,680:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-30 18:02:30,680:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-30 18:02:30,681:WARNING: Stage-One:True, Stage-Two:False
2024-01-30 18:02:30,681:WARNING: Test retrieval by loose type.
2024-01-30 18:02:30,681:WARNING: 	 embed_dim: 512
2024-01-30 18:02:30,681:WARNING: 	 image_resolution: 224
2024-01-30 18:02:30,681:WARNING: 	 vision_layers: 12
2024-01-30 18:02:30,681:WARNING: 	 vision_width: 768
2024-01-30 18:02:30,681:WARNING: 	 vision_patch_size: 32
2024-01-30 18:02:30,681:WARNING: 	 context_length: 77
2024-01-30 18:02:30,681:WARNING: 	 vocab_size: 49408
2024-01-30 18:02:30,681:WARNING: 	 transformer_width: 512
2024-01-30 18:02:30,681:WARNING: 	 transformer_heads: 8
2024-01-30 18:02:30,681:WARNING: 	 transformer_layers: 12
2024-01-30 18:02:30,681:WARNING: 		 linear_patch: 2d
2024-01-30 18:02:30,681:WARNING: 	 cut_top_layer: 0
2024-01-30 18:02:31,704:WARNING: 	 sim_header: meanP
2024-01-30 18:02:34,274:INFO: --------------------
2024-01-30 18:02:34,274:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-30 18:02:35,824:INFO: ***** Running test *****
2024-01-30 18:02:35,824:INFO:   Num examples = 1334
2024-01-30 18:02:35,824:INFO:   Batch size = 16
2024-01-30 18:02:35,825:INFO:   Num steps = 42
2024-01-30 18:02:35,825:INFO: ***** Running val *****
2024-01-30 18:02:35,825:INFO:   Num examples = 1334
2024-01-30 18:02:35,826:INFO: model evaluation on 1 GPU
2024-01-30 18:05:44,901:INFO: sim matrix size: 3720, 1334
2024-01-30 18:05:46,572:INFO: Saving the matrixs and metrics on local.
2024-01-30 18:05:46,748:INFO: Saving finished.
2024-01-30 18:05:46,748:INFO: Text to video:
2024-01-30 18:05:46,749:INFO: mean_mean: 361.03387096774196
2024-01-30 18:05:46,749:INFO: mean_median: 361.03387096774196
2024-01-30 18:05:46,749:INFO: median_mean: 244.0
2024-01-30 18:05:46,749:INFO: median_median: 244.0
2024-01-30 18:05:46,749:INFO: hit_ratio_1: 0.00967741935483871
2024-01-30 18:05:46,749:INFO: best_1: 0.00967741935483871
2024-01-30 18:05:46,749:INFO: worst_1: 0.00967741935483871
2024-01-30 18:05:46,749:INFO: hit_ratio_5: 0.03575268817204301
2024-01-30 18:05:46,749:INFO: best_5: 0.03575268817204301
2024-01-30 18:05:46,749:INFO: worst_5: 0.03575268817204301
2024-01-30 18:05:46,749:INFO: hit_ratio_10: 0.06693548387096775
2024-01-30 18:05:46,749:INFO: best_10: 0.06693548387096775
2024-01-30 18:05:46,749:INFO: worst_10: 0.06693548387096775
2024-01-30 18:05:46,749:INFO: hit_ratio_50: 0.1989247311827957
2024-01-30 18:05:46,749:INFO: best_50: 0.1989247311827957
2024-01-30 18:05:46,749:INFO: worst_50: 0.1989247311827957
2024-01-30 18:05:46,749:INFO: hit_ratio_100: 0.30806451612903224
2024-01-30 18:05:46,749:INFO: best_100: 0.30806451612903224
2024-01-30 18:05:46,749:INFO: worst_100: 0.30806451612903224
2024-01-30 18:05:46,749:INFO: Video to text:
2024-01-30 18:05:46,749:INFO: mean_mean: 1061.7193233740272
2024-01-30 18:05:46,749:INFO: mean_median: 1023.7293853073463
2024-01-30 18:05:46,749:INFO: median_mean: 895.8809523809524
2024-01-30 18:05:46,749:INFO: median_median: 801.75
2024-01-30 18:05:46,749:INFO: hit_ratio_1: 0.00789158991932605
2024-01-30 18:05:46,749:INFO: best_1: 0.017991004497751123
2024-01-30 18:05:46,749:INFO: worst_1: 0.0029985007496251873
2024-01-30 18:05:46,749:INFO: hit_ratio_5: 0.02901079222293615
2024-01-30 18:05:46,749:INFO: best_5: 0.060719640179910044
2024-01-30 18:05:46,750:INFO: worst_5: 0.01424287856071964
2024-01-30 18:05:46,750:INFO: hit_ratio_10: 0.0412823350229647
2024-01-30 18:05:46,750:INFO: best_10: 0.08845577211394302
2024-01-30 18:05:46,750:INFO: worst_10: 0.017241379310344827
2024-01-30 18:05:46,750:INFO: hit_ratio_50: 0.10810398372242451
2024-01-30 18:05:46,750:INFO: best_50: 0.22263868065967016
2024-01-30 18:05:46,750:INFO: worst_50: 0.044977511244377814
2024-01-30 18:05:46,750:INFO: hit_ratio_100: 0.16872873087265888
2024-01-30 18:05:46,750:INFO: best_100: 0.31334332833583206
2024-01-30 18:05:46,750:INFO: worst_100: 0.07571214392803598
2024-01-31 15:32:06,451:INFO: Effective parameters:
2024-01-31 15:32:06,451:INFO:   <<< adaptive_cls: 0
2024-01-31 15:32:06,451:INFO:   <<< aggregation: None
2024-01-31 15:32:06,451:INFO:   <<< alpha: 1.0
2024-01-31 15:32:06,451:INFO:   <<< batch_size: 32
2024-01-31 15:32:06,451:INFO:   <<< batch_size_val: 16
2024-01-31 15:32:06,451:INFO:   <<< cache_dir: 
2024-01-31 15:32:06,451:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 15:32:06,451:INFO:   <<< cluster_algo: kmediods++
2024-01-31 15:32:06,451:INFO:   <<< cluster_distance: euclidean
2024-01-31 15:32:06,451:INFO:   <<< cluster_embedding: 0
2024-01-31 15:32:06,452:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 15:32:06,452:INFO:   <<< cluster_iter_limit: 100
2024-01-31 15:32:06,452:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 15:32:06,452:INFO:   <<< coef_lr: 0.001
2024-01-31 15:32:06,452:INFO:   <<< cross_model: cross-base
2024-01-31 15:32:06,452:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 15:32:06,452:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 15:32:06,452:INFO:   <<< datatype: charades
2024-01-31 15:32:06,452:INFO:   <<< do_eval: True
2024-01-31 15:32:06,452:INFO:   <<< do_lower_case: False
2024-01-31 15:32:06,452:INFO:   <<< do_pretrain: False
2024-01-31 15:32:06,452:INFO:   <<< do_train: False
2024-01-31 15:32:06,452:INFO:   <<< dynamic_alpha: False
2024-01-31 15:32:06,452:INFO:   <<< epochs: 20
2024-01-31 15:32:06,452:INFO:   <<< eval_frame_order: 0
2024-01-31 15:32:06,452:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 15:32:06,452:INFO:   <<< feature_framerate: 1
2024-01-31 15:32:06,452:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 15:32:06,452:INFO:   <<< fp16: False
2024-01-31 15:32:06,452:INFO:   <<< fp16_opt_level: O1
2024-01-31 15:32:06,452:INFO:   <<< freeze_layer_num: 0
2024-01-31 15:32:06,452:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 15:32:06,452:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 15:32:06,452:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 15:32:06,452:INFO:   <<< linear_patch: 2d
2024-01-31 15:32:06,452:INFO:   <<< local_rank: 0
2024-01-31 15:32:06,452:INFO:   <<< loose_type: True
2024-01-31 15:32:06,452:INFO:   <<< loss: balanced
2024-01-31 15:32:06,452:INFO:   <<< lr: 0.0001
2024-01-31 15:32:06,452:INFO:   <<< lr_decay: 0.9
2024-01-31 15:32:06,452:INFO:   <<< margin: 0.1
2024-01-31 15:32:06,453:INFO:   <<< max_frames: 64
2024-01-31 15:32:06,453:INFO:   <<< max_words: 77
2024-01-31 15:32:06,453:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 15:32:06,453:INFO:   <<< n_display: 100
2024-01-31 15:32:06,453:INFO:   <<< n_gpu: 1
2024-01-31 15:32:06,453:INFO:   <<< n_pair: 1
2024-01-31 15:32:06,453:INFO:   <<< negative_weighting: 1
2024-01-31 15:32:06,453:INFO:   <<< num_thread_reader: 4
2024-01-31 15:32:06,453:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 15:32:06,453:INFO:   <<< post_cluster_centroids: 16
2024-01-31 15:32:06,453:INFO:   <<< post_process: cluster
2024-01-31 15:32:06,453:INFO:   <<< pre_norm: 0
2024-01-31 15:32:06,453:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 15:32:06,453:INFO:   <<< rank: 0
2024-01-31 15:32:06,453:INFO:   <<< resume_model: None
2024-01-31 15:32:06,453:INFO:   <<< sampled_use_mil: False
2024-01-31 15:32:06,453:INFO:   <<< save_feature_path: None
2024-01-31 15:32:06,453:INFO:   <<< seed: 42
2024-01-31 15:32:06,453:INFO:   <<< sim_header: meanP
2024-01-31 15:32:06,453:INFO:   <<< sim_lambda: 0.0
2024-01-31 15:32:06,453:INFO:   <<< slice_framepos: 2
2024-01-31 15:32:06,453:INFO:   <<< task_type: retrieval
2024-01-31 15:32:06,453:INFO:   <<< temperature_new: 1.0
2024-01-31 15:32:06,453:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 15:32:06,453:INFO:   <<< time_embedding: 0
2024-01-31 15:32:06,453:INFO:   <<< train_csv: data/.train.csv
2024-01-31 15:32:06,453:INFO:   <<< train_frame_order: 0
2024-01-31 15:32:06,453:INFO:   <<< use_mil: False
2024-01-31 15:32:06,453:INFO:   <<< val_csv: data/.val.csv
2024-01-31 15:32:06,453:INFO:   <<< video_dim: 1024
2024-01-31 15:32:06,453:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 15:32:06,453:INFO:   <<< warmup_proportion: 0.1
2024-01-31 15:32:06,453:INFO:   <<< world_size: 1
2024-01-31 15:32:06,453:INFO: device: cuda:0 n_gpu: 1
2024-01-31 15:32:07,040:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 15:32:07,041:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 15:32:07,041:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 15:32:07,041:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 15:32:07,041:WARNING: Test retrieval by loose type.
2024-01-31 15:32:07,041:WARNING: 	 embed_dim: 512
2024-01-31 15:32:07,041:WARNING: 	 image_resolution: 224
2024-01-31 15:32:07,041:WARNING: 	 vision_layers: 12
2024-01-31 15:32:07,041:WARNING: 	 vision_width: 768
2024-01-31 15:32:07,041:WARNING: 	 vision_patch_size: 32
2024-01-31 15:32:07,041:WARNING: 	 context_length: 77
2024-01-31 15:32:07,041:WARNING: 	 vocab_size: 49408
2024-01-31 15:32:07,041:WARNING: 	 transformer_width: 512
2024-01-31 15:32:07,041:WARNING: 	 transformer_heads: 8
2024-01-31 15:32:07,042:WARNING: 	 transformer_layers: 12
2024-01-31 15:32:07,042:WARNING: 		 linear_patch: 2d
2024-01-31 15:32:07,042:WARNING: 	 cut_top_layer: 0
2024-01-31 15:32:08,065:WARNING: 	 sim_header: meanP
2024-01-31 15:32:10,619:INFO: --------------------
2024-01-31 15:32:10,619:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 15:32:12,141:INFO: ***** Running test *****
2024-01-31 15:32:12,141:INFO:   Num examples = 1334
2024-01-31 15:32:12,141:INFO:   Batch size = 16
2024-01-31 15:32:12,141:INFO:   Num steps = 42
2024-01-31 15:32:12,141:INFO: ***** Running val *****
2024-01-31 15:32:12,141:INFO:   Num examples = 1334
2024-01-31 15:32:12,142:INFO: model evaluation on 1 GPU
2024-01-31 15:34:12,886:INFO: Effective parameters:
2024-01-31 15:34:12,887:INFO:   <<< adaptive_cls: 0
2024-01-31 15:34:12,887:INFO:   <<< aggregation: None
2024-01-31 15:34:12,887:INFO:   <<< alpha: 1.0
2024-01-31 15:34:12,887:INFO:   <<< batch_size: 2
2024-01-31 15:34:12,887:INFO:   <<< batch_size_val: 16
2024-01-31 15:34:12,887:INFO:   <<< cache_dir: 
2024-01-31 15:34:12,887:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 15:34:12,887:INFO:   <<< cluster_algo: kmediods++
2024-01-31 15:34:12,887:INFO:   <<< cluster_distance: euclidean
2024-01-31 15:34:12,887:INFO:   <<< cluster_embedding: 0
2024-01-31 15:34:12,887:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 15:34:12,887:INFO:   <<< cluster_iter_limit: 100
2024-01-31 15:34:12,887:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 15:34:12,887:INFO:   <<< coef_lr: 0.001
2024-01-31 15:34:12,887:INFO:   <<< cross_model: cross-base
2024-01-31 15:34:12,887:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 15:34:12,887:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 15:34:12,887:INFO:   <<< datatype: charades
2024-01-31 15:34:12,887:INFO:   <<< do_eval: True
2024-01-31 15:34:12,887:INFO:   <<< do_lower_case: False
2024-01-31 15:34:12,887:INFO:   <<< do_pretrain: False
2024-01-31 15:34:12,887:INFO:   <<< do_train: False
2024-01-31 15:34:12,887:INFO:   <<< dynamic_alpha: False
2024-01-31 15:34:12,887:INFO:   <<< epochs: 20
2024-01-31 15:34:12,887:INFO:   <<< eval_frame_order: 0
2024-01-31 15:34:12,887:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 15:34:12,887:INFO:   <<< feature_framerate: 1
2024-01-31 15:34:12,887:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 15:34:12,887:INFO:   <<< fp16: False
2024-01-31 15:34:12,887:INFO:   <<< fp16_opt_level: O1
2024-01-31 15:34:12,887:INFO:   <<< freeze_layer_num: 0
2024-01-31 15:34:12,887:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 15:34:12,888:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 15:34:12,888:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 15:34:12,888:INFO:   <<< linear_patch: 2d
2024-01-31 15:34:12,888:INFO:   <<< local_rank: 0
2024-01-31 15:34:12,888:INFO:   <<< loose_type: True
2024-01-31 15:34:12,888:INFO:   <<< loss: balanced
2024-01-31 15:34:12,888:INFO:   <<< lr: 0.0001
2024-01-31 15:34:12,888:INFO:   <<< lr_decay: 0.9
2024-01-31 15:34:12,888:INFO:   <<< margin: 0.1
2024-01-31 15:34:12,888:INFO:   <<< max_frames: 64
2024-01-31 15:34:12,888:INFO:   <<< max_words: 77
2024-01-31 15:34:12,888:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 15:34:12,888:INFO:   <<< n_display: 100
2024-01-31 15:34:12,888:INFO:   <<< n_gpu: 1
2024-01-31 15:34:12,888:INFO:   <<< n_pair: 1
2024-01-31 15:34:12,888:INFO:   <<< negative_weighting: 1
2024-01-31 15:34:12,888:INFO:   <<< num_thread_reader: 1
2024-01-31 15:34:12,888:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 15:34:12,888:INFO:   <<< post_cluster_centroids: 16
2024-01-31 15:34:12,888:INFO:   <<< post_process: cluster
2024-01-31 15:34:12,888:INFO:   <<< pre_norm: 0
2024-01-31 15:34:12,888:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 15:34:12,888:INFO:   <<< rank: 0
2024-01-31 15:34:12,888:INFO:   <<< resume_model: None
2024-01-31 15:34:12,888:INFO:   <<< sampled_use_mil: False
2024-01-31 15:34:12,888:INFO:   <<< save_feature_path: None
2024-01-31 15:34:12,888:INFO:   <<< seed: 42
2024-01-31 15:34:12,888:INFO:   <<< sim_header: meanP
2024-01-31 15:34:12,888:INFO:   <<< sim_lambda: 0.0
2024-01-31 15:34:12,888:INFO:   <<< slice_framepos: 2
2024-01-31 15:34:12,888:INFO:   <<< task_type: retrieval
2024-01-31 15:34:12,888:INFO:   <<< temperature_new: 1.0
2024-01-31 15:34:12,888:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 15:34:12,888:INFO:   <<< time_embedding: 0
2024-01-31 15:34:12,888:INFO:   <<< train_csv: data/.train.csv
2024-01-31 15:34:12,888:INFO:   <<< train_frame_order: 0
2024-01-31 15:34:12,888:INFO:   <<< use_mil: False
2024-01-31 15:34:12,889:INFO:   <<< val_csv: data/.val.csv
2024-01-31 15:34:12,889:INFO:   <<< video_dim: 1024
2024-01-31 15:34:12,889:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 15:34:12,889:INFO:   <<< warmup_proportion: 0.1
2024-01-31 15:34:12,889:INFO:   <<< world_size: 1
2024-01-31 15:34:12,889:INFO: device: cuda:0 n_gpu: 1
2024-01-31 15:34:13,401:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 15:34:13,401:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 15:34:13,401:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 15:34:13,401:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 15:34:13,401:WARNING: Test retrieval by loose type.
2024-01-31 15:34:13,401:WARNING: 	 embed_dim: 512
2024-01-31 15:34:13,402:WARNING: 	 image_resolution: 224
2024-01-31 15:34:13,402:WARNING: 	 vision_layers: 12
2024-01-31 15:34:13,402:WARNING: 	 vision_width: 768
2024-01-31 15:34:13,402:WARNING: 	 vision_patch_size: 32
2024-01-31 15:34:13,402:WARNING: 	 context_length: 77
2024-01-31 15:34:13,402:WARNING: 	 vocab_size: 49408
2024-01-31 15:34:13,402:WARNING: 	 transformer_width: 512
2024-01-31 15:34:13,402:WARNING: 	 transformer_heads: 8
2024-01-31 15:34:13,402:WARNING: 	 transformer_layers: 12
2024-01-31 15:34:13,402:WARNING: 		 linear_patch: 2d
2024-01-31 15:34:13,402:WARNING: 	 cut_top_layer: 0
2024-01-31 15:34:14,519:WARNING: 	 sim_header: meanP
2024-01-31 15:34:17,122:INFO: --------------------
2024-01-31 15:34:17,123:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 15:34:18,732:INFO: ***** Running test *****
2024-01-31 15:34:18,732:INFO:   Num examples = 1334
2024-01-31 15:34:18,732:INFO:   Batch size = 16
2024-01-31 15:34:18,732:INFO:   Num steps = 667
2024-01-31 15:34:18,732:INFO: ***** Running val *****
2024-01-31 15:34:18,732:INFO:   Num examples = 1334
2024-01-31 15:34:18,734:INFO: model evaluation on 1 GPU
2024-01-31 15:55:08,362:INFO: Effective parameters:
2024-01-31 15:55:08,362:INFO:   <<< adaptive_cls: 0
2024-01-31 15:55:08,362:INFO:   <<< aggregation: None
2024-01-31 15:55:08,362:INFO:   <<< alpha: 1.0
2024-01-31 15:55:08,362:INFO:   <<< batch_size: 2
2024-01-31 15:55:08,362:INFO:   <<< batch_size_val: 16
2024-01-31 15:55:08,362:INFO:   <<< cache_dir: 
2024-01-31 15:55:08,362:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 15:55:08,362:INFO:   <<< cluster_algo: kmediods++
2024-01-31 15:55:08,362:INFO:   <<< cluster_distance: euclidean
2024-01-31 15:55:08,362:INFO:   <<< cluster_embedding: 0
2024-01-31 15:55:08,362:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 15:55:08,362:INFO:   <<< cluster_iter_limit: 100
2024-01-31 15:55:08,362:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 15:55:08,362:INFO:   <<< coef_lr: 0.001
2024-01-31 15:55:08,362:INFO:   <<< cross_model: cross-base
2024-01-31 15:55:08,362:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 15:55:08,362:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 15:55:08,362:INFO:   <<< datatype: charades
2024-01-31 15:55:08,363:INFO:   <<< do_eval: True
2024-01-31 15:55:08,363:INFO:   <<< do_lower_case: False
2024-01-31 15:55:08,363:INFO:   <<< do_pretrain: False
2024-01-31 15:55:08,363:INFO:   <<< do_train: False
2024-01-31 15:55:08,363:INFO:   <<< dynamic_alpha: False
2024-01-31 15:55:08,363:INFO:   <<< epochs: 20
2024-01-31 15:55:08,363:INFO:   <<< eval_frame_order: 0
2024-01-31 15:55:08,363:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 15:55:08,363:INFO:   <<< feature_framerate: 1
2024-01-31 15:55:08,363:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 15:55:08,363:INFO:   <<< fp16: False
2024-01-31 15:55:08,363:INFO:   <<< fp16_opt_level: O1
2024-01-31 15:55:08,363:INFO:   <<< freeze_layer_num: 0
2024-01-31 15:55:08,363:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 15:55:08,363:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 15:55:08,363:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 15:55:08,363:INFO:   <<< linear_patch: 2d
2024-01-31 15:55:08,363:INFO:   <<< local_rank: 0
2024-01-31 15:55:08,363:INFO:   <<< loose_type: True
2024-01-31 15:55:08,363:INFO:   <<< loss: balanced
2024-01-31 15:55:08,363:INFO:   <<< lr: 0.0001
2024-01-31 15:55:08,363:INFO:   <<< lr_decay: 0.9
2024-01-31 15:55:08,363:INFO:   <<< margin: 0.1
2024-01-31 15:55:08,363:INFO:   <<< max_frames: 64
2024-01-31 15:55:08,363:INFO:   <<< max_words: 77
2024-01-31 15:55:08,363:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 15:55:08,363:INFO:   <<< n_display: 100
2024-01-31 15:55:08,363:INFO:   <<< n_gpu: 1
2024-01-31 15:55:08,363:INFO:   <<< n_pair: 1
2024-01-31 15:55:08,363:INFO:   <<< negative_weighting: 1
2024-01-31 15:55:08,363:INFO:   <<< num_thread_reader: 1
2024-01-31 15:55:08,363:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 15:55:08,363:INFO:   <<< post_cluster_centroids: 16
2024-01-31 15:55:08,363:INFO:   <<< post_process: cluster
2024-01-31 15:55:08,363:INFO:   <<< pre_norm: 0
2024-01-31 15:55:08,364:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 15:55:08,364:INFO:   <<< rank: 0
2024-01-31 15:55:08,364:INFO:   <<< resume_model: None
2024-01-31 15:55:08,364:INFO:   <<< sampled_use_mil: False
2024-01-31 15:55:08,364:INFO:   <<< save_feature_path: None
2024-01-31 15:55:08,364:INFO:   <<< seed: 42
2024-01-31 15:55:08,364:INFO:   <<< sim_header: meanP
2024-01-31 15:55:08,364:INFO:   <<< sim_lambda: 0.0
2024-01-31 15:55:08,364:INFO:   <<< slice_framepos: 2
2024-01-31 15:55:08,364:INFO:   <<< task_type: retrieval
2024-01-31 15:55:08,364:INFO:   <<< temperature_new: 1.0
2024-01-31 15:55:08,364:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 15:55:08,364:INFO:   <<< time_embedding: 0
2024-01-31 15:55:08,364:INFO:   <<< train_csv: data/.train.csv
2024-01-31 15:55:08,364:INFO:   <<< train_frame_order: 0
2024-01-31 15:55:08,364:INFO:   <<< use_mil: False
2024-01-31 15:55:08,364:INFO:   <<< val_csv: data/.val.csv
2024-01-31 15:55:08,364:INFO:   <<< video_dim: 1024
2024-01-31 15:55:08,364:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 15:55:08,364:INFO:   <<< warmup_proportion: 0.1
2024-01-31 15:55:08,364:INFO:   <<< world_size: 1
2024-01-31 15:55:08,364:INFO: device: cuda:0 n_gpu: 1
2024-01-31 15:55:08,868:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 15:55:08,868:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 15:55:08,868:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 15:55:08,868:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 15:55:08,868:WARNING: Test retrieval by loose type.
2024-01-31 15:55:08,869:WARNING: 	 embed_dim: 512
2024-01-31 15:55:08,869:WARNING: 	 image_resolution: 224
2024-01-31 15:55:08,869:WARNING: 	 vision_layers: 12
2024-01-31 15:55:08,869:WARNING: 	 vision_width: 768
2024-01-31 15:55:08,869:WARNING: 	 vision_patch_size: 32
2024-01-31 15:55:08,869:WARNING: 	 context_length: 77
2024-01-31 15:55:08,869:WARNING: 	 vocab_size: 49408
2024-01-31 15:55:08,869:WARNING: 	 transformer_width: 512
2024-01-31 15:55:08,869:WARNING: 	 transformer_heads: 8
2024-01-31 15:55:08,869:WARNING: 	 transformer_layers: 12
2024-01-31 15:55:08,869:WARNING: 		 linear_patch: 2d
2024-01-31 15:55:08,869:WARNING: 	 cut_top_layer: 0
2024-01-31 15:55:09,931:WARNING: 	 sim_header: meanP
2024-01-31 15:55:12,500:INFO: --------------------
2024-01-31 15:55:12,500:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 15:55:14,040:INFO: ***** Running test *****
2024-01-31 15:55:14,040:INFO:   Num examples = 1334
2024-01-31 15:55:14,040:INFO:   Batch size = 16
2024-01-31 15:55:14,040:INFO:   Num steps = 667
2024-01-31 15:55:14,040:INFO: ***** Running val *****
2024-01-31 15:55:14,040:INFO:   Num examples = 1334
2024-01-31 15:55:14,042:INFO: model evaluation on 1 GPU
2024-01-31 16:00:07,666:INFO: Effective parameters:
2024-01-31 16:00:07,666:INFO:   <<< adaptive_cls: 0
2024-01-31 16:00:07,666:INFO:   <<< aggregation: None
2024-01-31 16:00:07,666:INFO:   <<< alpha: 1.0
2024-01-31 16:00:07,666:INFO:   <<< batch_size: 2
2024-01-31 16:00:07,666:INFO:   <<< batch_size_val: 16
2024-01-31 16:00:07,666:INFO:   <<< cache_dir: 
2024-01-31 16:00:07,666:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:00:07,666:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:00:07,666:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:00:07,666:INFO:   <<< cluster_embedding: 0
2024-01-31 16:00:07,666:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:00:07,666:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:00:07,666:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:00:07,666:INFO:   <<< coef_lr: 0.001
2024-01-31 16:00:07,666:INFO:   <<< cross_model: cross-base
2024-01-31 16:00:07,666:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:00:07,666:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:00:07,667:INFO:   <<< datatype: charades
2024-01-31 16:00:07,667:INFO:   <<< do_eval: True
2024-01-31 16:00:07,667:INFO:   <<< do_lower_case: False
2024-01-31 16:00:07,667:INFO:   <<< do_pretrain: False
2024-01-31 16:00:07,667:INFO:   <<< do_train: False
2024-01-31 16:00:07,667:INFO:   <<< dynamic_alpha: False
2024-01-31 16:00:07,667:INFO:   <<< epochs: 20
2024-01-31 16:00:07,667:INFO:   <<< eval_frame_order: 0
2024-01-31 16:00:07,667:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:00:07,667:INFO:   <<< feature_framerate: 1
2024-01-31 16:00:07,667:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:00:07,667:INFO:   <<< fp16: False
2024-01-31 16:00:07,667:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:00:07,667:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:00:07,667:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:00:07,667:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:00:07,667:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:00:07,667:INFO:   <<< linear_patch: 2d
2024-01-31 16:00:07,667:INFO:   <<< local_rank: 0
2024-01-31 16:00:07,667:INFO:   <<< loose_type: True
2024-01-31 16:00:07,667:INFO:   <<< loss: balanced
2024-01-31 16:00:07,667:INFO:   <<< lr: 0.0001
2024-01-31 16:00:07,667:INFO:   <<< lr_decay: 0.9
2024-01-31 16:00:07,667:INFO:   <<< margin: 0.1
2024-01-31 16:00:07,667:INFO:   <<< max_frames: 64
2024-01-31 16:00:07,667:INFO:   <<< max_words: 77
2024-01-31 16:00:07,667:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:00:07,667:INFO:   <<< n_display: 100
2024-01-31 16:00:07,667:INFO:   <<< n_gpu: 1
2024-01-31 16:00:07,667:INFO:   <<< n_pair: 1
2024-01-31 16:00:07,667:INFO:   <<< negative_weighting: 1
2024-01-31 16:00:07,667:INFO:   <<< num_thread_reader: 1
2024-01-31 16:00:07,667:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:00:07,667:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:00:07,667:INFO:   <<< post_process: cluster
2024-01-31 16:00:07,667:INFO:   <<< pre_norm: 0
2024-01-31 16:00:07,667:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:00:07,667:INFO:   <<< rank: 0
2024-01-31 16:00:07,668:INFO:   <<< resume_model: None
2024-01-31 16:00:07,668:INFO:   <<< sampled_use_mil: False
2024-01-31 16:00:07,668:INFO:   <<< save_feature_path: None
2024-01-31 16:00:07,668:INFO:   <<< seed: 42
2024-01-31 16:00:07,668:INFO:   <<< sim_header: meanP
2024-01-31 16:00:07,668:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:00:07,668:INFO:   <<< slice_framepos: 2
2024-01-31 16:00:07,668:INFO:   <<< task_type: retrieval
2024-01-31 16:00:07,668:INFO:   <<< temperature_new: 1.0
2024-01-31 16:00:07,668:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:00:07,668:INFO:   <<< time_embedding: 0
2024-01-31 16:00:07,668:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:00:07,668:INFO:   <<< train_frame_order: 0
2024-01-31 16:00:07,668:INFO:   <<< use_mil: False
2024-01-31 16:00:07,668:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:00:07,668:INFO:   <<< video_dim: 1024
2024-01-31 16:00:07,668:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:00:07,668:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:00:07,668:INFO:   <<< world_size: 1
2024-01-31 16:00:07,668:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:00:08,168:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:00:08,169:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:00:08,169:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:00:08,169:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:00:08,169:WARNING: Test retrieval by loose type.
2024-01-31 16:00:08,169:WARNING: 	 embed_dim: 512
2024-01-31 16:00:08,169:WARNING: 	 image_resolution: 224
2024-01-31 16:00:08,169:WARNING: 	 vision_layers: 12
2024-01-31 16:00:08,169:WARNING: 	 vision_width: 768
2024-01-31 16:00:08,170:WARNING: 	 vision_patch_size: 32
2024-01-31 16:00:08,170:WARNING: 	 context_length: 77
2024-01-31 16:00:08,170:WARNING: 	 vocab_size: 49408
2024-01-31 16:00:08,170:WARNING: 	 transformer_width: 512
2024-01-31 16:00:08,170:WARNING: 	 transformer_heads: 8
2024-01-31 16:00:08,170:WARNING: 	 transformer_layers: 12
2024-01-31 16:00:08,170:WARNING: 		 linear_patch: 2d
2024-01-31 16:00:08,170:WARNING: 	 cut_top_layer: 0
2024-01-31 16:00:09,185:WARNING: 	 sim_header: meanP
2024-01-31 16:00:11,739:INFO: --------------------
2024-01-31 16:00:11,739:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:00:13,265:INFO: ***** Running test *****
2024-01-31 16:00:13,265:INFO:   Num examples = 1334
2024-01-31 16:00:13,265:INFO:   Batch size = 16
2024-01-31 16:00:13,265:INFO:   Num steps = 667
2024-01-31 16:00:13,265:INFO: ***** Running val *****
2024-01-31 16:00:13,265:INFO:   Num examples = 1334
2024-01-31 16:00:13,267:INFO: model evaluation on 1 GPU
2024-01-31 16:00:24,429:INFO: Effective parameters:
2024-01-31 16:00:24,429:INFO:   <<< adaptive_cls: 0
2024-01-31 16:00:24,429:INFO:   <<< aggregation: None
2024-01-31 16:00:24,429:INFO:   <<< alpha: 1.0
2024-01-31 16:00:24,429:INFO:   <<< batch_size: 2
2024-01-31 16:00:24,429:INFO:   <<< batch_size_val: 16
2024-01-31 16:00:24,429:INFO:   <<< cache_dir: 
2024-01-31 16:00:24,429:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:00:24,429:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:00:24,429:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:00:24,429:INFO:   <<< cluster_embedding: 0
2024-01-31 16:00:24,429:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:00:24,429:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:00:24,429:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:00:24,429:INFO:   <<< coef_lr: 0.001
2024-01-31 16:00:24,429:INFO:   <<< cross_model: cross-base
2024-01-31 16:00:24,429:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:00:24,429:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:00:24,429:INFO:   <<< datatype: charades
2024-01-31 16:00:24,429:INFO:   <<< do_eval: True
2024-01-31 16:00:24,429:INFO:   <<< do_lower_case: False
2024-01-31 16:00:24,429:INFO:   <<< do_pretrain: False
2024-01-31 16:00:24,430:INFO:   <<< do_train: False
2024-01-31 16:00:24,430:INFO:   <<< dynamic_alpha: False
2024-01-31 16:00:24,430:INFO:   <<< epochs: 20
2024-01-31 16:00:24,430:INFO:   <<< eval_frame_order: 0
2024-01-31 16:00:24,430:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:00:24,430:INFO:   <<< feature_framerate: 1
2024-01-31 16:00:24,430:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:00:24,430:INFO:   <<< fp16: False
2024-01-31 16:00:24,430:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:00:24,430:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:00:24,430:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:00:24,430:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:00:24,430:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:00:24,430:INFO:   <<< linear_patch: 2d
2024-01-31 16:00:24,430:INFO:   <<< local_rank: 0
2024-01-31 16:00:24,430:INFO:   <<< loose_type: True
2024-01-31 16:00:24,430:INFO:   <<< loss: balanced
2024-01-31 16:00:24,430:INFO:   <<< lr: 0.0001
2024-01-31 16:00:24,430:INFO:   <<< lr_decay: 0.9
2024-01-31 16:00:24,430:INFO:   <<< margin: 0.1
2024-01-31 16:00:24,430:INFO:   <<< max_frames: 64
2024-01-31 16:00:24,430:INFO:   <<< max_words: 77
2024-01-31 16:00:24,430:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:00:24,430:INFO:   <<< n_display: 100
2024-01-31 16:00:24,430:INFO:   <<< n_gpu: 1
2024-01-31 16:00:24,430:INFO:   <<< n_pair: 1
2024-01-31 16:00:24,430:INFO:   <<< negative_weighting: 1
2024-01-31 16:00:24,430:INFO:   <<< num_thread_reader: 1
2024-01-31 16:00:24,430:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:00:24,430:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:00:24,430:INFO:   <<< post_process: cluster
2024-01-31 16:00:24,430:INFO:   <<< pre_norm: 0
2024-01-31 16:00:24,430:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:00:24,430:INFO:   <<< rank: 0
2024-01-31 16:00:24,430:INFO:   <<< resume_model: None
2024-01-31 16:00:24,430:INFO:   <<< sampled_use_mil: False
2024-01-31 16:00:24,430:INFO:   <<< save_feature_path: None
2024-01-31 16:00:24,431:INFO:   <<< seed: 42
2024-01-31 16:00:24,431:INFO:   <<< sim_header: meanP
2024-01-31 16:00:24,431:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:00:24,431:INFO:   <<< slice_framepos: 2
2024-01-31 16:00:24,431:INFO:   <<< task_type: retrieval
2024-01-31 16:00:24,431:INFO:   <<< temperature_new: 1.0
2024-01-31 16:00:24,431:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:00:24,431:INFO:   <<< time_embedding: 0
2024-01-31 16:00:24,431:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:00:24,431:INFO:   <<< train_frame_order: 0
2024-01-31 16:00:24,431:INFO:   <<< use_mil: False
2024-01-31 16:00:24,431:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:00:24,431:INFO:   <<< video_dim: 1024
2024-01-31 16:00:24,431:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:00:24,431:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:00:24,431:INFO:   <<< world_size: 1
2024-01-31 16:00:24,431:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:00:24,930:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:00:24,930:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:00:24,930:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:00:24,930:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:00:24,930:WARNING: Test retrieval by loose type.
2024-01-31 16:00:24,931:WARNING: 	 embed_dim: 512
2024-01-31 16:00:24,931:WARNING: 	 image_resolution: 224
2024-01-31 16:00:24,931:WARNING: 	 vision_layers: 12
2024-01-31 16:00:24,931:WARNING: 	 vision_width: 768
2024-01-31 16:00:24,931:WARNING: 	 vision_patch_size: 32
2024-01-31 16:00:24,931:WARNING: 	 context_length: 77
2024-01-31 16:00:24,931:WARNING: 	 vocab_size: 49408
2024-01-31 16:00:24,931:WARNING: 	 transformer_width: 512
2024-01-31 16:00:24,931:WARNING: 	 transformer_heads: 8
2024-01-31 16:00:24,931:WARNING: 	 transformer_layers: 12
2024-01-31 16:00:24,931:WARNING: 		 linear_patch: 2d
2024-01-31 16:00:24,931:WARNING: 	 cut_top_layer: 0
2024-01-31 16:00:25,946:WARNING: 	 sim_header: meanP
2024-01-31 16:00:28,502:INFO: --------------------
2024-01-31 16:00:28,503:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:00:30,033:INFO: ***** Running test *****
2024-01-31 16:00:30,033:INFO:   Num examples = 1334
2024-01-31 16:00:30,034:INFO:   Batch size = 16
2024-01-31 16:00:30,034:INFO:   Num steps = 667
2024-01-31 16:00:30,034:INFO: ***** Running val *****
2024-01-31 16:00:30,034:INFO:   Num examples = 1334
2024-01-31 16:00:30,035:INFO: model evaluation on 1 GPU
2024-01-31 16:01:09,639:INFO: Effective parameters:
2024-01-31 16:01:09,639:INFO:   <<< adaptive_cls: 0
2024-01-31 16:01:09,639:INFO:   <<< aggregation: None
2024-01-31 16:01:09,639:INFO:   <<< alpha: 1.0
2024-01-31 16:01:09,639:INFO:   <<< batch_size: 2
2024-01-31 16:01:09,639:INFO:   <<< batch_size_val: 16
2024-01-31 16:01:09,639:INFO:   <<< cache_dir: 
2024-01-31 16:01:09,639:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:01:09,639:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:01:09,639:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:01:09,639:INFO:   <<< cluster_embedding: 0
2024-01-31 16:01:09,639:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:01:09,639:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:01:09,639:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:01:09,639:INFO:   <<< coef_lr: 0.001
2024-01-31 16:01:09,639:INFO:   <<< cross_model: cross-base
2024-01-31 16:01:09,639:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:01:09,639:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:01:09,639:INFO:   <<< datatype: charades
2024-01-31 16:01:09,639:INFO:   <<< do_eval: True
2024-01-31 16:01:09,639:INFO:   <<< do_lower_case: False
2024-01-31 16:01:09,639:INFO:   <<< do_pretrain: False
2024-01-31 16:01:09,639:INFO:   <<< do_train: False
2024-01-31 16:01:09,640:INFO:   <<< dynamic_alpha: False
2024-01-31 16:01:09,640:INFO:   <<< epochs: 20
2024-01-31 16:01:09,640:INFO:   <<< eval_frame_order: 0
2024-01-31 16:01:09,640:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:01:09,640:INFO:   <<< feature_framerate: 1
2024-01-31 16:01:09,640:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:01:09,640:INFO:   <<< fp16: False
2024-01-31 16:01:09,640:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:01:09,640:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:01:09,640:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:01:09,640:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:01:09,640:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:01:09,640:INFO:   <<< linear_patch: 2d
2024-01-31 16:01:09,640:INFO:   <<< local_rank: 0
2024-01-31 16:01:09,640:INFO:   <<< loose_type: True
2024-01-31 16:01:09,640:INFO:   <<< loss: balanced
2024-01-31 16:01:09,640:INFO:   <<< lr: 0.0001
2024-01-31 16:01:09,640:INFO:   <<< lr_decay: 0.9
2024-01-31 16:01:09,640:INFO:   <<< margin: 0.1
2024-01-31 16:01:09,640:INFO:   <<< max_frames: 64
2024-01-31 16:01:09,640:INFO:   <<< max_words: 77
2024-01-31 16:01:09,640:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:01:09,640:INFO:   <<< n_display: 100
2024-01-31 16:01:09,640:INFO:   <<< n_gpu: 1
2024-01-31 16:01:09,640:INFO:   <<< n_pair: 1
2024-01-31 16:01:09,640:INFO:   <<< negative_weighting: 1
2024-01-31 16:01:09,640:INFO:   <<< num_thread_reader: 1
2024-01-31 16:01:09,640:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:01:09,640:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:01:09,640:INFO:   <<< post_process: cluster
2024-01-31 16:01:09,640:INFO:   <<< pre_norm: 0
2024-01-31 16:01:09,640:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:01:09,640:INFO:   <<< rank: 0
2024-01-31 16:01:09,640:INFO:   <<< resume_model: None
2024-01-31 16:01:09,640:INFO:   <<< sampled_use_mil: False
2024-01-31 16:01:09,640:INFO:   <<< save_feature_path: None
2024-01-31 16:01:09,640:INFO:   <<< seed: 42
2024-01-31 16:01:09,640:INFO:   <<< sim_header: meanP
2024-01-31 16:01:09,641:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:01:09,641:INFO:   <<< slice_framepos: 2
2024-01-31 16:01:09,641:INFO:   <<< task_type: retrieval
2024-01-31 16:01:09,641:INFO:   <<< temperature_new: 1.0
2024-01-31 16:01:09,641:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:01:09,641:INFO:   <<< time_embedding: 0
2024-01-31 16:01:09,641:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:01:09,641:INFO:   <<< train_frame_order: 0
2024-01-31 16:01:09,641:INFO:   <<< use_mil: False
2024-01-31 16:01:09,641:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:01:09,641:INFO:   <<< video_dim: 1024
2024-01-31 16:01:09,641:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:01:09,641:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:01:09,641:INFO:   <<< world_size: 1
2024-01-31 16:01:09,641:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:01:10,141:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:01:10,142:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:01:10,142:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:01:10,142:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:01:10,142:WARNING: Test retrieval by loose type.
2024-01-31 16:01:10,142:WARNING: 	 embed_dim: 512
2024-01-31 16:01:10,142:WARNING: 	 image_resolution: 224
2024-01-31 16:01:10,142:WARNING: 	 vision_layers: 12
2024-01-31 16:01:10,142:WARNING: 	 vision_width: 768
2024-01-31 16:01:10,142:WARNING: 	 vision_patch_size: 32
2024-01-31 16:01:10,142:WARNING: 	 context_length: 77
2024-01-31 16:01:10,142:WARNING: 	 vocab_size: 49408
2024-01-31 16:01:10,142:WARNING: 	 transformer_width: 512
2024-01-31 16:01:10,142:WARNING: 	 transformer_heads: 8
2024-01-31 16:01:10,142:WARNING: 	 transformer_layers: 12
2024-01-31 16:01:10,143:WARNING: 		 linear_patch: 2d
2024-01-31 16:01:10,143:WARNING: 	 cut_top_layer: 0
2024-01-31 16:01:11,154:WARNING: 	 sim_header: meanP
2024-01-31 16:01:13,701:INFO: --------------------
2024-01-31 16:01:13,701:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:01:15,231:INFO: ***** Running test *****
2024-01-31 16:01:15,231:INFO:   Num examples = 1334
2024-01-31 16:01:15,232:INFO:   Batch size = 16
2024-01-31 16:01:15,232:INFO:   Num steps = 667
2024-01-31 16:01:15,232:INFO: ***** Running val *****
2024-01-31 16:01:15,232:INFO:   Num examples = 1334
2024-01-31 16:01:15,233:INFO: model evaluation on 1 GPU
2024-01-31 16:01:24,932:INFO: Effective parameters:
2024-01-31 16:01:24,932:INFO:   <<< adaptive_cls: 0
2024-01-31 16:01:24,932:INFO:   <<< aggregation: None
2024-01-31 16:01:24,932:INFO:   <<< alpha: 1.0
2024-01-31 16:01:24,932:INFO:   <<< batch_size: 2
2024-01-31 16:01:24,932:INFO:   <<< batch_size_val: 16
2024-01-31 16:01:24,932:INFO:   <<< cache_dir: 
2024-01-31 16:01:24,932:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:01:24,932:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:01:24,932:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:01:24,932:INFO:   <<< cluster_embedding: 0
2024-01-31 16:01:24,932:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:01:24,932:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:01:24,932:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:01:24,932:INFO:   <<< coef_lr: 0.001
2024-01-31 16:01:24,932:INFO:   <<< cross_model: cross-base
2024-01-31 16:01:24,933:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:01:24,933:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:01:24,933:INFO:   <<< datatype: charades
2024-01-31 16:01:24,933:INFO:   <<< do_eval: True
2024-01-31 16:01:24,933:INFO:   <<< do_lower_case: False
2024-01-31 16:01:24,933:INFO:   <<< do_pretrain: False
2024-01-31 16:01:24,933:INFO:   <<< do_train: False
2024-01-31 16:01:24,933:INFO:   <<< dynamic_alpha: False
2024-01-31 16:01:24,933:INFO:   <<< epochs: 20
2024-01-31 16:01:24,933:INFO:   <<< eval_frame_order: 0
2024-01-31 16:01:24,933:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:01:24,933:INFO:   <<< feature_framerate: 1
2024-01-31 16:01:24,933:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:01:24,933:INFO:   <<< fp16: False
2024-01-31 16:01:24,933:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:01:24,933:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:01:24,933:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:01:24,933:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:01:24,933:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:01:24,933:INFO:   <<< linear_patch: 2d
2024-01-31 16:01:24,933:INFO:   <<< local_rank: 0
2024-01-31 16:01:24,933:INFO:   <<< loose_type: True
2024-01-31 16:01:24,933:INFO:   <<< loss: balanced
2024-01-31 16:01:24,933:INFO:   <<< lr: 0.0001
2024-01-31 16:01:24,933:INFO:   <<< lr_decay: 0.9
2024-01-31 16:01:24,933:INFO:   <<< margin: 0.1
2024-01-31 16:01:24,933:INFO:   <<< max_frames: 64
2024-01-31 16:01:24,933:INFO:   <<< max_words: 77
2024-01-31 16:01:24,933:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:01:24,933:INFO:   <<< n_display: 100
2024-01-31 16:01:24,933:INFO:   <<< n_gpu: 1
2024-01-31 16:01:24,933:INFO:   <<< n_pair: 1
2024-01-31 16:01:24,933:INFO:   <<< negative_weighting: 1
2024-01-31 16:01:24,934:INFO:   <<< num_thread_reader: 1
2024-01-31 16:01:24,934:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:01:24,934:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:01:24,934:INFO:   <<< post_process: cluster
2024-01-31 16:01:24,934:INFO:   <<< pre_norm: 0
2024-01-31 16:01:24,934:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:01:24,934:INFO:   <<< rank: 0
2024-01-31 16:01:24,934:INFO:   <<< resume_model: None
2024-01-31 16:01:24,934:INFO:   <<< sampled_use_mil: False
2024-01-31 16:01:24,934:INFO:   <<< save_feature_path: None
2024-01-31 16:01:24,934:INFO:   <<< seed: 42
2024-01-31 16:01:24,934:INFO:   <<< sim_header: meanP
2024-01-31 16:01:24,934:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:01:24,934:INFO:   <<< slice_framepos: 2
2024-01-31 16:01:24,934:INFO:   <<< task_type: retrieval
2024-01-31 16:01:24,934:INFO:   <<< temperature_new: 1.0
2024-01-31 16:01:24,934:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:01:24,934:INFO:   <<< time_embedding: 0
2024-01-31 16:01:24,934:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:01:24,934:INFO:   <<< train_frame_order: 0
2024-01-31 16:01:24,934:INFO:   <<< use_mil: False
2024-01-31 16:01:24,934:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:01:24,934:INFO:   <<< video_dim: 1024
2024-01-31 16:01:24,934:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:01:24,934:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:01:24,934:INFO:   <<< world_size: 1
2024-01-31 16:01:24,934:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:01:25,434:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:01:25,434:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:01:25,434:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:01:25,434:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:01:25,434:WARNING: Test retrieval by loose type.
2024-01-31 16:01:25,435:WARNING: 	 embed_dim: 512
2024-01-31 16:01:25,435:WARNING: 	 image_resolution: 224
2024-01-31 16:01:25,435:WARNING: 	 vision_layers: 12
2024-01-31 16:01:25,435:WARNING: 	 vision_width: 768
2024-01-31 16:01:25,435:WARNING: 	 vision_patch_size: 32
2024-01-31 16:01:25,435:WARNING: 	 context_length: 77
2024-01-31 16:01:25,435:WARNING: 	 vocab_size: 49408
2024-01-31 16:01:25,435:WARNING: 	 transformer_width: 512
2024-01-31 16:01:25,435:WARNING: 	 transformer_heads: 8
2024-01-31 16:01:25,435:WARNING: 	 transformer_layers: 12
2024-01-31 16:01:25,435:WARNING: 		 linear_patch: 2d
2024-01-31 16:01:25,435:WARNING: 	 cut_top_layer: 0
2024-01-31 16:01:26,452:WARNING: 	 sim_header: meanP
2024-01-31 16:01:29,020:INFO: --------------------
2024-01-31 16:01:29,020:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:01:30,550:INFO: ***** Running test *****
2024-01-31 16:01:30,550:INFO:   Num examples = 1334
2024-01-31 16:01:30,550:INFO:   Batch size = 16
2024-01-31 16:01:30,550:INFO:   Num steps = 667
2024-01-31 16:01:30,550:INFO: ***** Running val *****
2024-01-31 16:01:30,550:INFO:   Num examples = 1334
2024-01-31 16:01:30,552:INFO: model evaluation on 1 GPU
2024-01-31 16:03:27,981:INFO: Effective parameters:
2024-01-31 16:03:27,981:INFO:   <<< adaptive_cls: 0
2024-01-31 16:03:27,981:INFO:   <<< aggregation: None
2024-01-31 16:03:27,981:INFO:   <<< alpha: 1.0
2024-01-31 16:03:27,981:INFO:   <<< batch_size: 2
2024-01-31 16:03:27,981:INFO:   <<< batch_size_val: 16
2024-01-31 16:03:27,981:INFO:   <<< cache_dir: 
2024-01-31 16:03:27,982:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:03:27,982:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:03:27,982:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:03:27,982:INFO:   <<< cluster_embedding: 0
2024-01-31 16:03:27,982:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:03:27,982:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:03:27,982:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:03:27,982:INFO:   <<< coef_lr: 0.001
2024-01-31 16:03:27,982:INFO:   <<< cross_model: cross-base
2024-01-31 16:03:27,982:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:03:27,982:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:03:27,982:INFO:   <<< datatype: charades
2024-01-31 16:03:27,982:INFO:   <<< do_eval: True
2024-01-31 16:03:27,982:INFO:   <<< do_lower_case: False
2024-01-31 16:03:27,982:INFO:   <<< do_pretrain: False
2024-01-31 16:03:27,982:INFO:   <<< do_train: False
2024-01-31 16:03:27,982:INFO:   <<< dynamic_alpha: False
2024-01-31 16:03:27,982:INFO:   <<< epochs: 20
2024-01-31 16:03:27,982:INFO:   <<< eval_frame_order: 0
2024-01-31 16:03:27,982:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:03:27,982:INFO:   <<< feature_framerate: 1
2024-01-31 16:03:27,982:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:03:27,982:INFO:   <<< fp16: False
2024-01-31 16:03:27,982:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:03:27,982:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:03:27,982:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:03:27,982:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:03:27,982:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:03:27,982:INFO:   <<< linear_patch: 2d
2024-01-31 16:03:27,982:INFO:   <<< local_rank: 0
2024-01-31 16:03:27,983:INFO:   <<< loose_type: True
2024-01-31 16:03:27,983:INFO:   <<< loss: balanced
2024-01-31 16:03:27,983:INFO:   <<< lr: 0.0001
2024-01-31 16:03:27,983:INFO:   <<< lr_decay: 0.9
2024-01-31 16:03:27,983:INFO:   <<< margin: 0.1
2024-01-31 16:03:27,983:INFO:   <<< max_frames: 64
2024-01-31 16:03:27,983:INFO:   <<< max_words: 77
2024-01-31 16:03:27,983:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:03:27,983:INFO:   <<< n_display: 100
2024-01-31 16:03:27,983:INFO:   <<< n_gpu: 1
2024-01-31 16:03:27,983:INFO:   <<< n_pair: 1
2024-01-31 16:03:27,983:INFO:   <<< negative_weighting: 1
2024-01-31 16:03:27,983:INFO:   <<< num_thread_reader: 1
2024-01-31 16:03:27,983:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:03:27,983:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:03:27,983:INFO:   <<< post_process: cluster
2024-01-31 16:03:27,983:INFO:   <<< pre_norm: 0
2024-01-31 16:03:27,983:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:03:27,983:INFO:   <<< rank: 0
2024-01-31 16:03:27,983:INFO:   <<< resume_model: None
2024-01-31 16:03:27,983:INFO:   <<< sampled_use_mil: False
2024-01-31 16:03:27,983:INFO:   <<< save_feature_path: None
2024-01-31 16:03:27,983:INFO:   <<< seed: 42
2024-01-31 16:03:27,983:INFO:   <<< sim_header: meanP
2024-01-31 16:03:27,983:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:03:27,983:INFO:   <<< slice_framepos: 2
2024-01-31 16:03:27,983:INFO:   <<< task_type: retrieval
2024-01-31 16:03:27,983:INFO:   <<< temperature_new: 1.0
2024-01-31 16:03:27,983:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:03:27,983:INFO:   <<< time_embedding: 0
2024-01-31 16:03:27,983:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:03:27,983:INFO:   <<< train_frame_order: 0
2024-01-31 16:03:27,983:INFO:   <<< use_mil: False
2024-01-31 16:03:27,983:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:03:27,983:INFO:   <<< video_dim: 1024
2024-01-31 16:03:27,983:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:03:27,983:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:03:27,984:INFO:   <<< world_size: 1
2024-01-31 16:03:27,984:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:03:28,485:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:03:28,485:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:03:28,486:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:03:28,486:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:03:28,486:WARNING: Test retrieval by loose type.
2024-01-31 16:03:28,486:WARNING: 	 embed_dim: 512
2024-01-31 16:03:28,486:WARNING: 	 image_resolution: 224
2024-01-31 16:03:28,486:WARNING: 	 vision_layers: 12
2024-01-31 16:03:28,486:WARNING: 	 vision_width: 768
2024-01-31 16:03:28,486:WARNING: 	 vision_patch_size: 32
2024-01-31 16:03:28,486:WARNING: 	 context_length: 77
2024-01-31 16:03:28,486:WARNING: 	 vocab_size: 49408
2024-01-31 16:03:28,486:WARNING: 	 transformer_width: 512
2024-01-31 16:03:28,486:WARNING: 	 transformer_heads: 8
2024-01-31 16:03:28,486:WARNING: 	 transformer_layers: 12
2024-01-31 16:03:28,486:WARNING: 		 linear_patch: 2d
2024-01-31 16:03:28,486:WARNING: 	 cut_top_layer: 0
2024-01-31 16:03:29,515:WARNING: 	 sim_header: meanP
2024-01-31 16:03:32,065:INFO: --------------------
2024-01-31 16:03:32,066:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:03:33,595:INFO: ***** Running test *****
2024-01-31 16:03:33,595:INFO:   Num examples = 1334
2024-01-31 16:03:33,595:INFO:   Batch size = 16
2024-01-31 16:03:33,595:INFO:   Num steps = 667
2024-01-31 16:03:33,595:INFO: ***** Running val *****
2024-01-31 16:03:33,595:INFO:   Num examples = 1334
2024-01-31 16:03:33,596:INFO: model evaluation on 1 GPU
2024-01-31 16:03:53,374:INFO: Effective parameters:
2024-01-31 16:03:53,374:INFO:   <<< adaptive_cls: 0
2024-01-31 16:03:53,374:INFO:   <<< aggregation: None
2024-01-31 16:03:53,374:INFO:   <<< alpha: 1.0
2024-01-31 16:03:53,374:INFO:   <<< batch_size: 2
2024-01-31 16:03:53,374:INFO:   <<< batch_size_val: 16
2024-01-31 16:03:53,374:INFO:   <<< cache_dir: 
2024-01-31 16:03:53,374:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:03:53,374:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:03:53,374:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:03:53,374:INFO:   <<< cluster_embedding: 0
2024-01-31 16:03:53,374:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:03:53,374:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:03:53,374:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:03:53,374:INFO:   <<< coef_lr: 0.001
2024-01-31 16:03:53,374:INFO:   <<< cross_model: cross-base
2024-01-31 16:03:53,374:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:03:53,374:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:03:53,374:INFO:   <<< datatype: charades
2024-01-31 16:03:53,374:INFO:   <<< do_eval: True
2024-01-31 16:03:53,374:INFO:   <<< do_lower_case: False
2024-01-31 16:03:53,374:INFO:   <<< do_pretrain: False
2024-01-31 16:03:53,374:INFO:   <<< do_train: False
2024-01-31 16:03:53,375:INFO:   <<< dynamic_alpha: False
2024-01-31 16:03:53,375:INFO:   <<< epochs: 20
2024-01-31 16:03:53,375:INFO:   <<< eval_frame_order: 0
2024-01-31 16:03:53,375:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:03:53,375:INFO:   <<< feature_framerate: 1
2024-01-31 16:03:53,375:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:03:53,375:INFO:   <<< fp16: False
2024-01-31 16:03:53,375:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:03:53,375:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:03:53,375:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:03:53,375:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:03:53,375:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:03:53,375:INFO:   <<< linear_patch: 2d
2024-01-31 16:03:53,375:INFO:   <<< local_rank: 0
2024-01-31 16:03:53,375:INFO:   <<< loose_type: True
2024-01-31 16:03:53,375:INFO:   <<< loss: balanced
2024-01-31 16:03:53,375:INFO:   <<< lr: 0.0001
2024-01-31 16:03:53,375:INFO:   <<< lr_decay: 0.9
2024-01-31 16:03:53,375:INFO:   <<< margin: 0.1
2024-01-31 16:03:53,375:INFO:   <<< max_frames: 64
2024-01-31 16:03:53,375:INFO:   <<< max_words: 77
2024-01-31 16:03:53,375:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:03:53,375:INFO:   <<< n_display: 100
2024-01-31 16:03:53,375:INFO:   <<< n_gpu: 1
2024-01-31 16:03:53,375:INFO:   <<< n_pair: 1
2024-01-31 16:03:53,375:INFO:   <<< negative_weighting: 1
2024-01-31 16:03:53,375:INFO:   <<< num_thread_reader: 1
2024-01-31 16:03:53,375:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:03:53,375:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:03:53,375:INFO:   <<< post_process: cluster
2024-01-31 16:03:53,375:INFO:   <<< pre_norm: 0
2024-01-31 16:03:53,375:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:03:53,375:INFO:   <<< rank: 0
2024-01-31 16:03:53,375:INFO:   <<< resume_model: None
2024-01-31 16:03:53,375:INFO:   <<< sampled_use_mil: False
2024-01-31 16:03:53,376:INFO:   <<< save_feature_path: None
2024-01-31 16:03:53,376:INFO:   <<< seed: 42
2024-01-31 16:03:53,376:INFO:   <<< sim_header: meanP
2024-01-31 16:03:53,376:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:03:53,376:INFO:   <<< slice_framepos: 2
2024-01-31 16:03:53,376:INFO:   <<< task_type: retrieval
2024-01-31 16:03:53,376:INFO:   <<< temperature_new: 1.0
2024-01-31 16:03:53,376:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:03:53,376:INFO:   <<< time_embedding: 0
2024-01-31 16:03:53,376:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:03:53,376:INFO:   <<< train_frame_order: 0
2024-01-31 16:03:53,376:INFO:   <<< use_mil: False
2024-01-31 16:03:53,376:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:03:53,376:INFO:   <<< video_dim: 1024
2024-01-31 16:03:53,376:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:03:53,376:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:03:53,376:INFO:   <<< world_size: 1
2024-01-31 16:03:53,376:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:03:53,882:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:03:53,882:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:03:53,883:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:03:53,883:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:03:53,883:WARNING: Test retrieval by loose type.
2024-01-31 16:03:53,883:WARNING: 	 embed_dim: 512
2024-01-31 16:03:53,883:WARNING: 	 image_resolution: 224
2024-01-31 16:03:53,883:WARNING: 	 vision_layers: 12
2024-01-31 16:03:53,883:WARNING: 	 vision_width: 768
2024-01-31 16:03:53,883:WARNING: 	 vision_patch_size: 32
2024-01-31 16:03:53,883:WARNING: 	 context_length: 77
2024-01-31 16:03:53,883:WARNING: 	 vocab_size: 49408
2024-01-31 16:03:53,883:WARNING: 	 transformer_width: 512
2024-01-31 16:03:53,883:WARNING: 	 transformer_heads: 8
2024-01-31 16:03:53,883:WARNING: 	 transformer_layers: 12
2024-01-31 16:03:53,883:WARNING: 		 linear_patch: 2d
2024-01-31 16:03:53,883:WARNING: 	 cut_top_layer: 0
2024-01-31 16:03:54,920:WARNING: 	 sim_header: meanP
2024-01-31 16:03:57,526:INFO: --------------------
2024-01-31 16:03:57,526:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:03:59,076:INFO: ***** Running test *****
2024-01-31 16:03:59,076:INFO:   Num examples = 1334
2024-01-31 16:03:59,076:INFO:   Batch size = 16
2024-01-31 16:03:59,076:INFO:   Num steps = 667
2024-01-31 16:03:59,076:INFO: ***** Running val *****
2024-01-31 16:03:59,076:INFO:   Num examples = 1334
2024-01-31 16:03:59,078:INFO: model evaluation on 1 GPU
2024-01-31 16:04:08,724:INFO: Effective parameters:
2024-01-31 16:04:08,724:INFO:   <<< adaptive_cls: 0
2024-01-31 16:04:08,725:INFO:   <<< aggregation: None
2024-01-31 16:04:08,725:INFO:   <<< alpha: 1.0
2024-01-31 16:04:08,725:INFO:   <<< batch_size: 2
2024-01-31 16:04:08,725:INFO:   <<< batch_size_val: 16
2024-01-31 16:04:08,725:INFO:   <<< cache_dir: 
2024-01-31 16:04:08,725:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:04:08,725:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:04:08,725:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:04:08,725:INFO:   <<< cluster_embedding: 0
2024-01-31 16:04:08,725:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:04:08,725:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:04:08,725:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:04:08,725:INFO:   <<< coef_lr: 0.001
2024-01-31 16:04:08,725:INFO:   <<< cross_model: cross-base
2024-01-31 16:04:08,725:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:04:08,725:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:04:08,725:INFO:   <<< datatype: charades
2024-01-31 16:04:08,725:INFO:   <<< do_eval: True
2024-01-31 16:04:08,725:INFO:   <<< do_lower_case: False
2024-01-31 16:04:08,725:INFO:   <<< do_pretrain: False
2024-01-31 16:04:08,725:INFO:   <<< do_train: False
2024-01-31 16:04:08,725:INFO:   <<< dynamic_alpha: False
2024-01-31 16:04:08,725:INFO:   <<< epochs: 20
2024-01-31 16:04:08,725:INFO:   <<< eval_frame_order: 0
2024-01-31 16:04:08,725:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:04:08,725:INFO:   <<< feature_framerate: 1
2024-01-31 16:04:08,725:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:04:08,725:INFO:   <<< fp16: False
2024-01-31 16:04:08,725:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:04:08,725:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:04:08,725:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:04:08,725:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:04:08,726:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:04:08,726:INFO:   <<< linear_patch: 2d
2024-01-31 16:04:08,726:INFO:   <<< local_rank: 0
2024-01-31 16:04:08,726:INFO:   <<< loose_type: True
2024-01-31 16:04:08,726:INFO:   <<< loss: balanced
2024-01-31 16:04:08,726:INFO:   <<< lr: 0.0001
2024-01-31 16:04:08,726:INFO:   <<< lr_decay: 0.9
2024-01-31 16:04:08,726:INFO:   <<< margin: 0.1
2024-01-31 16:04:08,726:INFO:   <<< max_frames: 64
2024-01-31 16:04:08,726:INFO:   <<< max_words: 77
2024-01-31 16:04:08,726:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:04:08,726:INFO:   <<< n_display: 100
2024-01-31 16:04:08,726:INFO:   <<< n_gpu: 1
2024-01-31 16:04:08,726:INFO:   <<< n_pair: 1
2024-01-31 16:04:08,726:INFO:   <<< negative_weighting: 1
2024-01-31 16:04:08,726:INFO:   <<< num_thread_reader: 1
2024-01-31 16:04:08,726:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:04:08,726:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:04:08,726:INFO:   <<< post_process: cluster
2024-01-31 16:04:08,726:INFO:   <<< pre_norm: 0
2024-01-31 16:04:08,726:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:04:08,726:INFO:   <<< rank: 0
2024-01-31 16:04:08,726:INFO:   <<< resume_model: None
2024-01-31 16:04:08,726:INFO:   <<< sampled_use_mil: False
2024-01-31 16:04:08,726:INFO:   <<< save_feature_path: None
2024-01-31 16:04:08,726:INFO:   <<< seed: 42
2024-01-31 16:04:08,726:INFO:   <<< sim_header: meanP
2024-01-31 16:04:08,726:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:04:08,726:INFO:   <<< slice_framepos: 2
2024-01-31 16:04:08,726:INFO:   <<< task_type: retrieval
2024-01-31 16:04:08,726:INFO:   <<< temperature_new: 1.0
2024-01-31 16:04:08,726:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:04:08,726:INFO:   <<< time_embedding: 0
2024-01-31 16:04:08,726:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:04:08,726:INFO:   <<< train_frame_order: 0
2024-01-31 16:04:08,726:INFO:   <<< use_mil: False
2024-01-31 16:04:08,726:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:04:08,727:INFO:   <<< video_dim: 1024
2024-01-31 16:04:08,727:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:04:08,727:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:04:08,727:INFO:   <<< world_size: 1
2024-01-31 16:04:08,727:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:04:09,225:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:04:09,225:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:04:09,225:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:04:09,226:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:04:09,226:WARNING: Test retrieval by loose type.
2024-01-31 16:04:09,226:WARNING: 	 embed_dim: 512
2024-01-31 16:04:09,226:WARNING: 	 image_resolution: 224
2024-01-31 16:04:09,226:WARNING: 	 vision_layers: 12
2024-01-31 16:04:09,226:WARNING: 	 vision_width: 768
2024-01-31 16:04:09,226:WARNING: 	 vision_patch_size: 32
2024-01-31 16:04:09,226:WARNING: 	 context_length: 77
2024-01-31 16:04:09,226:WARNING: 	 vocab_size: 49408
2024-01-31 16:04:09,226:WARNING: 	 transformer_width: 512
2024-01-31 16:04:09,226:WARNING: 	 transformer_heads: 8
2024-01-31 16:04:09,226:WARNING: 	 transformer_layers: 12
2024-01-31 16:04:09,226:WARNING: 		 linear_patch: 2d
2024-01-31 16:04:09,226:WARNING: 	 cut_top_layer: 0
2024-01-31 16:04:10,246:WARNING: 	 sim_header: meanP
2024-01-31 16:04:12,797:INFO: --------------------
2024-01-31 16:04:12,797:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:04:14,331:INFO: ***** Running test *****
2024-01-31 16:04:14,331:INFO:   Num examples = 1334
2024-01-31 16:04:14,331:INFO:   Batch size = 16
2024-01-31 16:04:14,331:INFO:   Num steps = 667
2024-01-31 16:04:14,331:INFO: ***** Running val *****
2024-01-31 16:04:14,331:INFO:   Num examples = 1334
2024-01-31 16:04:14,333:INFO: model evaluation on 1 GPU
2024-01-31 16:05:27,814:INFO: Effective parameters:
2024-01-31 16:05:27,814:INFO:   <<< adaptive_cls: 0
2024-01-31 16:05:27,814:INFO:   <<< aggregation: None
2024-01-31 16:05:27,814:INFO:   <<< alpha: 1.0
2024-01-31 16:05:27,814:INFO:   <<< batch_size: 2
2024-01-31 16:05:27,814:INFO:   <<< batch_size_val: 16
2024-01-31 16:05:27,814:INFO:   <<< cache_dir: 
2024-01-31 16:05:27,814:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:05:27,814:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:05:27,814:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:05:27,814:INFO:   <<< cluster_embedding: 0
2024-01-31 16:05:27,814:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:05:27,814:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:05:27,814:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:05:27,814:INFO:   <<< coef_lr: 0.001
2024-01-31 16:05:27,814:INFO:   <<< cross_model: cross-base
2024-01-31 16:05:27,814:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:05:27,814:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:05:27,814:INFO:   <<< datatype: charades
2024-01-31 16:05:27,814:INFO:   <<< do_eval: True
2024-01-31 16:05:27,814:INFO:   <<< do_lower_case: False
2024-01-31 16:05:27,814:INFO:   <<< do_pretrain: False
2024-01-31 16:05:27,815:INFO:   <<< do_train: False
2024-01-31 16:05:27,815:INFO:   <<< dynamic_alpha: False
2024-01-31 16:05:27,815:INFO:   <<< epochs: 20
2024-01-31 16:05:27,815:INFO:   <<< eval_frame_order: 0
2024-01-31 16:05:27,815:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:05:27,815:INFO:   <<< feature_framerate: 1
2024-01-31 16:05:27,815:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:05:27,815:INFO:   <<< fp16: False
2024-01-31 16:05:27,815:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:05:27,815:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:05:27,815:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:05:27,815:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:05:27,815:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:05:27,815:INFO:   <<< linear_patch: 2d
2024-01-31 16:05:27,815:INFO:   <<< local_rank: 0
2024-01-31 16:05:27,815:INFO:   <<< loose_type: True
2024-01-31 16:05:27,815:INFO:   <<< loss: balanced
2024-01-31 16:05:27,815:INFO:   <<< lr: 0.0001
2024-01-31 16:05:27,815:INFO:   <<< lr_decay: 0.9
2024-01-31 16:05:27,815:INFO:   <<< margin: 0.1
2024-01-31 16:05:27,815:INFO:   <<< max_frames: 64
2024-01-31 16:05:27,815:INFO:   <<< max_words: 77
2024-01-31 16:05:27,815:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:05:27,815:INFO:   <<< n_display: 100
2024-01-31 16:05:27,815:INFO:   <<< n_gpu: 1
2024-01-31 16:05:27,815:INFO:   <<< n_pair: 1
2024-01-31 16:05:27,815:INFO:   <<< negative_weighting: 1
2024-01-31 16:05:27,815:INFO:   <<< num_thread_reader: 1
2024-01-31 16:05:27,815:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:05:27,815:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:05:27,815:INFO:   <<< post_process: cluster
2024-01-31 16:05:27,815:INFO:   <<< pre_norm: 0
2024-01-31 16:05:27,815:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:05:27,815:INFO:   <<< rank: 0
2024-01-31 16:05:27,815:INFO:   <<< resume_model: None
2024-01-31 16:05:27,815:INFO:   <<< sampled_use_mil: False
2024-01-31 16:05:27,816:INFO:   <<< save_feature_path: None
2024-01-31 16:05:27,816:INFO:   <<< seed: 42
2024-01-31 16:05:27,816:INFO:   <<< sim_header: meanP
2024-01-31 16:05:27,816:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:05:27,816:INFO:   <<< slice_framepos: 2
2024-01-31 16:05:27,816:INFO:   <<< task_type: retrieval
2024-01-31 16:05:27,816:INFO:   <<< temperature_new: 1.0
2024-01-31 16:05:27,816:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:05:27,816:INFO:   <<< time_embedding: 0
2024-01-31 16:05:27,816:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:05:27,816:INFO:   <<< train_frame_order: 0
2024-01-31 16:05:27,816:INFO:   <<< use_mil: False
2024-01-31 16:05:27,816:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:05:27,816:INFO:   <<< video_dim: 1024
2024-01-31 16:05:27,816:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:05:27,816:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:05:27,816:INFO:   <<< world_size: 1
2024-01-31 16:05:27,816:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:05:28,323:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:05:28,323:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:05:28,325:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:05:28,325:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:05:28,325:WARNING: Test retrieval by loose type.
2024-01-31 16:05:28,325:WARNING: 	 embed_dim: 512
2024-01-31 16:05:28,325:WARNING: 	 image_resolution: 224
2024-01-31 16:05:28,325:WARNING: 	 vision_layers: 12
2024-01-31 16:05:28,325:WARNING: 	 vision_width: 768
2024-01-31 16:05:28,325:WARNING: 	 vision_patch_size: 32
2024-01-31 16:05:28,325:WARNING: 	 context_length: 77
2024-01-31 16:05:28,325:WARNING: 	 vocab_size: 49408
2024-01-31 16:05:28,325:WARNING: 	 transformer_width: 512
2024-01-31 16:05:28,325:WARNING: 	 transformer_heads: 8
2024-01-31 16:05:28,325:WARNING: 	 transformer_layers: 12
2024-01-31 16:05:28,325:WARNING: 		 linear_patch: 2d
2024-01-31 16:05:28,325:WARNING: 	 cut_top_layer: 0
2024-01-31 16:05:29,372:WARNING: 	 sim_header: meanP
2024-01-31 16:05:31,986:INFO: --------------------
2024-01-31 16:05:31,986:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:05:33,567:INFO: ***** Running test *****
2024-01-31 16:05:33,567:INFO:   Num examples = 1334
2024-01-31 16:05:33,567:INFO:   Batch size = 16
2024-01-31 16:05:33,567:INFO:   Num steps = 667
2024-01-31 16:05:33,568:INFO: ***** Running val *****
2024-01-31 16:05:33,568:INFO:   Num examples = 1334
2024-01-31 16:05:33,569:INFO: model evaluation on 1 GPU
2024-01-31 16:07:21,870:INFO: Effective parameters:
2024-01-31 16:07:21,870:INFO:   <<< adaptive_cls: 0
2024-01-31 16:07:21,870:INFO:   <<< aggregation: None
2024-01-31 16:07:21,870:INFO:   <<< alpha: 1.0
2024-01-31 16:07:21,870:INFO:   <<< batch_size: 2
2024-01-31 16:07:21,870:INFO:   <<< batch_size_val: 16
2024-01-31 16:07:21,870:INFO:   <<< cache_dir: 
2024-01-31 16:07:21,870:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:07:21,870:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:07:21,870:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:07:21,870:INFO:   <<< cluster_embedding: 0
2024-01-31 16:07:21,870:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:07:21,870:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:07:21,870:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:07:21,870:INFO:   <<< coef_lr: 0.001
2024-01-31 16:07:21,870:INFO:   <<< cross_model: cross-base
2024-01-31 16:07:21,870:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:07:21,870:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:07:21,870:INFO:   <<< datatype: charades
2024-01-31 16:07:21,870:INFO:   <<< do_eval: True
2024-01-31 16:07:21,871:INFO:   <<< do_lower_case: False
2024-01-31 16:07:21,871:INFO:   <<< do_pretrain: False
2024-01-31 16:07:21,871:INFO:   <<< do_train: False
2024-01-31 16:07:21,871:INFO:   <<< dynamic_alpha: False
2024-01-31 16:07:21,871:INFO:   <<< epochs: 20
2024-01-31 16:07:21,871:INFO:   <<< eval_frame_order: 0
2024-01-31 16:07:21,871:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:07:21,871:INFO:   <<< feature_framerate: 1
2024-01-31 16:07:21,871:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:07:21,871:INFO:   <<< fp16: False
2024-01-31 16:07:21,871:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:07:21,871:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:07:21,871:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:07:21,871:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:07:21,871:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:07:21,871:INFO:   <<< linear_patch: 2d
2024-01-31 16:07:21,871:INFO:   <<< local_rank: 0
2024-01-31 16:07:21,871:INFO:   <<< loose_type: True
2024-01-31 16:07:21,871:INFO:   <<< loss: balanced
2024-01-31 16:07:21,871:INFO:   <<< lr: 0.0001
2024-01-31 16:07:21,871:INFO:   <<< lr_decay: 0.9
2024-01-31 16:07:21,871:INFO:   <<< margin: 0.1
2024-01-31 16:07:21,871:INFO:   <<< max_frames: 64
2024-01-31 16:07:21,871:INFO:   <<< max_words: 77
2024-01-31 16:07:21,871:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:07:21,871:INFO:   <<< n_display: 100
2024-01-31 16:07:21,871:INFO:   <<< n_gpu: 1
2024-01-31 16:07:21,871:INFO:   <<< n_pair: 1
2024-01-31 16:07:21,871:INFO:   <<< negative_weighting: 1
2024-01-31 16:07:21,871:INFO:   <<< num_thread_reader: 1
2024-01-31 16:07:21,871:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:07:21,871:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:07:21,871:INFO:   <<< post_process: cluster
2024-01-31 16:07:21,871:INFO:   <<< pre_norm: 0
2024-01-31 16:07:21,872:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:07:21,872:INFO:   <<< rank: 0
2024-01-31 16:07:21,872:INFO:   <<< resume_model: None
2024-01-31 16:07:21,872:INFO:   <<< sampled_use_mil: False
2024-01-31 16:07:21,872:INFO:   <<< save_feature_path: None
2024-01-31 16:07:21,872:INFO:   <<< seed: 42
2024-01-31 16:07:21,872:INFO:   <<< sim_header: meanP
2024-01-31 16:07:21,872:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:07:21,872:INFO:   <<< slice_framepos: 2
2024-01-31 16:07:21,872:INFO:   <<< task_type: retrieval
2024-01-31 16:07:21,872:INFO:   <<< temperature_new: 1.0
2024-01-31 16:07:21,872:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:07:21,872:INFO:   <<< time_embedding: 0
2024-01-31 16:07:21,872:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:07:21,872:INFO:   <<< train_frame_order: 0
2024-01-31 16:07:21,872:INFO:   <<< use_mil: False
2024-01-31 16:07:21,872:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:07:21,872:INFO:   <<< video_dim: 1024
2024-01-31 16:07:21,872:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:07:21,872:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:07:21,872:INFO:   <<< world_size: 1
2024-01-31 16:07:21,872:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:07:22,368:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:07:22,369:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:07:22,369:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:07:22,369:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:07:22,369:WARNING: Test retrieval by loose type.
2024-01-31 16:07:22,369:WARNING: 	 embed_dim: 512
2024-01-31 16:07:22,369:WARNING: 	 image_resolution: 224
2024-01-31 16:07:22,369:WARNING: 	 vision_layers: 12
2024-01-31 16:07:22,370:WARNING: 	 vision_width: 768
2024-01-31 16:07:22,370:WARNING: 	 vision_patch_size: 32
2024-01-31 16:07:22,370:WARNING: 	 context_length: 77
2024-01-31 16:07:22,370:WARNING: 	 vocab_size: 49408
2024-01-31 16:07:22,370:WARNING: 	 transformer_width: 512
2024-01-31 16:07:22,370:WARNING: 	 transformer_heads: 8
2024-01-31 16:07:22,370:WARNING: 	 transformer_layers: 12
2024-01-31 16:07:22,370:WARNING: 		 linear_patch: 2d
2024-01-31 16:07:22,370:WARNING: 	 cut_top_layer: 0
2024-01-31 16:07:23,381:WARNING: 	 sim_header: meanP
2024-01-31 16:07:25,933:INFO: --------------------
2024-01-31 16:07:25,933:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:07:27,442:INFO: ***** Running test *****
2024-01-31 16:07:27,442:INFO:   Num examples = 1334
2024-01-31 16:07:27,443:INFO:   Batch size = 16
2024-01-31 16:07:27,443:INFO:   Num steps = 667
2024-01-31 16:07:27,443:INFO: ***** Running val *****
2024-01-31 16:07:27,443:INFO:   Num examples = 1334
2024-01-31 16:07:27,444:INFO: model evaluation on 1 GPU
2024-01-31 16:08:12,437:INFO: Effective parameters:
2024-01-31 16:08:12,437:INFO:   <<< adaptive_cls: 0
2024-01-31 16:08:12,437:INFO:   <<< aggregation: None
2024-01-31 16:08:12,437:INFO:   <<< alpha: 1.0
2024-01-31 16:08:12,437:INFO:   <<< batch_size: 2
2024-01-31 16:08:12,437:INFO:   <<< batch_size_val: 16
2024-01-31 16:08:12,437:INFO:   <<< cache_dir: 
2024-01-31 16:08:12,437:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:08:12,437:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:08:12,437:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:08:12,437:INFO:   <<< cluster_embedding: 0
2024-01-31 16:08:12,437:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:08:12,437:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:08:12,437:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:08:12,437:INFO:   <<< coef_lr: 0.001
2024-01-31 16:08:12,437:INFO:   <<< cross_model: cross-base
2024-01-31 16:08:12,437:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:08:12,437:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:08:12,438:INFO:   <<< datatype: charades
2024-01-31 16:08:12,438:INFO:   <<< do_eval: True
2024-01-31 16:08:12,438:INFO:   <<< do_lower_case: False
2024-01-31 16:08:12,438:INFO:   <<< do_pretrain: False
2024-01-31 16:08:12,438:INFO:   <<< do_train: False
2024-01-31 16:08:12,438:INFO:   <<< dynamic_alpha: False
2024-01-31 16:08:12,438:INFO:   <<< epochs: 20
2024-01-31 16:08:12,438:INFO:   <<< eval_frame_order: 0
2024-01-31 16:08:12,438:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:08:12,438:INFO:   <<< feature_framerate: 1
2024-01-31 16:08:12,438:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:08:12,438:INFO:   <<< fp16: False
2024-01-31 16:08:12,438:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:08:12,438:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:08:12,438:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:08:12,438:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:08:12,438:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:08:12,438:INFO:   <<< linear_patch: 2d
2024-01-31 16:08:12,438:INFO:   <<< local_rank: 0
2024-01-31 16:08:12,438:INFO:   <<< loose_type: True
2024-01-31 16:08:12,438:INFO:   <<< loss: balanced
2024-01-31 16:08:12,438:INFO:   <<< lr: 0.0001
2024-01-31 16:08:12,438:INFO:   <<< lr_decay: 0.9
2024-01-31 16:08:12,438:INFO:   <<< margin: 0.1
2024-01-31 16:08:12,438:INFO:   <<< max_frames: 64
2024-01-31 16:08:12,438:INFO:   <<< max_words: 77
2024-01-31 16:08:12,438:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:08:12,438:INFO:   <<< n_display: 100
2024-01-31 16:08:12,438:INFO:   <<< n_gpu: 1
2024-01-31 16:08:12,438:INFO:   <<< n_pair: 1
2024-01-31 16:08:12,438:INFO:   <<< negative_weighting: 1
2024-01-31 16:08:12,438:INFO:   <<< num_thread_reader: 1
2024-01-31 16:08:12,438:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:08:12,438:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:08:12,438:INFO:   <<< post_process: cluster
2024-01-31 16:08:12,438:INFO:   <<< pre_norm: 0
2024-01-31 16:08:12,438:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:08:12,438:INFO:   <<< rank: 0
2024-01-31 16:08:12,438:INFO:   <<< resume_model: None
2024-01-31 16:08:12,439:INFO:   <<< sampled_use_mil: False
2024-01-31 16:08:12,439:INFO:   <<< save_feature_path: None
2024-01-31 16:08:12,439:INFO:   <<< seed: 42
2024-01-31 16:08:12,439:INFO:   <<< sim_header: meanP
2024-01-31 16:08:12,439:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:08:12,439:INFO:   <<< slice_framepos: 2
2024-01-31 16:08:12,439:INFO:   <<< task_type: retrieval
2024-01-31 16:08:12,439:INFO:   <<< temperature_new: 1.0
2024-01-31 16:08:12,439:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:08:12,439:INFO:   <<< time_embedding: 0
2024-01-31 16:08:12,439:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:08:12,439:INFO:   <<< train_frame_order: 0
2024-01-31 16:08:12,439:INFO:   <<< use_mil: False
2024-01-31 16:08:12,439:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:08:12,439:INFO:   <<< video_dim: 1024
2024-01-31 16:08:12,439:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:08:12,439:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:08:12,439:INFO:   <<< world_size: 1
2024-01-31 16:08:12,439:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:08:12,931:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:08:12,931:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:08:12,932:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:08:12,932:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:08:12,932:WARNING: Test retrieval by loose type.
2024-01-31 16:08:12,932:WARNING: 	 embed_dim: 512
2024-01-31 16:08:12,932:WARNING: 	 image_resolution: 224
2024-01-31 16:08:12,932:WARNING: 	 vision_layers: 12
2024-01-31 16:08:12,932:WARNING: 	 vision_width: 768
2024-01-31 16:08:12,932:WARNING: 	 vision_patch_size: 32
2024-01-31 16:08:12,932:WARNING: 	 context_length: 77
2024-01-31 16:08:12,932:WARNING: 	 vocab_size: 49408
2024-01-31 16:08:12,932:WARNING: 	 transformer_width: 512
2024-01-31 16:08:12,932:WARNING: 	 transformer_heads: 8
2024-01-31 16:08:12,932:WARNING: 	 transformer_layers: 12
2024-01-31 16:08:12,932:WARNING: 		 linear_patch: 2d
2024-01-31 16:08:12,932:WARNING: 	 cut_top_layer: 0
2024-01-31 16:08:13,947:WARNING: 	 sim_header: meanP
2024-01-31 16:08:16,507:INFO: --------------------
2024-01-31 16:08:16,507:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:08:18,029:INFO: ***** Running test *****
2024-01-31 16:08:18,029:INFO:   Num examples = 1334
2024-01-31 16:08:18,031:INFO:   Batch size = 16
2024-01-31 16:08:18,031:INFO:   Num steps = 667
2024-01-31 16:08:18,031:INFO: ***** Running val *****
2024-01-31 16:08:18,031:INFO:   Num examples = 1334
2024-01-31 16:08:18,032:INFO: model evaluation on 1 GPU
2024-01-31 16:08:49,072:INFO: Effective parameters:
2024-01-31 16:08:49,072:INFO:   <<< adaptive_cls: 0
2024-01-31 16:08:49,072:INFO:   <<< aggregation: None
2024-01-31 16:08:49,072:INFO:   <<< alpha: 1.0
2024-01-31 16:08:49,072:INFO:   <<< batch_size: 2
2024-01-31 16:08:49,072:INFO:   <<< batch_size_val: 16
2024-01-31 16:08:49,072:INFO:   <<< cache_dir: 
2024-01-31 16:08:49,072:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:08:49,072:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:08:49,072:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:08:49,073:INFO:   <<< cluster_embedding: 0
2024-01-31 16:08:49,073:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:08:49,073:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:08:49,073:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:08:49,073:INFO:   <<< coef_lr: 0.001
2024-01-31 16:08:49,073:INFO:   <<< cross_model: cross-base
2024-01-31 16:08:49,073:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:08:49,073:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:08:49,073:INFO:   <<< datatype: charades
2024-01-31 16:08:49,073:INFO:   <<< do_eval: True
2024-01-31 16:08:49,073:INFO:   <<< do_lower_case: False
2024-01-31 16:08:49,073:INFO:   <<< do_pretrain: False
2024-01-31 16:08:49,073:INFO:   <<< do_train: False
2024-01-31 16:08:49,073:INFO:   <<< dynamic_alpha: False
2024-01-31 16:08:49,073:INFO:   <<< epochs: 20
2024-01-31 16:08:49,073:INFO:   <<< eval_frame_order: 0
2024-01-31 16:08:49,073:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:08:49,073:INFO:   <<< feature_framerate: 1
2024-01-31 16:08:49,073:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:08:49,073:INFO:   <<< fp16: False
2024-01-31 16:08:49,073:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:08:49,073:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:08:49,073:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:08:49,073:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:08:49,073:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:08:49,073:INFO:   <<< linear_patch: 2d
2024-01-31 16:08:49,073:INFO:   <<< local_rank: 0
2024-01-31 16:08:49,073:INFO:   <<< loose_type: True
2024-01-31 16:08:49,074:INFO:   <<< loss: balanced
2024-01-31 16:08:49,074:INFO:   <<< lr: 0.0001
2024-01-31 16:08:49,074:INFO:   <<< lr_decay: 0.9
2024-01-31 16:08:49,074:INFO:   <<< margin: 0.1
2024-01-31 16:08:49,074:INFO:   <<< max_frames: 64
2024-01-31 16:08:49,074:INFO:   <<< max_words: 77
2024-01-31 16:08:49,074:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:08:49,074:INFO:   <<< n_display: 100
2024-01-31 16:08:49,074:INFO:   <<< n_gpu: 1
2024-01-31 16:08:49,074:INFO:   <<< n_pair: 1
2024-01-31 16:08:49,074:INFO:   <<< negative_weighting: 1
2024-01-31 16:08:49,074:INFO:   <<< num_thread_reader: 1
2024-01-31 16:08:49,074:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:08:49,074:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:08:49,074:INFO:   <<< post_process: cluster
2024-01-31 16:08:49,074:INFO:   <<< pre_norm: 0
2024-01-31 16:08:49,074:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:08:49,074:INFO:   <<< rank: 0
2024-01-31 16:08:49,074:INFO:   <<< resume_model: None
2024-01-31 16:08:49,074:INFO:   <<< sampled_use_mil: False
2024-01-31 16:08:49,074:INFO:   <<< save_feature_path: None
2024-01-31 16:08:49,074:INFO:   <<< seed: 42
2024-01-31 16:08:49,074:INFO:   <<< sim_header: meanP
2024-01-31 16:08:49,074:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:08:49,074:INFO:   <<< slice_framepos: 2
2024-01-31 16:08:49,074:INFO:   <<< task_type: retrieval
2024-01-31 16:08:49,074:INFO:   <<< temperature_new: 1.0
2024-01-31 16:08:49,074:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:08:49,074:INFO:   <<< time_embedding: 0
2024-01-31 16:08:49,074:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:08:49,074:INFO:   <<< train_frame_order: 0
2024-01-31 16:08:49,074:INFO:   <<< use_mil: False
2024-01-31 16:08:49,074:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:08:49,074:INFO:   <<< video_dim: 1024
2024-01-31 16:08:49,074:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:08:49,075:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:08:49,075:INFO:   <<< world_size: 1
2024-01-31 16:08:49,075:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:08:49,573:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:08:49,573:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:08:49,573:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:08:49,573:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:08:49,574:WARNING: Test retrieval by loose type.
2024-01-31 16:08:49,574:WARNING: 	 embed_dim: 512
2024-01-31 16:08:49,574:WARNING: 	 image_resolution: 224
2024-01-31 16:08:49,574:WARNING: 	 vision_layers: 12
2024-01-31 16:08:49,574:WARNING: 	 vision_width: 768
2024-01-31 16:08:49,574:WARNING: 	 vision_patch_size: 32
2024-01-31 16:08:49,574:WARNING: 	 context_length: 77
2024-01-31 16:08:49,574:WARNING: 	 vocab_size: 49408
2024-01-31 16:08:49,574:WARNING: 	 transformer_width: 512
2024-01-31 16:08:49,574:WARNING: 	 transformer_heads: 8
2024-01-31 16:08:49,574:WARNING: 	 transformer_layers: 12
2024-01-31 16:08:49,574:WARNING: 		 linear_patch: 2d
2024-01-31 16:08:49,574:WARNING: 	 cut_top_layer: 0
2024-01-31 16:08:50,589:WARNING: 	 sim_header: meanP
2024-01-31 16:08:53,151:INFO: --------------------
2024-01-31 16:08:53,151:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:08:54,695:INFO: ***** Running test *****
2024-01-31 16:08:54,695:INFO:   Num examples = 1334
2024-01-31 16:08:54,695:INFO:   Batch size = 16
2024-01-31 16:08:54,695:INFO:   Num steps = 667
2024-01-31 16:08:54,696:INFO: ***** Running val *****
2024-01-31 16:08:54,696:INFO:   Num examples = 1334
2024-01-31 16:08:54,697:INFO: model evaluation on 1 GPU
2024-01-31 16:16:32,440:INFO: Effective parameters:
2024-01-31 16:16:32,440:INFO:   <<< adaptive_cls: 0
2024-01-31 16:16:32,440:INFO:   <<< aggregation: None
2024-01-31 16:16:32,440:INFO:   <<< alpha: 1.0
2024-01-31 16:16:32,440:INFO:   <<< batch_size: 2
2024-01-31 16:16:32,440:INFO:   <<< batch_size_val: 16
2024-01-31 16:16:32,440:INFO:   <<< cache_dir: 
2024-01-31 16:16:32,440:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:16:32,440:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:16:32,441:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:16:32,441:INFO:   <<< cluster_embedding: 0
2024-01-31 16:16:32,441:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:16:32,441:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:16:32,441:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:16:32,441:INFO:   <<< coef_lr: 0.001
2024-01-31 16:16:32,441:INFO:   <<< cross_model: cross-base
2024-01-31 16:16:32,441:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:16:32,441:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:16:32,441:INFO:   <<< datatype: charades
2024-01-31 16:16:32,441:INFO:   <<< do_eval: True
2024-01-31 16:16:32,441:INFO:   <<< do_lower_case: False
2024-01-31 16:16:32,441:INFO:   <<< do_pretrain: False
2024-01-31 16:16:32,441:INFO:   <<< do_train: False
2024-01-31 16:16:32,441:INFO:   <<< dynamic_alpha: False
2024-01-31 16:16:32,441:INFO:   <<< epochs: 20
2024-01-31 16:16:32,441:INFO:   <<< eval_frame_order: 0
2024-01-31 16:16:32,441:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:16:32,441:INFO:   <<< feature_framerate: 1
2024-01-31 16:16:32,441:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:16:32,441:INFO:   <<< fp16: False
2024-01-31 16:16:32,441:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:16:32,441:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:16:32,441:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:16:32,441:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:16:32,441:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:16:32,441:INFO:   <<< linear_patch: 2d
2024-01-31 16:16:32,441:INFO:   <<< local_rank: 0
2024-01-31 16:16:32,441:INFO:   <<< loose_type: True
2024-01-31 16:16:32,441:INFO:   <<< loss: balanced
2024-01-31 16:16:32,441:INFO:   <<< lr: 0.0001
2024-01-31 16:16:32,441:INFO:   <<< lr_decay: 0.9
2024-01-31 16:16:32,441:INFO:   <<< margin: 0.1
2024-01-31 16:16:32,441:INFO:   <<< max_frames: 64
2024-01-31 16:16:32,442:INFO:   <<< max_words: 77
2024-01-31 16:16:32,442:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:16:32,442:INFO:   <<< n_display: 100
2024-01-31 16:16:32,442:INFO:   <<< n_gpu: 1
2024-01-31 16:16:32,442:INFO:   <<< n_pair: 1
2024-01-31 16:16:32,442:INFO:   <<< negative_weighting: 1
2024-01-31 16:16:32,442:INFO:   <<< num_thread_reader: 1
2024-01-31 16:16:32,442:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:16:32,442:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:16:32,442:INFO:   <<< post_process: cluster
2024-01-31 16:16:32,442:INFO:   <<< pre_norm: 0
2024-01-31 16:16:32,442:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:16:32,442:INFO:   <<< rank: 0
2024-01-31 16:16:32,442:INFO:   <<< resume_model: None
2024-01-31 16:16:32,442:INFO:   <<< sampled_use_mil: False
2024-01-31 16:16:32,442:INFO:   <<< save_feature_path: None
2024-01-31 16:16:32,442:INFO:   <<< seed: 42
2024-01-31 16:16:32,442:INFO:   <<< sim_header: meanP
2024-01-31 16:16:32,442:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:16:32,442:INFO:   <<< slice_framepos: 2
2024-01-31 16:16:32,442:INFO:   <<< task_type: retrieval
2024-01-31 16:16:32,442:INFO:   <<< temperature_new: 1.0
2024-01-31 16:16:32,442:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:16:32,442:INFO:   <<< time_embedding: 0
2024-01-31 16:16:32,442:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:16:32,442:INFO:   <<< train_frame_order: 0
2024-01-31 16:16:32,442:INFO:   <<< use_mil: False
2024-01-31 16:16:32,442:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:16:32,442:INFO:   <<< video_dim: 1024
2024-01-31 16:16:32,442:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:16:32,442:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:16:32,442:INFO:   <<< world_size: 1
2024-01-31 16:16:32,442:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:16:32,945:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:16:32,945:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:16:32,945:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:16:32,945:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:16:32,946:WARNING: Test retrieval by loose type.
2024-01-31 16:16:32,946:WARNING: 	 embed_dim: 512
2024-01-31 16:16:32,946:WARNING: 	 image_resolution: 224
2024-01-31 16:16:32,946:WARNING: 	 vision_layers: 12
2024-01-31 16:16:32,946:WARNING: 	 vision_width: 768
2024-01-31 16:16:32,946:WARNING: 	 vision_patch_size: 32
2024-01-31 16:16:32,946:WARNING: 	 context_length: 77
2024-01-31 16:16:32,946:WARNING: 	 vocab_size: 49408
2024-01-31 16:16:32,946:WARNING: 	 transformer_width: 512
2024-01-31 16:16:32,946:WARNING: 	 transformer_heads: 8
2024-01-31 16:16:32,946:WARNING: 	 transformer_layers: 12
2024-01-31 16:16:32,946:WARNING: 		 linear_patch: 2d
2024-01-31 16:16:32,946:WARNING: 	 cut_top_layer: 0
2024-01-31 16:16:33,982:WARNING: 	 sim_header: meanP
2024-01-31 16:16:36,566:INFO: --------------------
2024-01-31 16:16:36,566:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:16:38,088:INFO: ***** Running test *****
2024-01-31 16:16:38,089:INFO:   Num examples = 1334
2024-01-31 16:16:38,089:INFO:   Batch size = 16
2024-01-31 16:16:38,089:INFO:   Num steps = 667
2024-01-31 16:16:38,089:INFO: ***** Running val *****
2024-01-31 16:16:38,089:INFO:   Num examples = 1334
2024-01-31 16:16:38,090:INFO: model evaluation on 1 GPU
2024-01-31 16:17:31,190:INFO: Effective parameters:
2024-01-31 16:17:31,190:INFO:   <<< adaptive_cls: 0
2024-01-31 16:17:31,190:INFO:   <<< aggregation: None
2024-01-31 16:17:31,190:INFO:   <<< alpha: 1.0
2024-01-31 16:17:31,190:INFO:   <<< batch_size: 2
2024-01-31 16:17:31,190:INFO:   <<< batch_size_val: 16
2024-01-31 16:17:31,190:INFO:   <<< cache_dir: 
2024-01-31 16:17:31,190:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:17:31,190:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:17:31,190:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:17:31,190:INFO:   <<< cluster_embedding: 0
2024-01-31 16:17:31,190:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:17:31,190:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:17:31,190:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:17:31,190:INFO:   <<< coef_lr: 0.001
2024-01-31 16:17:31,191:INFO:   <<< cross_model: cross-base
2024-01-31 16:17:31,191:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:17:31,191:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:17:31,191:INFO:   <<< datatype: charades
2024-01-31 16:17:31,191:INFO:   <<< do_eval: True
2024-01-31 16:17:31,191:INFO:   <<< do_lower_case: False
2024-01-31 16:17:31,191:INFO:   <<< do_pretrain: False
2024-01-31 16:17:31,191:INFO:   <<< do_train: False
2024-01-31 16:17:31,191:INFO:   <<< dynamic_alpha: False
2024-01-31 16:17:31,191:INFO:   <<< epochs: 20
2024-01-31 16:17:31,191:INFO:   <<< eval_frame_order: 0
2024-01-31 16:17:31,191:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:17:31,191:INFO:   <<< feature_framerate: 1
2024-01-31 16:17:31,191:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:17:31,191:INFO:   <<< fp16: False
2024-01-31 16:17:31,191:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:17:31,191:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:17:31,191:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:17:31,191:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:17:31,191:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:17:31,191:INFO:   <<< linear_patch: 2d
2024-01-31 16:17:31,191:INFO:   <<< local_rank: 0
2024-01-31 16:17:31,191:INFO:   <<< loose_type: True
2024-01-31 16:17:31,191:INFO:   <<< loss: balanced
2024-01-31 16:17:31,191:INFO:   <<< lr: 0.0001
2024-01-31 16:17:31,191:INFO:   <<< lr_decay: 0.9
2024-01-31 16:17:31,191:INFO:   <<< margin: 0.1
2024-01-31 16:17:31,191:INFO:   <<< max_frames: 64
2024-01-31 16:17:31,191:INFO:   <<< max_words: 77
2024-01-31 16:17:31,191:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:17:31,191:INFO:   <<< n_display: 100
2024-01-31 16:17:31,191:INFO:   <<< n_gpu: 1
2024-01-31 16:17:31,191:INFO:   <<< n_pair: 1
2024-01-31 16:17:31,191:INFO:   <<< negative_weighting: 1
2024-01-31 16:17:31,192:INFO:   <<< num_thread_reader: 1
2024-01-31 16:17:31,192:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:17:31,192:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:17:31,192:INFO:   <<< post_process: cluster
2024-01-31 16:17:31,192:INFO:   <<< pre_norm: 0
2024-01-31 16:17:31,192:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:17:31,192:INFO:   <<< rank: 0
2024-01-31 16:17:31,192:INFO:   <<< resume_model: None
2024-01-31 16:17:31,192:INFO:   <<< sampled_use_mil: False
2024-01-31 16:17:31,192:INFO:   <<< save_feature_path: None
2024-01-31 16:17:31,192:INFO:   <<< seed: 42
2024-01-31 16:17:31,192:INFO:   <<< sim_header: meanP
2024-01-31 16:17:31,192:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:17:31,192:INFO:   <<< slice_framepos: 2
2024-01-31 16:17:31,192:INFO:   <<< task_type: retrieval
2024-01-31 16:17:31,192:INFO:   <<< temperature_new: 1.0
2024-01-31 16:17:31,192:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:17:31,192:INFO:   <<< time_embedding: 0
2024-01-31 16:17:31,192:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:17:31,192:INFO:   <<< train_frame_order: 0
2024-01-31 16:17:31,192:INFO:   <<< use_mil: False
2024-01-31 16:17:31,192:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:17:31,192:INFO:   <<< video_dim: 1024
2024-01-31 16:17:31,192:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:17:31,192:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:17:31,192:INFO:   <<< world_size: 1
2024-01-31 16:17:31,192:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:17:31,686:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:17:31,686:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:17:31,687:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:17:31,687:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:17:31,687:WARNING: Test retrieval by loose type.
2024-01-31 16:17:31,687:WARNING: 	 embed_dim: 512
2024-01-31 16:17:31,687:WARNING: 	 image_resolution: 224
2024-01-31 16:17:31,687:WARNING: 	 vision_layers: 12
2024-01-31 16:17:31,687:WARNING: 	 vision_width: 768
2024-01-31 16:17:31,687:WARNING: 	 vision_patch_size: 32
2024-01-31 16:17:31,687:WARNING: 	 context_length: 77
2024-01-31 16:17:31,687:WARNING: 	 vocab_size: 49408
2024-01-31 16:17:31,687:WARNING: 	 transformer_width: 512
2024-01-31 16:17:31,687:WARNING: 	 transformer_heads: 8
2024-01-31 16:17:31,687:WARNING: 	 transformer_layers: 12
2024-01-31 16:17:31,687:WARNING: 		 linear_patch: 2d
2024-01-31 16:17:31,687:WARNING: 	 cut_top_layer: 0
2024-01-31 16:17:32,707:WARNING: 	 sim_header: meanP
2024-01-31 16:17:35,313:INFO: --------------------
2024-01-31 16:17:35,313:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:17:36,882:INFO: ***** Running test *****
2024-01-31 16:17:36,882:INFO:   Num examples = 1334
2024-01-31 16:17:36,882:INFO:   Batch size = 16
2024-01-31 16:17:36,882:INFO:   Num steps = 667
2024-01-31 16:17:36,882:INFO: ***** Running val *****
2024-01-31 16:17:36,882:INFO:   Num examples = 1334
2024-01-31 16:17:36,883:INFO: model evaluation on 1 GPU
2024-01-31 16:21:28,346:INFO: Effective parameters:
2024-01-31 16:21:28,346:INFO:   <<< adaptive_cls: 0
2024-01-31 16:21:28,346:INFO:   <<< aggregation: None
2024-01-31 16:21:28,346:INFO:   <<< alpha: 1.0
2024-01-31 16:21:28,346:INFO:   <<< batch_size: 2
2024-01-31 16:21:28,346:INFO:   <<< batch_size_val: 16
2024-01-31 16:21:28,346:INFO:   <<< cache_dir: 
2024-01-31 16:21:28,346:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:21:28,346:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:21:28,346:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:21:28,346:INFO:   <<< cluster_embedding: 0
2024-01-31 16:21:28,346:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:21:28,346:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:21:28,346:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:21:28,346:INFO:   <<< coef_lr: 0.001
2024-01-31 16:21:28,346:INFO:   <<< cross_model: cross-base
2024-01-31 16:21:28,346:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:21:28,347:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:21:28,347:INFO:   <<< datatype: charades
2024-01-31 16:21:28,347:INFO:   <<< do_eval: True
2024-01-31 16:21:28,347:INFO:   <<< do_lower_case: False
2024-01-31 16:21:28,347:INFO:   <<< do_pretrain: False
2024-01-31 16:21:28,347:INFO:   <<< do_train: False
2024-01-31 16:21:28,347:INFO:   <<< dynamic_alpha: False
2024-01-31 16:21:28,347:INFO:   <<< epochs: 20
2024-01-31 16:21:28,347:INFO:   <<< eval_frame_order: 0
2024-01-31 16:21:28,347:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:21:28,347:INFO:   <<< feature_framerate: 1
2024-01-31 16:21:28,347:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:21:28,347:INFO:   <<< fp16: False
2024-01-31 16:21:28,347:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:21:28,347:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:21:28,347:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:21:28,347:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:21:28,347:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:21:28,347:INFO:   <<< linear_patch: 2d
2024-01-31 16:21:28,347:INFO:   <<< local_rank: 0
2024-01-31 16:21:28,347:INFO:   <<< loose_type: True
2024-01-31 16:21:28,347:INFO:   <<< loss: balanced
2024-01-31 16:21:28,347:INFO:   <<< lr: 0.0001
2024-01-31 16:21:28,347:INFO:   <<< lr_decay: 0.9
2024-01-31 16:21:28,347:INFO:   <<< margin: 0.1
2024-01-31 16:21:28,347:INFO:   <<< max_frames: 64
2024-01-31 16:21:28,347:INFO:   <<< max_words: 77
2024-01-31 16:21:28,347:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:21:28,347:INFO:   <<< n_display: 100
2024-01-31 16:21:28,347:INFO:   <<< n_gpu: 1
2024-01-31 16:21:28,347:INFO:   <<< n_pair: 1
2024-01-31 16:21:28,347:INFO:   <<< negative_weighting: 1
2024-01-31 16:21:28,347:INFO:   <<< num_thread_reader: 1
2024-01-31 16:21:28,347:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:21:28,347:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:21:28,348:INFO:   <<< post_process: cluster
2024-01-31 16:21:28,348:INFO:   <<< pre_norm: 0
2024-01-31 16:21:28,348:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:21:28,348:INFO:   <<< rank: 0
2024-01-31 16:21:28,348:INFO:   <<< resume_model: None
2024-01-31 16:21:28,348:INFO:   <<< sampled_use_mil: False
2024-01-31 16:21:28,348:INFO:   <<< save_feature_path: None
2024-01-31 16:21:28,348:INFO:   <<< seed: 42
2024-01-31 16:21:28,348:INFO:   <<< sim_header: meanP
2024-01-31 16:21:28,348:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:21:28,348:INFO:   <<< slice_framepos: 2
2024-01-31 16:21:28,348:INFO:   <<< task_type: retrieval
2024-01-31 16:21:28,348:INFO:   <<< temperature_new: 1.0
2024-01-31 16:21:28,348:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:21:28,348:INFO:   <<< time_embedding: 0
2024-01-31 16:21:28,348:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:21:28,348:INFO:   <<< train_frame_order: 0
2024-01-31 16:21:28,348:INFO:   <<< use_mil: False
2024-01-31 16:21:28,348:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:21:28,348:INFO:   <<< video_dim: 1024
2024-01-31 16:21:28,348:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:21:28,348:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:21:28,348:INFO:   <<< world_size: 1
2024-01-31 16:21:28,348:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:21:28,849:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:21:28,849:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:21:28,849:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:21:28,850:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:21:28,850:WARNING: Test retrieval by loose type.
2024-01-31 16:21:28,850:WARNING: 	 embed_dim: 512
2024-01-31 16:21:28,850:WARNING: 	 image_resolution: 224
2024-01-31 16:21:28,850:WARNING: 	 vision_layers: 12
2024-01-31 16:21:28,850:WARNING: 	 vision_width: 768
2024-01-31 16:21:28,850:WARNING: 	 vision_patch_size: 32
2024-01-31 16:21:28,850:WARNING: 	 context_length: 77
2024-01-31 16:21:28,850:WARNING: 	 vocab_size: 49408
2024-01-31 16:21:28,850:WARNING: 	 transformer_width: 512
2024-01-31 16:21:28,850:WARNING: 	 transformer_heads: 8
2024-01-31 16:21:28,850:WARNING: 	 transformer_layers: 12
2024-01-31 16:21:28,850:WARNING: 		 linear_patch: 2d
2024-01-31 16:21:28,850:WARNING: 	 cut_top_layer: 0
2024-01-31 16:21:29,865:WARNING: 	 sim_header: meanP
2024-01-31 16:21:32,416:INFO: --------------------
2024-01-31 16:21:32,417:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:21:33,956:INFO: ***** Running test *****
2024-01-31 16:21:33,956:INFO:   Num examples = 1334
2024-01-31 16:21:33,956:INFO:   Batch size = 16
2024-01-31 16:21:33,956:INFO:   Num steps = 667
2024-01-31 16:21:33,956:INFO: ***** Running val *****
2024-01-31 16:21:33,956:INFO:   Num examples = 1334
2024-01-31 16:21:33,957:INFO: model evaluation on 1 GPU
2024-01-31 16:28:17,881:INFO: Effective parameters:
2024-01-31 16:28:17,881:INFO:   <<< adaptive_cls: 0
2024-01-31 16:28:17,881:INFO:   <<< aggregation: None
2024-01-31 16:28:17,881:INFO:   <<< alpha: 1.0
2024-01-31 16:28:17,881:INFO:   <<< batch_size: 2
2024-01-31 16:28:17,881:INFO:   <<< batch_size_val: 16
2024-01-31 16:28:17,881:INFO:   <<< cache_dir: 
2024-01-31 16:28:17,882:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:28:17,882:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:28:17,882:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:28:17,882:INFO:   <<< cluster_embedding: 0
2024-01-31 16:28:17,882:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:28:17,882:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:28:17,882:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:28:17,882:INFO:   <<< coef_lr: 0.001
2024-01-31 16:28:17,882:INFO:   <<< cross_model: cross-base
2024-01-31 16:28:17,882:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:28:17,882:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:28:17,882:INFO:   <<< datatype: charades
2024-01-31 16:28:17,882:INFO:   <<< do_eval: True
2024-01-31 16:28:17,882:INFO:   <<< do_lower_case: False
2024-01-31 16:28:17,882:INFO:   <<< do_pretrain: False
2024-01-31 16:28:17,882:INFO:   <<< do_train: False
2024-01-31 16:28:17,882:INFO:   <<< dynamic_alpha: False
2024-01-31 16:28:17,882:INFO:   <<< epochs: 20
2024-01-31 16:28:17,882:INFO:   <<< eval_frame_order: 0
2024-01-31 16:28:17,882:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:28:17,882:INFO:   <<< feature_framerate: 1
2024-01-31 16:28:17,882:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:28:17,882:INFO:   <<< fp16: False
2024-01-31 16:28:17,882:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:28:17,882:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:28:17,882:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:28:17,882:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:28:17,882:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:28:17,882:INFO:   <<< linear_patch: 2d
2024-01-31 16:28:17,882:INFO:   <<< local_rank: 0
2024-01-31 16:28:17,882:INFO:   <<< loose_type: True
2024-01-31 16:28:17,882:INFO:   <<< loss: balanced
2024-01-31 16:28:17,882:INFO:   <<< lr: 0.0001
2024-01-31 16:28:17,882:INFO:   <<< lr_decay: 0.9
2024-01-31 16:28:17,882:INFO:   <<< margin: 0.1
2024-01-31 16:28:17,883:INFO:   <<< max_frames: 64
2024-01-31 16:28:17,883:INFO:   <<< max_words: 77
2024-01-31 16:28:17,883:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:28:17,883:INFO:   <<< n_display: 100
2024-01-31 16:28:17,883:INFO:   <<< n_gpu: 1
2024-01-31 16:28:17,883:INFO:   <<< n_pair: 1
2024-01-31 16:28:17,883:INFO:   <<< negative_weighting: 1
2024-01-31 16:28:17,883:INFO:   <<< num_thread_reader: 1
2024-01-31 16:28:17,883:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:28:17,883:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:28:17,883:INFO:   <<< post_process: cluster
2024-01-31 16:28:17,883:INFO:   <<< pre_norm: 0
2024-01-31 16:28:17,883:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:28:17,883:INFO:   <<< rank: 0
2024-01-31 16:28:17,883:INFO:   <<< resume_model: None
2024-01-31 16:28:17,883:INFO:   <<< sampled_use_mil: False
2024-01-31 16:28:17,883:INFO:   <<< save_feature_path: None
2024-01-31 16:28:17,883:INFO:   <<< seed: 42
2024-01-31 16:28:17,883:INFO:   <<< sim_header: meanP
2024-01-31 16:28:17,883:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:28:17,883:INFO:   <<< slice_framepos: 2
2024-01-31 16:28:17,883:INFO:   <<< task_type: retrieval
2024-01-31 16:28:17,883:INFO:   <<< temperature_new: 1.0
2024-01-31 16:28:17,883:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:28:17,883:INFO:   <<< time_embedding: 0
2024-01-31 16:28:17,883:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:28:17,883:INFO:   <<< train_frame_order: 0
2024-01-31 16:28:17,883:INFO:   <<< use_mil: False
2024-01-31 16:28:17,883:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:28:17,883:INFO:   <<< video_dim: 1024
2024-01-31 16:28:17,883:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:28:17,883:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:28:17,883:INFO:   <<< world_size: 1
2024-01-31 16:28:17,883:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:28:18,382:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:28:18,382:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:28:18,382:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:28:18,382:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:28:18,382:WARNING: Test retrieval by loose type.
2024-01-31 16:28:18,382:WARNING: 	 embed_dim: 512
2024-01-31 16:28:18,383:WARNING: 	 image_resolution: 224
2024-01-31 16:28:18,383:WARNING: 	 vision_layers: 12
2024-01-31 16:28:18,383:WARNING: 	 vision_width: 768
2024-01-31 16:28:18,383:WARNING: 	 vision_patch_size: 32
2024-01-31 16:28:18,383:WARNING: 	 context_length: 77
2024-01-31 16:28:18,383:WARNING: 	 vocab_size: 49408
2024-01-31 16:28:18,383:WARNING: 	 transformer_width: 512
2024-01-31 16:28:18,383:WARNING: 	 transformer_heads: 8
2024-01-31 16:28:18,383:WARNING: 	 transformer_layers: 12
2024-01-31 16:28:18,383:WARNING: 		 linear_patch: 2d
2024-01-31 16:28:18,383:WARNING: 	 cut_top_layer: 0
2024-01-31 16:28:19,397:WARNING: 	 sim_header: meanP
2024-01-31 16:28:21,949:INFO: --------------------
2024-01-31 16:28:21,949:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:28:23,484:INFO: ***** Running test *****
2024-01-31 16:28:23,484:INFO:   Num examples = 1334
2024-01-31 16:28:23,484:INFO:   Batch size = 16
2024-01-31 16:28:23,484:INFO:   Num steps = 667
2024-01-31 16:28:23,484:INFO: ***** Running val *****
2024-01-31 16:28:23,484:INFO:   Num examples = 1334
2024-01-31 16:28:23,486:INFO: model evaluation on 1 GPU
2024-01-31 16:31:02,970:INFO: Effective parameters:
2024-01-31 16:31:02,971:INFO:   <<< adaptive_cls: 0
2024-01-31 16:31:02,971:INFO:   <<< aggregation: None
2024-01-31 16:31:02,971:INFO:   <<< alpha: 1.0
2024-01-31 16:31:02,971:INFO:   <<< batch_size: 2
2024-01-31 16:31:02,971:INFO:   <<< batch_size_val: 16
2024-01-31 16:31:02,971:INFO:   <<< cache_dir: 
2024-01-31 16:31:02,971:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:31:02,971:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:31:02,971:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:31:02,971:INFO:   <<< cluster_embedding: 0
2024-01-31 16:31:02,971:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:31:02,971:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:31:02,971:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:31:02,971:INFO:   <<< coef_lr: 0.001
2024-01-31 16:31:02,971:INFO:   <<< cross_model: cross-base
2024-01-31 16:31:02,971:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:31:02,971:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:31:02,971:INFO:   <<< datatype: charades
2024-01-31 16:31:02,971:INFO:   <<< do_eval: True
2024-01-31 16:31:02,971:INFO:   <<< do_lower_case: False
2024-01-31 16:31:02,971:INFO:   <<< do_pretrain: False
2024-01-31 16:31:02,971:INFO:   <<< do_train: False
2024-01-31 16:31:02,972:INFO:   <<< dynamic_alpha: False
2024-01-31 16:31:02,972:INFO:   <<< epochs: 20
2024-01-31 16:31:02,972:INFO:   <<< eval_frame_order: 0
2024-01-31 16:31:02,972:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:31:02,972:INFO:   <<< feature_framerate: 1
2024-01-31 16:31:02,972:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:31:02,972:INFO:   <<< fp16: False
2024-01-31 16:31:02,972:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:31:02,972:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:31:02,972:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:31:02,972:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:31:02,972:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:31:02,972:INFO:   <<< linear_patch: 2d
2024-01-31 16:31:02,972:INFO:   <<< local_rank: 0
2024-01-31 16:31:02,972:INFO:   <<< loose_type: True
2024-01-31 16:31:02,972:INFO:   <<< loss: balanced
2024-01-31 16:31:02,972:INFO:   <<< lr: 0.0001
2024-01-31 16:31:02,972:INFO:   <<< lr_decay: 0.9
2024-01-31 16:31:02,972:INFO:   <<< margin: 0.1
2024-01-31 16:31:02,972:INFO:   <<< max_frames: 64
2024-01-31 16:31:02,972:INFO:   <<< max_words: 77
2024-01-31 16:31:02,972:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:31:02,972:INFO:   <<< n_display: 100
2024-01-31 16:31:02,972:INFO:   <<< n_gpu: 1
2024-01-31 16:31:02,972:INFO:   <<< n_pair: 1
2024-01-31 16:31:02,972:INFO:   <<< negative_weighting: 1
2024-01-31 16:31:02,972:INFO:   <<< num_thread_reader: 1
2024-01-31 16:31:02,972:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:31:02,972:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:31:02,972:INFO:   <<< post_process: cluster
2024-01-31 16:31:02,972:INFO:   <<< pre_norm: 0
2024-01-31 16:31:02,972:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:31:02,972:INFO:   <<< rank: 0
2024-01-31 16:31:02,972:INFO:   <<< resume_model: None
2024-01-31 16:31:02,972:INFO:   <<< sampled_use_mil: False
2024-01-31 16:31:02,972:INFO:   <<< save_feature_path: None
2024-01-31 16:31:02,972:INFO:   <<< seed: 42
2024-01-31 16:31:02,973:INFO:   <<< sim_header: meanP
2024-01-31 16:31:02,973:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:31:02,973:INFO:   <<< slice_framepos: 2
2024-01-31 16:31:02,973:INFO:   <<< task_type: retrieval
2024-01-31 16:31:02,973:INFO:   <<< temperature_new: 1.0
2024-01-31 16:31:02,973:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:31:02,973:INFO:   <<< time_embedding: 0
2024-01-31 16:31:02,973:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:31:02,973:INFO:   <<< train_frame_order: 0
2024-01-31 16:31:02,973:INFO:   <<< use_mil: False
2024-01-31 16:31:02,973:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:31:02,973:INFO:   <<< video_dim: 1024
2024-01-31 16:31:02,973:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:31:02,973:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:31:02,973:INFO:   <<< world_size: 1
2024-01-31 16:31:02,973:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:31:03,472:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:31:03,472:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:31:03,472:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:31:03,472:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:31:03,472:WARNING: Test retrieval by loose type.
2024-01-31 16:31:03,472:WARNING: 	 embed_dim: 512
2024-01-31 16:31:03,472:WARNING: 	 image_resolution: 224
2024-01-31 16:31:03,472:WARNING: 	 vision_layers: 12
2024-01-31 16:31:03,472:WARNING: 	 vision_width: 768
2024-01-31 16:31:03,472:WARNING: 	 vision_patch_size: 32
2024-01-31 16:31:03,472:WARNING: 	 context_length: 77
2024-01-31 16:31:03,473:WARNING: 	 vocab_size: 49408
2024-01-31 16:31:03,473:WARNING: 	 transformer_width: 512
2024-01-31 16:31:03,473:WARNING: 	 transformer_heads: 8
2024-01-31 16:31:03,473:WARNING: 	 transformer_layers: 12
2024-01-31 16:31:03,473:WARNING: 		 linear_patch: 2d
2024-01-31 16:31:03,473:WARNING: 	 cut_top_layer: 0
2024-01-31 16:31:04,484:WARNING: 	 sim_header: meanP
2024-01-31 16:31:07,031:INFO: --------------------
2024-01-31 16:31:07,031:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:31:08,558:INFO: ***** Running test *****
2024-01-31 16:31:08,558:INFO:   Num examples = 1334
2024-01-31 16:31:08,558:INFO:   Batch size = 16
2024-01-31 16:31:08,558:INFO:   Num steps = 667
2024-01-31 16:31:08,558:INFO: ***** Running val *****
2024-01-31 16:31:08,558:INFO:   Num examples = 1334
2024-01-31 16:31:08,560:INFO: model evaluation on 1 GPU
2024-01-31 16:39:15,427:INFO: Effective parameters:
2024-01-31 16:39:15,427:INFO:   <<< adaptive_cls: 0
2024-01-31 16:39:15,427:INFO:   <<< aggregation: None
2024-01-31 16:39:15,427:INFO:   <<< alpha: 1.0
2024-01-31 16:39:15,427:INFO:   <<< batch_size: 2
2024-01-31 16:39:15,428:INFO:   <<< batch_size_val: 16
2024-01-31 16:39:15,428:INFO:   <<< cache_dir: 
2024-01-31 16:39:15,428:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:39:15,428:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:39:15,428:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:39:15,428:INFO:   <<< cluster_embedding: 0
2024-01-31 16:39:15,428:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:39:15,428:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:39:15,428:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:39:15,428:INFO:   <<< coef_lr: 0.001
2024-01-31 16:39:15,428:INFO:   <<< cross_model: cross-base
2024-01-31 16:39:15,428:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:39:15,428:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:39:15,428:INFO:   <<< datatype: charades
2024-01-31 16:39:15,428:INFO:   <<< do_eval: True
2024-01-31 16:39:15,428:INFO:   <<< do_lower_case: False
2024-01-31 16:39:15,428:INFO:   <<< do_pretrain: False
2024-01-31 16:39:15,428:INFO:   <<< do_train: False
2024-01-31 16:39:15,428:INFO:   <<< dynamic_alpha: False
2024-01-31 16:39:15,428:INFO:   <<< epochs: 20
2024-01-31 16:39:15,428:INFO:   <<< eval_frame_order: 0
2024-01-31 16:39:15,428:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:39:15,429:INFO:   <<< feature_framerate: 1
2024-01-31 16:39:15,429:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:39:15,429:INFO:   <<< fp16: False
2024-01-31 16:39:15,429:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:39:15,429:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:39:15,429:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:39:15,429:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:39:15,429:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:39:15,429:INFO:   <<< linear_patch: 2d
2024-01-31 16:39:15,429:INFO:   <<< local_rank: 0
2024-01-31 16:39:15,429:INFO:   <<< loose_type: True
2024-01-31 16:39:15,429:INFO:   <<< loss: balanced
2024-01-31 16:39:15,429:INFO:   <<< lr: 0.0001
2024-01-31 16:39:15,429:INFO:   <<< lr_decay: 0.9
2024-01-31 16:39:15,429:INFO:   <<< margin: 0.1
2024-01-31 16:39:15,429:INFO:   <<< max_frames: 64
2024-01-31 16:39:15,429:INFO:   <<< max_words: 77
2024-01-31 16:39:15,429:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:39:15,429:INFO:   <<< n_display: 100
2024-01-31 16:39:15,429:INFO:   <<< n_gpu: 1
2024-01-31 16:39:15,429:INFO:   <<< n_pair: 1
2024-01-31 16:39:15,429:INFO:   <<< negative_weighting: 1
2024-01-31 16:39:15,429:INFO:   <<< num_thread_reader: 1
2024-01-31 16:39:15,429:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:39:15,429:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:39:15,429:INFO:   <<< post_process: cluster
2024-01-31 16:39:15,429:INFO:   <<< pre_norm: 0
2024-01-31 16:39:15,429:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:39:15,429:INFO:   <<< rank: 0
2024-01-31 16:39:15,429:INFO:   <<< resume_model: None
2024-01-31 16:39:15,429:INFO:   <<< sampled_use_mil: False
2024-01-31 16:39:15,429:INFO:   <<< save_feature_path: None
2024-01-31 16:39:15,429:INFO:   <<< seed: 42
2024-01-31 16:39:15,429:INFO:   <<< sim_header: meanP
2024-01-31 16:39:15,429:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:39:15,429:INFO:   <<< slice_framepos: 2
2024-01-31 16:39:15,430:INFO:   <<< task_type: retrieval
2024-01-31 16:39:15,430:INFO:   <<< temperature_new: 1.0
2024-01-31 16:39:15,430:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:39:15,430:INFO:   <<< time_embedding: 0
2024-01-31 16:39:15,430:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:39:15,430:INFO:   <<< train_frame_order: 0
2024-01-31 16:39:15,430:INFO:   <<< use_mil: False
2024-01-31 16:39:15,430:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:39:15,430:INFO:   <<< video_dim: 1024
2024-01-31 16:39:15,430:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:39:15,430:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:39:15,430:INFO:   <<< world_size: 1
2024-01-31 16:39:15,430:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:39:15,932:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:39:15,932:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:39:15,932:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:39:15,933:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:39:15,933:WARNING: Test retrieval by loose type.
2024-01-31 16:39:15,933:WARNING: 	 embed_dim: 512
2024-01-31 16:39:15,933:WARNING: 	 image_resolution: 224
2024-01-31 16:39:15,933:WARNING: 	 vision_layers: 12
2024-01-31 16:39:15,933:WARNING: 	 vision_width: 768
2024-01-31 16:39:15,933:WARNING: 	 vision_patch_size: 32
2024-01-31 16:39:15,933:WARNING: 	 context_length: 77
2024-01-31 16:39:15,933:WARNING: 	 vocab_size: 49408
2024-01-31 16:39:15,933:WARNING: 	 transformer_width: 512
2024-01-31 16:39:15,933:WARNING: 	 transformer_heads: 8
2024-01-31 16:39:15,933:WARNING: 	 transformer_layers: 12
2024-01-31 16:39:15,933:WARNING: 		 linear_patch: 2d
2024-01-31 16:39:15,933:WARNING: 	 cut_top_layer: 0
2024-01-31 16:39:16,946:WARNING: 	 sim_header: meanP
2024-01-31 16:39:19,486:INFO: --------------------
2024-01-31 16:39:19,486:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:39:21,015:INFO: ***** Running test *****
2024-01-31 16:39:21,015:INFO:   Num examples = 1334
2024-01-31 16:39:21,015:INFO:   Batch size = 16
2024-01-31 16:39:21,015:INFO:   Num steps = 667
2024-01-31 16:39:21,015:INFO: ***** Running val *****
2024-01-31 16:39:21,015:INFO:   Num examples = 1334
2024-01-31 16:39:21,017:INFO: model evaluation on 1 GPU
2024-01-31 16:42:53,934:INFO: Effective parameters:
2024-01-31 16:42:53,934:INFO:   <<< adaptive_cls: 0
2024-01-31 16:42:53,934:INFO:   <<< aggregation: None
2024-01-31 16:42:53,934:INFO:   <<< alpha: 1.0
2024-01-31 16:42:53,934:INFO:   <<< batch_size: 2
2024-01-31 16:42:53,934:INFO:   <<< batch_size_val: 16
2024-01-31 16:42:53,934:INFO:   <<< cache_dir: 
2024-01-31 16:42:53,934:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 16:42:53,934:INFO:   <<< cluster_algo: kmediods++
2024-01-31 16:42:53,934:INFO:   <<< cluster_distance: euclidean
2024-01-31 16:42:53,934:INFO:   <<< cluster_embedding: 0
2024-01-31 16:42:53,934:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 16:42:53,934:INFO:   <<< cluster_iter_limit: 100
2024-01-31 16:42:53,934:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 16:42:53,934:INFO:   <<< coef_lr: 0.001
2024-01-31 16:42:53,934:INFO:   <<< cross_model: cross-base
2024-01-31 16:42:53,934:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 16:42:53,934:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 16:42:53,935:INFO:   <<< datatype: charades
2024-01-31 16:42:53,935:INFO:   <<< do_eval: True
2024-01-31 16:42:53,935:INFO:   <<< do_lower_case: False
2024-01-31 16:42:53,935:INFO:   <<< do_pretrain: False
2024-01-31 16:42:53,935:INFO:   <<< do_train: False
2024-01-31 16:42:53,935:INFO:   <<< dynamic_alpha: False
2024-01-31 16:42:53,935:INFO:   <<< epochs: 20
2024-01-31 16:42:53,935:INFO:   <<< eval_frame_order: 0
2024-01-31 16:42:53,935:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 16:42:53,935:INFO:   <<< feature_framerate: 1
2024-01-31 16:42:53,935:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 16:42:53,935:INFO:   <<< fp16: False
2024-01-31 16:42:53,935:INFO:   <<< fp16_opt_level: O1
2024-01-31 16:42:53,935:INFO:   <<< freeze_layer_num: 0
2024-01-31 16:42:53,935:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 16:42:53,935:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 16:42:53,935:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 16:42:53,935:INFO:   <<< linear_patch: 2d
2024-01-31 16:42:53,935:INFO:   <<< local_rank: 0
2024-01-31 16:42:53,935:INFO:   <<< loose_type: True
2024-01-31 16:42:53,935:INFO:   <<< loss: balanced
2024-01-31 16:42:53,935:INFO:   <<< lr: 0.0001
2024-01-31 16:42:53,935:INFO:   <<< lr_decay: 0.9
2024-01-31 16:42:53,935:INFO:   <<< margin: 0.1
2024-01-31 16:42:53,935:INFO:   <<< max_frames: 64
2024-01-31 16:42:53,935:INFO:   <<< max_words: 77
2024-01-31 16:42:53,935:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 16:42:53,935:INFO:   <<< n_display: 100
2024-01-31 16:42:53,935:INFO:   <<< n_gpu: 1
2024-01-31 16:42:53,935:INFO:   <<< n_pair: 1
2024-01-31 16:42:53,935:INFO:   <<< negative_weighting: 1
2024-01-31 16:42:53,935:INFO:   <<< num_thread_reader: 1
2024-01-31 16:42:53,935:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 16:42:53,935:INFO:   <<< post_cluster_centroids: 16
2024-01-31 16:42:53,935:INFO:   <<< post_process: cluster
2024-01-31 16:42:53,936:INFO:   <<< pre_norm: 0
2024-01-31 16:42:53,936:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 16:42:53,936:INFO:   <<< rank: 0
2024-01-31 16:42:53,936:INFO:   <<< resume_model: None
2024-01-31 16:42:53,936:INFO:   <<< sampled_use_mil: False
2024-01-31 16:42:53,936:INFO:   <<< save_feature_path: None
2024-01-31 16:42:53,936:INFO:   <<< seed: 42
2024-01-31 16:42:53,936:INFO:   <<< sim_header: meanP
2024-01-31 16:42:53,936:INFO:   <<< sim_lambda: 0.0
2024-01-31 16:42:53,936:INFO:   <<< slice_framepos: 2
2024-01-31 16:42:53,936:INFO:   <<< task_type: retrieval
2024-01-31 16:42:53,936:INFO:   <<< temperature_new: 1.0
2024-01-31 16:42:53,936:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 16:42:53,936:INFO:   <<< time_embedding: 0
2024-01-31 16:42:53,936:INFO:   <<< train_csv: data/.train.csv
2024-01-31 16:42:53,936:INFO:   <<< train_frame_order: 0
2024-01-31 16:42:53,936:INFO:   <<< use_mil: False
2024-01-31 16:42:53,936:INFO:   <<< val_csv: data/.val.csv
2024-01-31 16:42:53,936:INFO:   <<< video_dim: 1024
2024-01-31 16:42:53,936:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 16:42:53,936:INFO:   <<< warmup_proportion: 0.1
2024-01-31 16:42:53,936:INFO:   <<< world_size: 1
2024-01-31 16:42:53,936:INFO: device: cuda:0 n_gpu: 1
2024-01-31 16:42:54,433:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 16:42:54,434:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 16:42:54,434:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 16:42:54,434:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 16:42:54,434:WARNING: Test retrieval by loose type.
2024-01-31 16:42:54,434:WARNING: 	 embed_dim: 512
2024-01-31 16:42:54,434:WARNING: 	 image_resolution: 224
2024-01-31 16:42:54,434:WARNING: 	 vision_layers: 12
2024-01-31 16:42:54,434:WARNING: 	 vision_width: 768
2024-01-31 16:42:54,434:WARNING: 	 vision_patch_size: 32
2024-01-31 16:42:54,434:WARNING: 	 context_length: 77
2024-01-31 16:42:54,434:WARNING: 	 vocab_size: 49408
2024-01-31 16:42:54,434:WARNING: 	 transformer_width: 512
2024-01-31 16:42:54,434:WARNING: 	 transformer_heads: 8
2024-01-31 16:42:54,434:WARNING: 	 transformer_layers: 12
2024-01-31 16:42:54,434:WARNING: 		 linear_patch: 2d
2024-01-31 16:42:54,434:WARNING: 	 cut_top_layer: 0
2024-01-31 16:42:55,452:WARNING: 	 sim_header: meanP
2024-01-31 16:42:58,044:INFO: --------------------
2024-01-31 16:42:58,045:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 16:42:59,573:INFO: ***** Running test *****
2024-01-31 16:42:59,573:INFO:   Num examples = 1334
2024-01-31 16:42:59,573:INFO:   Batch size = 16
2024-01-31 16:42:59,573:INFO:   Num steps = 667
2024-01-31 16:42:59,573:INFO: ***** Running val *****
2024-01-31 16:42:59,573:INFO:   Num examples = 1334
2024-01-31 16:42:59,575:INFO: model evaluation on 1 GPU
2024-01-31 17:01:33,087:INFO: Effective parameters:
2024-01-31 17:01:33,087:INFO:   <<< adaptive_cls: 0
2024-01-31 17:01:33,089:INFO:   <<< aggregation: None
2024-01-31 17:01:33,089:INFO:   <<< alpha: 1.0
2024-01-31 17:01:33,089:INFO:   <<< batch_size: 2
2024-01-31 17:01:33,089:INFO:   <<< batch_size_val: 16
2024-01-31 17:01:33,089:INFO:   <<< cache_dir: 
2024-01-31 17:01:33,089:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:01:33,089:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:01:33,089:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:01:33,090:INFO:   <<< cluster_embedding: 0
2024-01-31 17:01:33,090:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:01:33,090:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:01:33,090:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:01:33,090:INFO:   <<< coef_lr: 0.001
2024-01-31 17:01:33,090:INFO:   <<< cross_model: cross-base
2024-01-31 17:01:33,090:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:01:33,090:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:01:33,090:INFO:   <<< datatype: charades
2024-01-31 17:01:33,090:INFO:   <<< do_eval: True
2024-01-31 17:01:33,090:INFO:   <<< do_lower_case: False
2024-01-31 17:01:33,090:INFO:   <<< do_pretrain: False
2024-01-31 17:01:33,090:INFO:   <<< do_train: False
2024-01-31 17:01:33,090:INFO:   <<< dynamic_alpha: False
2024-01-31 17:01:33,090:INFO:   <<< epochs: 20
2024-01-31 17:01:33,090:INFO:   <<< eval_frame_order: 0
2024-01-31 17:01:33,090:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:01:33,090:INFO:   <<< feature_framerate: 1
2024-01-31 17:01:33,090:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:01:33,090:INFO:   <<< fp16: False
2024-01-31 17:01:33,090:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:01:33,090:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:01:33,090:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:01:33,090:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:01:33,090:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:01:33,090:INFO:   <<< linear_patch: 2d
2024-01-31 17:01:33,090:INFO:   <<< local_rank: 0
2024-01-31 17:01:33,090:INFO:   <<< loose_type: True
2024-01-31 17:01:33,090:INFO:   <<< loss: balanced
2024-01-31 17:01:33,090:INFO:   <<< lr: 0.0001
2024-01-31 17:01:33,090:INFO:   <<< lr_decay: 0.9
2024-01-31 17:01:33,090:INFO:   <<< margin: 0.1
2024-01-31 17:01:33,090:INFO:   <<< max_frames: 64
2024-01-31 17:01:33,090:INFO:   <<< max_words: 77
2024-01-31 17:01:33,090:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:01:33,090:INFO:   <<< n_display: 100
2024-01-31 17:01:33,090:INFO:   <<< n_gpu: 1
2024-01-31 17:01:33,091:INFO:   <<< n_pair: 1
2024-01-31 17:01:33,091:INFO:   <<< negative_weighting: 1
2024-01-31 17:01:33,091:INFO:   <<< num_thread_reader: 1
2024-01-31 17:01:33,091:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:01:33,091:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:01:33,091:INFO:   <<< post_process: cluster
2024-01-31 17:01:33,091:INFO:   <<< pre_norm: 0
2024-01-31 17:01:33,091:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:01:33,091:INFO:   <<< rank: 0
2024-01-31 17:01:33,091:INFO:   <<< resume_model: None
2024-01-31 17:01:33,091:INFO:   <<< sampled_use_mil: False
2024-01-31 17:01:33,091:INFO:   <<< save_feature_path: None
2024-01-31 17:01:33,091:INFO:   <<< seed: 42
2024-01-31 17:01:33,091:INFO:   <<< sim_header: meanP
2024-01-31 17:01:33,091:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:01:33,091:INFO:   <<< slice_framepos: 2
2024-01-31 17:01:33,091:INFO:   <<< task_type: retrieval
2024-01-31 17:01:33,091:INFO:   <<< temperature_new: 1.0
2024-01-31 17:01:33,091:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:01:33,091:INFO:   <<< time_embedding: 0
2024-01-31 17:01:33,091:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:01:33,091:INFO:   <<< train_frame_order: 0
2024-01-31 17:01:33,091:INFO:   <<< use_mil: False
2024-01-31 17:01:33,091:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:01:33,091:INFO:   <<< video_dim: 1024
2024-01-31 17:01:33,091:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:01:33,091:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:01:33,091:INFO:   <<< world_size: 1
2024-01-31 17:01:33,091:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:01:33,591:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:01:33,591:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:01:33,591:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:01:33,591:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:01:33,591:WARNING: Test retrieval by loose type.
2024-01-31 17:01:33,591:WARNING: 	 embed_dim: 512
2024-01-31 17:01:33,591:WARNING: 	 image_resolution: 224
2024-01-31 17:01:33,591:WARNING: 	 vision_layers: 12
2024-01-31 17:01:33,591:WARNING: 	 vision_width: 768
2024-01-31 17:01:33,591:WARNING: 	 vision_patch_size: 32
2024-01-31 17:01:33,591:WARNING: 	 context_length: 77
2024-01-31 17:01:33,592:WARNING: 	 vocab_size: 49408
2024-01-31 17:01:33,592:WARNING: 	 transformer_width: 512
2024-01-31 17:01:33,592:WARNING: 	 transformer_heads: 8
2024-01-31 17:01:33,592:WARNING: 	 transformer_layers: 12
2024-01-31 17:01:33,592:WARNING: 		 linear_patch: 2d
2024-01-31 17:01:33,592:WARNING: 	 cut_top_layer: 0
2024-01-31 17:01:34,602:WARNING: 	 sim_header: meanP
2024-01-31 17:01:37,154:INFO: --------------------
2024-01-31 17:01:37,155:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:01:38,701:INFO: ***** Running test *****
2024-01-31 17:01:38,701:INFO:   Num examples = 1334
2024-01-31 17:01:38,701:INFO:   Batch size = 16
2024-01-31 17:01:38,701:INFO:   Num steps = 667
2024-01-31 17:01:38,701:INFO: ***** Running val *****
2024-01-31 17:01:38,701:INFO:   Num examples = 1334
2024-01-31 17:01:38,703:INFO: model evaluation on 1 GPU
2024-01-31 17:13:41,714:INFO: Effective parameters:
2024-01-31 17:13:41,714:INFO:   <<< adaptive_cls: 0
2024-01-31 17:13:41,714:INFO:   <<< aggregation: None
2024-01-31 17:13:41,714:INFO:   <<< alpha: 1.0
2024-01-31 17:13:41,714:INFO:   <<< batch_size: 2
2024-01-31 17:13:41,714:INFO:   <<< batch_size_val: 16
2024-01-31 17:13:41,714:INFO:   <<< cache_dir: 
2024-01-31 17:13:41,714:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:13:41,714:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:13:41,714:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:13:41,714:INFO:   <<< cluster_embedding: 0
2024-01-31 17:13:41,714:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:13:41,714:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:13:41,715:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:13:41,715:INFO:   <<< coef_lr: 0.001
2024-01-31 17:13:41,715:INFO:   <<< cross_model: cross-base
2024-01-31 17:13:41,715:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:13:41,715:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:13:41,715:INFO:   <<< datatype: charades
2024-01-31 17:13:41,715:INFO:   <<< do_eval: True
2024-01-31 17:13:41,715:INFO:   <<< do_lower_case: False
2024-01-31 17:13:41,715:INFO:   <<< do_pretrain: False
2024-01-31 17:13:41,715:INFO:   <<< do_train: False
2024-01-31 17:13:41,715:INFO:   <<< dynamic_alpha: False
2024-01-31 17:13:41,715:INFO:   <<< epochs: 20
2024-01-31 17:13:41,715:INFO:   <<< eval_frame_order: 0
2024-01-31 17:13:41,715:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:13:41,715:INFO:   <<< feature_framerate: 1
2024-01-31 17:13:41,715:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:13:41,715:INFO:   <<< fp16: False
2024-01-31 17:13:41,715:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:13:41,715:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:13:41,715:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:13:41,715:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:13:41,715:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:13:41,715:INFO:   <<< linear_patch: 2d
2024-01-31 17:13:41,715:INFO:   <<< local_rank: 0
2024-01-31 17:13:41,715:INFO:   <<< loose_type: True
2024-01-31 17:13:41,715:INFO:   <<< loss: balanced
2024-01-31 17:13:41,715:INFO:   <<< lr: 0.0001
2024-01-31 17:13:41,715:INFO:   <<< lr_decay: 0.9
2024-01-31 17:13:41,715:INFO:   <<< margin: 0.1
2024-01-31 17:13:41,716:INFO:   <<< max_frames: 64
2024-01-31 17:13:41,716:INFO:   <<< max_words: 77
2024-01-31 17:13:41,716:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:13:41,716:INFO:   <<< n_display: 100
2024-01-31 17:13:41,716:INFO:   <<< n_gpu: 1
2024-01-31 17:13:41,716:INFO:   <<< n_pair: 1
2024-01-31 17:13:41,716:INFO:   <<< negative_weighting: 1
2024-01-31 17:13:41,716:INFO:   <<< num_thread_reader: 1
2024-01-31 17:13:41,716:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:13:41,716:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:13:41,716:INFO:   <<< post_process: cluster
2024-01-31 17:13:41,716:INFO:   <<< pre_norm: 0
2024-01-31 17:13:41,716:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:13:41,716:INFO:   <<< rank: 0
2024-01-31 17:13:41,716:INFO:   <<< resume_model: None
2024-01-31 17:13:41,716:INFO:   <<< sampled_use_mil: False
2024-01-31 17:13:41,716:INFO:   <<< save_feature_path: None
2024-01-31 17:13:41,716:INFO:   <<< seed: 42
2024-01-31 17:13:41,716:INFO:   <<< sim_header: meanP
2024-01-31 17:13:41,716:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:13:41,716:INFO:   <<< slice_framepos: 2
2024-01-31 17:13:41,716:INFO:   <<< task_type: retrieval
2024-01-31 17:13:41,716:INFO:   <<< temperature_new: 1.0
2024-01-31 17:13:41,716:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:13:41,716:INFO:   <<< time_embedding: 0
2024-01-31 17:13:41,716:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:13:41,716:INFO:   <<< train_frame_order: 0
2024-01-31 17:13:41,716:INFO:   <<< use_mil: False
2024-01-31 17:13:41,716:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:13:41,716:INFO:   <<< video_dim: 1024
2024-01-31 17:13:41,716:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:13:41,716:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:13:41,716:INFO:   <<< world_size: 1
2024-01-31 17:13:41,716:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:13:42,218:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:13:42,219:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:13:42,219:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:13:42,219:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:13:42,219:WARNING: Test retrieval by loose type.
2024-01-31 17:13:42,219:WARNING: 	 embed_dim: 512
2024-01-31 17:13:42,219:WARNING: 	 image_resolution: 224
2024-01-31 17:13:42,219:WARNING: 	 vision_layers: 12
2024-01-31 17:13:42,219:WARNING: 	 vision_width: 768
2024-01-31 17:13:42,219:WARNING: 	 vision_patch_size: 32
2024-01-31 17:13:42,219:WARNING: 	 context_length: 77
2024-01-31 17:13:42,219:WARNING: 	 vocab_size: 49408
2024-01-31 17:13:42,219:WARNING: 	 transformer_width: 512
2024-01-31 17:13:42,219:WARNING: 	 transformer_heads: 8
2024-01-31 17:13:42,219:WARNING: 	 transformer_layers: 12
2024-01-31 17:13:42,219:WARNING: 		 linear_patch: 2d
2024-01-31 17:13:42,219:WARNING: 	 cut_top_layer: 0
2024-01-31 17:13:43,255:WARNING: 	 sim_header: meanP
2024-01-31 17:13:45,866:INFO: --------------------
2024-01-31 17:13:45,866:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:13:47,393:INFO: ***** Running test *****
2024-01-31 17:13:47,393:INFO:   Num examples = 1334
2024-01-31 17:13:47,393:INFO:   Batch size = 16
2024-01-31 17:13:47,393:INFO:   Num steps = 667
2024-01-31 17:13:47,393:INFO: ***** Running val *****
2024-01-31 17:13:47,393:INFO:   Num examples = 1334
2024-01-31 17:13:47,395:INFO: model evaluation on 1 GPU
2024-01-31 17:14:06,930:INFO: Effective parameters:
2024-01-31 17:14:06,930:INFO:   <<< adaptive_cls: 0
2024-01-31 17:14:06,930:INFO:   <<< aggregation: None
2024-01-31 17:14:06,930:INFO:   <<< alpha: 1.0
2024-01-31 17:14:06,930:INFO:   <<< batch_size: 2
2024-01-31 17:14:06,930:INFO:   <<< batch_size_val: 16
2024-01-31 17:14:06,930:INFO:   <<< cache_dir: 
2024-01-31 17:14:06,930:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:14:06,930:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:14:06,930:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:14:06,930:INFO:   <<< cluster_embedding: 0
2024-01-31 17:14:06,930:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:14:06,930:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:14:06,930:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:14:06,930:INFO:   <<< coef_lr: 0.001
2024-01-31 17:14:06,930:INFO:   <<< cross_model: cross-base
2024-01-31 17:14:06,930:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:14:06,930:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:14:06,930:INFO:   <<< datatype: charades
2024-01-31 17:14:06,930:INFO:   <<< do_eval: True
2024-01-31 17:14:06,930:INFO:   <<< do_lower_case: False
2024-01-31 17:14:06,930:INFO:   <<< do_pretrain: False
2024-01-31 17:14:06,930:INFO:   <<< do_train: False
2024-01-31 17:14:06,930:INFO:   <<< dynamic_alpha: False
2024-01-31 17:14:06,930:INFO:   <<< epochs: 20
2024-01-31 17:14:06,930:INFO:   <<< eval_frame_order: 0
2024-01-31 17:14:06,931:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:14:06,931:INFO:   <<< feature_framerate: 1
2024-01-31 17:14:06,931:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:14:06,931:INFO:   <<< fp16: False
2024-01-31 17:14:06,931:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:14:06,931:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:14:06,931:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:14:06,931:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:14:06,931:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:14:06,931:INFO:   <<< linear_patch: 2d
2024-01-31 17:14:06,931:INFO:   <<< local_rank: 0
2024-01-31 17:14:06,931:INFO:   <<< loose_type: True
2024-01-31 17:14:06,931:INFO:   <<< loss: balanced
2024-01-31 17:14:06,931:INFO:   <<< lr: 0.0001
2024-01-31 17:14:06,931:INFO:   <<< lr_decay: 0.9
2024-01-31 17:14:06,931:INFO:   <<< margin: 0.1
2024-01-31 17:14:06,931:INFO:   <<< max_frames: 64
2024-01-31 17:14:06,931:INFO:   <<< max_words: 77
2024-01-31 17:14:06,931:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:14:06,931:INFO:   <<< n_display: 100
2024-01-31 17:14:06,931:INFO:   <<< n_gpu: 1
2024-01-31 17:14:06,931:INFO:   <<< n_pair: 1
2024-01-31 17:14:06,931:INFO:   <<< negative_weighting: 1
2024-01-31 17:14:06,931:INFO:   <<< num_thread_reader: 1
2024-01-31 17:14:06,931:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:14:06,931:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:14:06,931:INFO:   <<< post_process: cluster
2024-01-31 17:14:06,931:INFO:   <<< pre_norm: 0
2024-01-31 17:14:06,931:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:14:06,931:INFO:   <<< rank: 0
2024-01-31 17:14:06,931:INFO:   <<< resume_model: None
2024-01-31 17:14:06,931:INFO:   <<< sampled_use_mil: False
2024-01-31 17:14:06,931:INFO:   <<< save_feature_path: None
2024-01-31 17:14:06,931:INFO:   <<< seed: 42
2024-01-31 17:14:06,931:INFO:   <<< sim_header: meanP
2024-01-31 17:14:06,932:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:14:06,932:INFO:   <<< slice_framepos: 2
2024-01-31 17:14:06,932:INFO:   <<< task_type: retrieval
2024-01-31 17:14:06,932:INFO:   <<< temperature_new: 1.0
2024-01-31 17:14:06,932:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:14:06,932:INFO:   <<< time_embedding: 0
2024-01-31 17:14:06,932:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:14:06,932:INFO:   <<< train_frame_order: 0
2024-01-31 17:14:06,932:INFO:   <<< use_mil: False
2024-01-31 17:14:06,932:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:14:06,932:INFO:   <<< video_dim: 1024
2024-01-31 17:14:06,932:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:14:06,932:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:14:06,932:INFO:   <<< world_size: 1
2024-01-31 17:14:06,932:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:14:07,432:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:14:07,432:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:14:07,432:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:14:07,432:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:14:07,432:WARNING: Test retrieval by loose type.
2024-01-31 17:14:07,433:WARNING: 	 embed_dim: 512
2024-01-31 17:14:07,433:WARNING: 	 image_resolution: 224
2024-01-31 17:14:07,433:WARNING: 	 vision_layers: 12
2024-01-31 17:14:07,433:WARNING: 	 vision_width: 768
2024-01-31 17:14:07,433:WARNING: 	 vision_patch_size: 32
2024-01-31 17:14:07,433:WARNING: 	 context_length: 77
2024-01-31 17:14:07,433:WARNING: 	 vocab_size: 49408
2024-01-31 17:14:07,433:WARNING: 	 transformer_width: 512
2024-01-31 17:14:07,433:WARNING: 	 transformer_heads: 8
2024-01-31 17:14:07,433:WARNING: 	 transformer_layers: 12
2024-01-31 17:14:07,433:WARNING: 		 linear_patch: 2d
2024-01-31 17:14:07,433:WARNING: 	 cut_top_layer: 0
2024-01-31 17:14:08,448:WARNING: 	 sim_header: meanP
2024-01-31 17:14:11,004:INFO: --------------------
2024-01-31 17:14:11,004:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:14:12,538:INFO: ***** Running test *****
2024-01-31 17:14:12,538:INFO:   Num examples = 1334
2024-01-31 17:14:12,538:INFO:   Batch size = 16
2024-01-31 17:14:12,538:INFO:   Num steps = 667
2024-01-31 17:14:12,539:INFO: ***** Running val *****
2024-01-31 17:14:12,539:INFO:   Num examples = 1334
2024-01-31 17:14:12,540:INFO: model evaluation on 1 GPU
2024-01-31 17:20:15,454:INFO: Effective parameters:
2024-01-31 17:20:15,454:INFO:   <<< adaptive_cls: 0
2024-01-31 17:20:15,454:INFO:   <<< aggregation: None
2024-01-31 17:20:15,454:INFO:   <<< alpha: 1.0
2024-01-31 17:20:15,454:INFO:   <<< batch_size: 2
2024-01-31 17:20:15,454:INFO:   <<< batch_size_val: 16
2024-01-31 17:20:15,454:INFO:   <<< cache_dir: 
2024-01-31 17:20:15,454:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:20:15,454:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:20:15,454:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:20:15,454:INFO:   <<< cluster_embedding: 0
2024-01-31 17:20:15,454:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:20:15,454:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:20:15,454:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:20:15,454:INFO:   <<< coef_lr: 0.001
2024-01-31 17:20:15,454:INFO:   <<< cross_model: cross-base
2024-01-31 17:20:15,454:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:20:15,454:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:20:15,454:INFO:   <<< datatype: charades
2024-01-31 17:20:15,454:INFO:   <<< do_eval: True
2024-01-31 17:20:15,454:INFO:   <<< do_lower_case: False
2024-01-31 17:20:15,454:INFO:   <<< do_pretrain: False
2024-01-31 17:20:15,454:INFO:   <<< do_train: False
2024-01-31 17:20:15,455:INFO:   <<< dynamic_alpha: False
2024-01-31 17:20:15,455:INFO:   <<< epochs: 20
2024-01-31 17:20:15,455:INFO:   <<< eval_frame_order: 0
2024-01-31 17:20:15,455:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:20:15,455:INFO:   <<< feature_framerate: 1
2024-01-31 17:20:15,455:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:20:15,455:INFO:   <<< fp16: False
2024-01-31 17:20:15,455:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:20:15,455:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:20:15,455:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:20:15,455:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:20:15,455:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:20:15,455:INFO:   <<< linear_patch: 2d
2024-01-31 17:20:15,455:INFO:   <<< local_rank: 0
2024-01-31 17:20:15,455:INFO:   <<< loose_type: True
2024-01-31 17:20:15,455:INFO:   <<< loss: balanced
2024-01-31 17:20:15,455:INFO:   <<< lr: 0.0001
2024-01-31 17:20:15,455:INFO:   <<< lr_decay: 0.9
2024-01-31 17:20:15,455:INFO:   <<< margin: 0.1
2024-01-31 17:20:15,455:INFO:   <<< max_frames: 64
2024-01-31 17:20:15,455:INFO:   <<< max_words: 77
2024-01-31 17:20:15,455:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:20:15,455:INFO:   <<< n_display: 100
2024-01-31 17:20:15,455:INFO:   <<< n_gpu: 1
2024-01-31 17:20:15,455:INFO:   <<< n_pair: 1
2024-01-31 17:20:15,455:INFO:   <<< negative_weighting: 1
2024-01-31 17:20:15,455:INFO:   <<< num_thread_reader: 1
2024-01-31 17:20:15,455:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:20:15,455:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:20:15,455:INFO:   <<< post_process: cluster
2024-01-31 17:20:15,455:INFO:   <<< pre_norm: 0
2024-01-31 17:20:15,455:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:20:15,455:INFO:   <<< rank: 0
2024-01-31 17:20:15,455:INFO:   <<< resume_model: None
2024-01-31 17:20:15,455:INFO:   <<< sampled_use_mil: False
2024-01-31 17:20:15,455:INFO:   <<< save_feature_path: None
2024-01-31 17:20:15,455:INFO:   <<< seed: 42
2024-01-31 17:20:15,456:INFO:   <<< sim_header: meanP
2024-01-31 17:20:15,456:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:20:15,456:INFO:   <<< slice_framepos: 2
2024-01-31 17:20:15,456:INFO:   <<< task_type: retrieval
2024-01-31 17:20:15,456:INFO:   <<< temperature_new: 1.0
2024-01-31 17:20:15,456:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:20:15,456:INFO:   <<< time_embedding: 0
2024-01-31 17:20:15,456:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:20:15,456:INFO:   <<< train_frame_order: 0
2024-01-31 17:20:15,456:INFO:   <<< use_mil: False
2024-01-31 17:20:15,456:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:20:15,456:INFO:   <<< video_dim: 1024
2024-01-31 17:20:15,456:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:20:15,456:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:20:15,456:INFO:   <<< world_size: 1
2024-01-31 17:20:15,456:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:20:15,955:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:20:15,955:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:20:15,955:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:20:15,955:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:20:15,955:WARNING: Test retrieval by loose type.
2024-01-31 17:20:15,955:WARNING: 	 embed_dim: 512
2024-01-31 17:20:15,955:WARNING: 	 image_resolution: 224
2024-01-31 17:20:15,955:WARNING: 	 vision_layers: 12
2024-01-31 17:20:15,955:WARNING: 	 vision_width: 768
2024-01-31 17:20:15,955:WARNING: 	 vision_patch_size: 32
2024-01-31 17:20:15,955:WARNING: 	 context_length: 77
2024-01-31 17:20:15,956:WARNING: 	 vocab_size: 49408
2024-01-31 17:20:15,956:WARNING: 	 transformer_width: 512
2024-01-31 17:20:15,956:WARNING: 	 transformer_heads: 8
2024-01-31 17:20:15,956:WARNING: 	 transformer_layers: 12
2024-01-31 17:20:15,956:WARNING: 		 linear_patch: 2d
2024-01-31 17:20:15,956:WARNING: 	 cut_top_layer: 0
2024-01-31 17:20:16,971:WARNING: 	 sim_header: meanP
2024-01-31 17:20:19,573:INFO: --------------------
2024-01-31 17:20:19,574:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:20:21,116:INFO: ***** Running test *****
2024-01-31 17:20:21,116:INFO:   Num examples = 1334
2024-01-31 17:20:21,116:INFO:   Batch size = 16
2024-01-31 17:20:21,116:INFO:   Num steps = 667
2024-01-31 17:20:21,116:INFO: ***** Running val *****
2024-01-31 17:20:21,116:INFO:   Num examples = 1334
2024-01-31 17:20:21,117:INFO: model evaluation on 1 GPU
2024-01-31 17:21:35,729:INFO: Effective parameters:
2024-01-31 17:21:35,729:INFO:   <<< adaptive_cls: 0
2024-01-31 17:21:35,729:INFO:   <<< aggregation: None
2024-01-31 17:21:35,729:INFO:   <<< alpha: 1.0
2024-01-31 17:21:35,729:INFO:   <<< batch_size: 2
2024-01-31 17:21:35,729:INFO:   <<< batch_size_val: 16
2024-01-31 17:21:35,729:INFO:   <<< cache_dir: 
2024-01-31 17:21:35,729:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:21:35,729:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:21:35,729:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:21:35,729:INFO:   <<< cluster_embedding: 0
2024-01-31 17:21:35,729:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:21:35,729:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:21:35,729:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:21:35,729:INFO:   <<< coef_lr: 0.001
2024-01-31 17:21:35,729:INFO:   <<< cross_model: cross-base
2024-01-31 17:21:35,729:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:21:35,729:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:21:35,729:INFO:   <<< datatype: charades
2024-01-31 17:21:35,729:INFO:   <<< do_eval: True
2024-01-31 17:21:35,729:INFO:   <<< do_lower_case: False
2024-01-31 17:21:35,730:INFO:   <<< do_pretrain: False
2024-01-31 17:21:35,730:INFO:   <<< do_train: False
2024-01-31 17:21:35,730:INFO:   <<< dynamic_alpha: False
2024-01-31 17:21:35,730:INFO:   <<< epochs: 20
2024-01-31 17:21:35,730:INFO:   <<< eval_frame_order: 0
2024-01-31 17:21:35,730:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:21:35,730:INFO:   <<< feature_framerate: 1
2024-01-31 17:21:35,730:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:21:35,730:INFO:   <<< fp16: False
2024-01-31 17:21:35,730:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:21:35,730:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:21:35,730:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:21:35,730:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:21:35,730:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:21:35,730:INFO:   <<< linear_patch: 2d
2024-01-31 17:21:35,730:INFO:   <<< local_rank: 0
2024-01-31 17:21:35,730:INFO:   <<< loose_type: True
2024-01-31 17:21:35,730:INFO:   <<< loss: balanced
2024-01-31 17:21:35,730:INFO:   <<< lr: 0.0001
2024-01-31 17:21:35,730:INFO:   <<< lr_decay: 0.9
2024-01-31 17:21:35,730:INFO:   <<< margin: 0.1
2024-01-31 17:21:35,730:INFO:   <<< max_frames: 64
2024-01-31 17:21:35,730:INFO:   <<< max_words: 77
2024-01-31 17:21:35,730:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:21:35,730:INFO:   <<< n_display: 100
2024-01-31 17:21:35,730:INFO:   <<< n_gpu: 1
2024-01-31 17:21:35,730:INFO:   <<< n_pair: 1
2024-01-31 17:21:35,730:INFO:   <<< negative_weighting: 1
2024-01-31 17:21:35,730:INFO:   <<< num_thread_reader: 1
2024-01-31 17:21:35,730:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:21:35,730:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:21:35,730:INFO:   <<< post_process: cluster
2024-01-31 17:21:35,730:INFO:   <<< pre_norm: 0
2024-01-31 17:21:35,730:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:21:35,731:INFO:   <<< rank: 0
2024-01-31 17:21:35,731:INFO:   <<< resume_model: None
2024-01-31 17:21:35,731:INFO:   <<< sampled_use_mil: False
2024-01-31 17:21:35,731:INFO:   <<< save_feature_path: None
2024-01-31 17:21:35,731:INFO:   <<< seed: 42
2024-01-31 17:21:35,731:INFO:   <<< sim_header: meanP
2024-01-31 17:21:35,731:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:21:35,731:INFO:   <<< slice_framepos: 2
2024-01-31 17:21:35,731:INFO:   <<< task_type: retrieval
2024-01-31 17:21:35,731:INFO:   <<< temperature_new: 1.0
2024-01-31 17:21:35,731:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:21:35,731:INFO:   <<< time_embedding: 0
2024-01-31 17:21:35,731:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:21:35,731:INFO:   <<< train_frame_order: 0
2024-01-31 17:21:35,731:INFO:   <<< use_mil: False
2024-01-31 17:21:35,731:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:21:35,731:INFO:   <<< video_dim: 1024
2024-01-31 17:21:35,731:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:21:35,731:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:21:35,731:INFO:   <<< world_size: 1
2024-01-31 17:21:35,731:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:21:36,238:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:21:36,238:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:21:36,238:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:21:36,238:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:21:36,238:WARNING: Test retrieval by loose type.
2024-01-31 17:21:36,239:WARNING: 	 embed_dim: 512
2024-01-31 17:21:36,239:WARNING: 	 image_resolution: 224
2024-01-31 17:21:36,239:WARNING: 	 vision_layers: 12
2024-01-31 17:21:36,239:WARNING: 	 vision_width: 768
2024-01-31 17:21:36,239:WARNING: 	 vision_patch_size: 32
2024-01-31 17:21:36,239:WARNING: 	 context_length: 77
2024-01-31 17:21:36,239:WARNING: 	 vocab_size: 49408
2024-01-31 17:21:36,239:WARNING: 	 transformer_width: 512
2024-01-31 17:21:36,239:WARNING: 	 transformer_heads: 8
2024-01-31 17:21:36,239:WARNING: 	 transformer_layers: 12
2024-01-31 17:21:36,239:WARNING: 		 linear_patch: 2d
2024-01-31 17:21:36,239:WARNING: 	 cut_top_layer: 0
2024-01-31 17:21:37,281:WARNING: 	 sim_header: meanP
2024-01-31 17:21:39,895:INFO: --------------------
2024-01-31 17:21:39,895:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:21:41,455:INFO: ***** Running test *****
2024-01-31 17:21:41,455:INFO:   Num examples = 1334
2024-01-31 17:21:41,455:INFO:   Batch size = 16
2024-01-31 17:21:41,455:INFO:   Num steps = 667
2024-01-31 17:21:41,455:INFO: ***** Running val *****
2024-01-31 17:21:41,455:INFO:   Num examples = 1334
2024-01-31 17:21:41,457:INFO: model evaluation on 1 GPU
2024-01-31 17:24:38,002:INFO: Effective parameters:
2024-01-31 17:24:38,002:INFO:   <<< adaptive_cls: 0
2024-01-31 17:24:38,002:INFO:   <<< aggregation: None
2024-01-31 17:24:38,002:INFO:   <<< alpha: 1.0
2024-01-31 17:24:38,002:INFO:   <<< batch_size: 32
2024-01-31 17:24:38,002:INFO:   <<< batch_size_val: 16
2024-01-31 17:24:38,002:INFO:   <<< cache_dir: 
2024-01-31 17:24:38,002:INFO:   <<< cluser_embed_from_clip: 1
2024-01-31 17:24:38,002:INFO:   <<< cluster_algo: kmediods++
2024-01-31 17:24:38,002:INFO:   <<< cluster_distance: euclidean
2024-01-31 17:24:38,002:INFO:   <<< cluster_embedding: 0
2024-01-31 17:24:38,003:INFO:   <<< cluster_frame_embedding: 0
2024-01-31 17:24:38,003:INFO:   <<< cluster_iter_limit: 100
2024-01-31 17:24:38,003:INFO:   <<< cluster_threshold: 1e-05
2024-01-31 17:24:38,003:INFO:   <<< coef_lr: 0.001
2024-01-31 17:24:38,003:INFO:   <<< cross_model: cross-base
2024-01-31 17:24:38,003:INFO:   <<< cross_num_hidden_layers: 4
2024-01-31 17:24:38,003:INFO:   <<< data_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades
2024-01-31 17:24:38,003:INFO:   <<< datatype: charades
2024-01-31 17:24:38,003:INFO:   <<< do_eval: True
2024-01-31 17:24:38,003:INFO:   <<< do_lower_case: False
2024-01-31 17:24:38,003:INFO:   <<< do_pretrain: False
2024-01-31 17:24:38,003:INFO:   <<< do_train: False
2024-01-31 17:24:38,003:INFO:   <<< dynamic_alpha: False
2024-01-31 17:24:38,003:INFO:   <<< epochs: 20
2024-01-31 17:24:38,003:INFO:   <<< eval_frame_order: 0
2024-01-31 17:24:38,003:INFO:   <<< expand_msrvtt_sentences: False
2024-01-31 17:24:38,003:INFO:   <<< feature_framerate: 1
2024-01-31 17:24:38,003:INFO:   <<< features_path: /home/zhengwei/Desktop/Zhengwei/Projects/datasets/Charades/Charades_v1_cp/
2024-01-31 17:24:38,003:INFO:   <<< fp16: False
2024-01-31 17:24:38,003:INFO:   <<< fp16_opt_level: O1
2024-01-31 17:24:38,003:INFO:   <<< freeze_layer_num: 0
2024-01-31 17:24:38,003:INFO:   <<< gradient_accumulation_steps: 1
2024-01-31 17:24:38,003:INFO:   <<< hard_negative_rate: 0.5
2024-01-31 17:24:38,003:INFO:   <<< init_model: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/checkpoints/pytorch_model.bin.4
2024-01-31 17:24:38,003:INFO:   <<< linear_patch: 2d
2024-01-31 17:24:38,003:INFO:   <<< local_rank: 0
2024-01-31 17:24:38,003:INFO:   <<< loose_type: True
2024-01-31 17:24:38,003:INFO:   <<< loss: balanced
2024-01-31 17:24:38,003:INFO:   <<< lr: 0.0001
2024-01-31 17:24:38,003:INFO:   <<< lr_decay: 0.9
2024-01-31 17:24:38,004:INFO:   <<< margin: 0.1
2024-01-31 17:24:38,004:INFO:   <<< max_frames: 64
2024-01-31 17:24:38,004:INFO:   <<< max_words: 77
2024-01-31 17:24:38,004:INFO:   <<< minkowski_norm_p: 2.0
2024-01-31 17:24:38,004:INFO:   <<< n_display: 100
2024-01-31 17:24:38,004:INFO:   <<< n_gpu: 1
2024-01-31 17:24:38,004:INFO:   <<< n_pair: 1
2024-01-31 17:24:38,004:INFO:   <<< negative_weighting: 1
2024-01-31 17:24:38,004:INFO:   <<< num_thread_reader: 4
2024-01-31 17:24:38,004:INFO:   <<< output_dir: /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/outputs/testbase0129/
2024-01-31 17:24:38,004:INFO:   <<< post_cluster_centroids: 16
2024-01-31 17:24:38,004:INFO:   <<< post_process: cluster
2024-01-31 17:24:38,004:INFO:   <<< pre_norm: 0
2024-01-31 17:24:38,004:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-01-31 17:24:38,004:INFO:   <<< rank: 0
2024-01-31 17:24:38,004:INFO:   <<< resume_model: None
2024-01-31 17:24:38,004:INFO:   <<< sampled_use_mil: False
2024-01-31 17:24:38,004:INFO:   <<< save_feature_path: None
2024-01-31 17:24:38,004:INFO:   <<< seed: 42
2024-01-31 17:24:38,004:INFO:   <<< sim_header: meanP
2024-01-31 17:24:38,004:INFO:   <<< sim_lambda: 0.0
2024-01-31 17:24:38,004:INFO:   <<< slice_framepos: 2
2024-01-31 17:24:38,004:INFO:   <<< task_type: retrieval
2024-01-31 17:24:38,004:INFO:   <<< temperature_new: 1.0
2024-01-31 17:24:38,004:INFO:   <<< text_num_hidden_layers: 12
2024-01-31 17:24:38,004:INFO:   <<< time_embedding: 0
2024-01-31 17:24:38,004:INFO:   <<< train_csv: data/.train.csv
2024-01-31 17:24:38,004:INFO:   <<< train_frame_order: 0
2024-01-31 17:24:38,004:INFO:   <<< use_mil: False
2024-01-31 17:24:38,004:INFO:   <<< val_csv: data/.val.csv
2024-01-31 17:24:38,004:INFO:   <<< video_dim: 1024
2024-01-31 17:24:38,004:INFO:   <<< visual_num_hidden_layers: 12
2024-01-31 17:24:38,004:INFO:   <<< warmup_proportion: 0.1
2024-01-31 17:24:38,004:INFO:   <<< world_size: 1
2024-01-31 17:24:38,004:INFO: device: cuda:0 n_gpu: 1
2024-01-31 17:24:38,515:INFO: loading archive file /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base
2024-01-31 17:24:38,515:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-01-31 17:24:38,515:INFO: Weight doesn't exsits. /home/zhengwei/Desktop/Zhengwei/Projects/MEV2T/modules/cross-base/cross_pytorch_model.bin
2024-01-31 17:24:38,515:WARNING: Stage-One:True, Stage-Two:False
2024-01-31 17:24:38,516:WARNING: Test retrieval by loose type.
2024-01-31 17:24:38,516:WARNING: 	 embed_dim: 512
2024-01-31 17:24:38,516:WARNING: 	 image_resolution: 224
2024-01-31 17:24:38,516:WARNING: 	 vision_layers: 12
2024-01-31 17:24:38,516:WARNING: 	 vision_width: 768
2024-01-31 17:24:38,516:WARNING: 	 vision_patch_size: 32
2024-01-31 17:24:38,516:WARNING: 	 context_length: 77
2024-01-31 17:24:38,516:WARNING: 	 vocab_size: 49408
2024-01-31 17:24:38,516:WARNING: 	 transformer_width: 512
2024-01-31 17:24:38,516:WARNING: 	 transformer_heads: 8
2024-01-31 17:24:38,516:WARNING: 	 transformer_layers: 12
2024-01-31 17:24:38,516:WARNING: 		 linear_patch: 2d
2024-01-31 17:24:38,516:WARNING: 	 cut_top_layer: 0
2024-01-31 17:24:39,578:WARNING: 	 sim_header: meanP
2024-01-31 17:24:42,144:INFO: --------------------
2024-01-31 17:24:42,144:INFO: Weights from pretrained model not used in MeRetriever: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-01-31 17:24:43,699:INFO: ***** Running test *****
2024-01-31 17:24:43,699:INFO:   Num examples = 1334
2024-01-31 17:24:43,699:INFO:   Batch size = 16
2024-01-31 17:24:43,699:INFO:   Num steps = 42
2024-01-31 17:24:43,699:INFO: ***** Running val *****
2024-01-31 17:24:43,699:INFO:   Num examples = 1334
2024-01-31 17:24:43,701:INFO: model evaluation on 1 GPU
2024-01-31 17:28:16,645:INFO: sim matrix size: 3720, 1334
2024-01-31 17:28:18,353:INFO: Saving the matrixs and metrics on local.
2024-01-31 17:28:18,498:INFO: Saving finished.
2024-01-31 17:28:18,498:INFO: Text to video:
2024-01-31 17:28:18,498:INFO: mean_mean: 361.0456989247312
2024-01-31 17:28:18,498:INFO: mean_median: 361.0456989247312
2024-01-31 17:28:18,498:INFO: median_mean: 244.0
2024-01-31 17:28:18,498:INFO: median_median: 244.0
2024-01-31 17:28:18,498:INFO: hit_ratio_1: 0.00967741935483871
2024-01-31 17:28:18,498:INFO: best_1: 0.00967741935483871
2024-01-31 17:28:18,498:INFO: worst_1: 0.00967741935483871
2024-01-31 17:28:18,498:INFO: hit_ratio_5: 0.03575268817204301
2024-01-31 17:28:18,498:INFO: best_5: 0.03575268817204301
2024-01-31 17:28:18,498:INFO: worst_5: 0.03575268817204301
2024-01-31 17:28:18,498:INFO: hit_ratio_10: 0.06693548387096775
2024-01-31 17:28:18,498:INFO: best_10: 0.06693548387096775
2024-01-31 17:28:18,498:INFO: worst_10: 0.06693548387096775
2024-01-31 17:28:18,498:INFO: hit_ratio_50: 0.1989247311827957
2024-01-31 17:28:18,498:INFO: best_50: 0.1989247311827957
2024-01-31 17:28:18,498:INFO: worst_50: 0.1989247311827957
2024-01-31 17:28:18,499:INFO: hit_ratio_100: 0.30806451612903224
2024-01-31 17:28:18,499:INFO: best_100: 0.30806451612903224
2024-01-31 17:28:18,499:INFO: worst_100: 0.30806451612903224
2024-01-31 17:28:18,499:INFO: Video to text:
2024-01-31 17:28:18,499:INFO: mean_mean: 1061.7215722495896
2024-01-31 17:28:18,499:INFO: mean_median: 1023.7316341829086
2024-01-31 17:28:18,499:INFO: median_mean: 895.8809523809524
2024-01-31 17:28:18,499:INFO: median_median: 801.75
2024-01-31 17:28:18,499:INFO: hit_ratio_1: 0.00789158991932605
2024-01-31 17:28:18,499:INFO: best_1: 0.017991004497751123
2024-01-31 17:28:18,499:INFO: worst_1: 0.0029985007496251873
2024-01-31 17:28:18,499:INFO: hit_ratio_5: 0.02901079222293615
2024-01-31 17:28:18,499:INFO: best_5: 0.060719640179910044
2024-01-31 17:28:18,499:INFO: worst_5: 0.01424287856071964
2024-01-31 17:28:18,499:INFO: hit_ratio_10: 0.0412823350229647
2024-01-31 17:28:18,499:INFO: best_10: 0.08845577211394302
2024-01-31 17:28:18,499:INFO: worst_10: 0.017241379310344827
2024-01-31 17:28:18,499:INFO: hit_ratio_50: 0.10810398372242451
2024-01-31 17:28:18,499:INFO: best_50: 0.22263868065967016
2024-01-31 17:28:18,499:INFO: worst_50: 0.044977511244377814
2024-01-31 17:28:18,499:INFO: hit_ratio_100: 0.16872873087265888
2024-01-31 17:28:18,499:INFO: best_100: 0.31334332833583206
2024-01-31 17:28:18,499:INFO: worst_100: 0.07571214392803598
